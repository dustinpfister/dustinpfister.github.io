<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>Sphere Geometry Mutation of position attribute threejs example | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This week I was learning more about how to work with a buffer geometry in threejs when it comes to the various attributes that make up such a feature in threejs. There is the position attribute in the">
<meta property="og:type" content="article">
<meta property="og:title" content="Sphere Geometry Mutation of position attribute threejs example">
<meta property="og:url" content="https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="This week I was learning more about how to work with a buffer geometry in threejs when it comes to the various attributes that make up such a feature in threejs. There is the position attribute in the">
<meta property="og:updated_time" content="2022-10-24T21:37:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sphere Geometry Mutation of position attribute threejs example">
<meta name="twitter:description" content="This week I was learning more about how to work with a buffer geometry in threejs when it comes to the various attributes that make up such a feature in threejs. There is the position attribute in the">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image, as well as the link to my youtube -->
        <a href="https://www.youtube.com/user/javaweaver"><div class="selfimage"></div></a>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas</a>
        
          <a class="main-nav-link" href="https://www.youtube.com/user/javaweaver">Youtube</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-threejs-examples-sphere-mutate" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/06/10/threejs-examples-sphere-mutate/" class="article-date"> Published:
  <time datetime="2021-06-10T18:19:00.000Z" itemprop="datePublished">2021-06-10</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2021/06/10/threejs-examples-sphere-mutate/" class="article-date"> Modified:
  <time datetime="2022-10-24T21:37:10.000Z" itemprop="dateModified">2022-10-24</time>
</a>

    <span class="article-date">V1.29</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/three-js/">three.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Sphere Geometry Mutation of position attribute threejs example
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>This week I was learning more about how to work with a <a href="https://threejs.org/docs/#api/en/core/BufferGeometry" target="_blank" rel="external">buffer geometry</a> in <a href="https://threejs.org/docs/#manual/en/introduction/Creating-a-scene" target="_blank" rel="external">threejs</a> when it comes to the various attributes that make up such a feature in threejs. There is the <a href="/2021/06/07/threejs-buffer-geometry-attributes-position/">position attribute</a> in the geometry which is the attribute that holds the current positions of all the points in the geometry for example. </p>
<p>So I think it might be a good idea to wrap this week up with a few simple <a href="/2021/02/19/threejs-examples/">threejs project examples</a> that have to do with mutating the position attributes of a geometry made with one of the built in geometry constructors. One such constructor to work with when it comes to this is the sphere geometry constructor which is just one of many options of course but that is one of the main ones that come to mind so I will go with that one. It then might prove to be an interesting learning experience to work out some methods that have to do with changing the geometry a little, as there is a lot to work with in the threejs library over all for doing so such as the various methods of the Vector3 class.</p>
<p>In this post then I will be going over my first quick example that has to do with a helper method that changes the position of a point on a sphere. The process of doing so is not always so easy as there is not just one point that needs to move but all points of all triangles at that point in space actually. So this might prove to be the kind of example that I might come back to now and then in order to find new ways to go about doing this.</p>
<a id="more"></a>
<iframe class="youtube_video" src="https://www.youtube.com/embed/0AcqRbTUcO8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<h2 id="Mutating-sphere-geometry-and-what-to-know-first"><a href="#Mutating-sphere-geometry-and-what-to-know-first" class="headerlink" title="Mutating sphere geometry and what to know first"></a>Mutating sphere geometry and what to know first</h2><p>This is a post on a threejs example where I am mutating the geometry of a sphere made with the <a href="/2021/05/26/threejs-sphere/">THREE.SphereGeometry constructor</a> in the library. It should do without saying that this post is not intended for people that are new to threejs, and javaScript in general as the topic might prove to be a bit to advanced. So it might be best to start out with a <a href="/2018/04/04/threejs-getting-started/">getting started type post with threejs</a>, even if you have some experience with these topics there are still a few things you might want to read up on more first.</p>
<h3 id="Might-want-to-read-up-more-on-the-buffer-geometry-class-in-general"><a href="#Might-want-to-read-up-more-on-the-buffer-geometry-class-in-general" class="headerlink" title="Might want to read up more on the buffer geometry class in general"></a>Might want to read up more on the buffer geometry class in general</h3><p>It might be a good idea to read up more on the <a href="/2021/04/22/threejs-buffer-geometry/">buffer geometry class in general</a>, as there are a great number of properties and methods in an instance of buffer geometry that you should be aware of before getting into an example like this. The main feature of interest when it comes to changing the points in a geometry would be the position attribute of a geometry created with one of the built in geometry constructor methods.</p>
<h3 id="There-is-a-lot-that-applies-to-mutation-of-sphere-geometry-in-the-Vector3-class"><a href="#There-is-a-lot-that-applies-to-mutation-of-sphere-geometry-in-the-Vector3-class" class="headerlink" title="There is a lot that applies to mutation of sphere geometry in the Vector3 class"></a>There is a lot that applies to mutation of sphere geometry in the Vector3 class</h3><p>I have wrote a number of blog posts on the <a href="/2018/04/15/threejs-vector3/">Vector3 class</a> and I have to say that there is a lot of useful tools in that class that can help with the mutation of the position attribute of sphere geometry. There is the <a href="/2021/06/14/threejs-vector3-normalize/">normalize</a> and <a href="/2022/03/23/threejs-vector3-multiply-scalar/">multiply scalar methods</a> that can be used to change the vector unit length of each vertex in the sphere for example. There is also making use of the <a href="/2021/06/18/threejs-vector3-apply-euler">apply Euler</a> method with the <a href="/2021/04/28/threejs-euler/">Euler class</a> to change diction of each point in the sphere.</p>
<p>The state of the position attribute might be a linear array of numbers, but there is also getting into how to convert that to an array of Vectors, or create a vector3, use the class methods to do what I want, and then mutating the array of the position attribute. I will be going over some source code examples of this here, sure, but I would not stop at this post when it comes to reading about this sort of thing.</p>
<h3 id="Source-code-is-on-Github"><a href="#Source-code-is-on-Github" class="headerlink" title="Source code is on Github"></a>Source code is on Github</h3><p>The source code for this example and many more is <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/forpost/threejs-examples-sphere-mutate" target="_blank" rel="external">on github</a> in my test threejs repo. I have learned a great deal more about threejs and buffer geometry, as well as buffer attributes sense then, so I now have an r1 example that I will be writing about first and foremost in this post. In addition I also have notes for a few additional future revisions of the example that I might get to at some point sooner or later that are stored in a to do list of the for post folder that corresponds with this blog post.</p>
<h3 id="version-numbers-matter"><a href="#version-numbers-matter" class="headerlink" title="version numbers matter"></a>version numbers matter</h3><p>When I wrote this post I was using threejs version r127, and the last time I came around to do a little editing I was using r140. When I first wrote this post I has what I was referring to as r0 of a sphere geometry mutation example.</p>
<h2 id="2-Seamless-mutation-module-form-of-example-forPoint-and-forPole-update-options-r2"><a href="#2-Seamless-mutation-module-form-of-example-forPoint-and-forPole-update-options-r2" class="headerlink" title="2 - Seamless mutation, module form of example, forPoint and forPole update options ( r2 )"></a>2 - Seamless mutation, module form of example, forPoint and forPole update options ( r2 )</h2><p>For revision r2 of the sphere mutate threejs example I wanted to do somehtig about the seam that I was dealing with in r1 and that is the main thing that I resolved in this revision. I wanted to make a number of other improvements as well thorough such as making a module form of what I have worked out thus far when it comes to this sort of thing, and also have more that one demo of this new module form of the project example.</p>
<h2 id="2-0-The-sphere-mutate-module"><a href="#2-0-The-sphere-mutate-module" class="headerlink" title="2.0 - The sphere mutate module"></a>2.0 - The sphere mutate module</h2><p>There are two main pubic methods for the module that are of interest, the create method and the update method. The create methods will create and return a mesh object with a geometry made with you guessed it the SphereGeometry constructor, as well as the use of the Phong Material when it comes to skinning the geometry. In addition to this I am also setting up some properties for the user data object that will be used by the update method. If you are not familiar with the user data object it is just a standard place to park user defined properties to any object3d based object such as a mesh object. In this case I am using it to park a starting position attribute state as well as a reference to the current state as well.</p>
<p>The update method is then what is used to update the state of the position attribute of the sphere geometry based on what is given in terms of a for point and for pole function.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// DEFAULTS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// default for pole function</span></div><div class="line">    <span class="keyword">const</span> DEFAULT_FORPOLE = <span class="function"><span class="keyword">function</span>(<span class="params">vs, i, x, y, mesh, alpha, opt</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> vs;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// defualt for all other points</span></div><div class="line">    <span class="keyword">const</span> DEFAULT_FORPOINT = <span class="function"><span class="keyword">function</span>(<span class="params">vs, i, x, y, mesh, alpha, opt</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> vs.normalize().multiplyScalar(<span class="number">0.75</span> + <span class="number">0.25</span> * <span class="built_in">Math</span>.random());</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// get index if x and y are known</span></div><div class="line">    <span class="keyword">const</span> getIndex = <span class="function">(<span class="params">geo, x, y</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> h = geo.parameters.heightSegments;</div><div class="line">        <span class="keyword">return</span> y * ( h + <span class="number">1</span> ) + x;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a Vector3 object of the given buffer attribute and index</span></div><div class="line">    <span class="keyword">const</span> getV3 = <span class="function">(<span class="params">ba, index</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> THREE.Vector3(ba.getX(index), ba.getY(index), ba.getZ(index));</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// UPDATE NORMALS HELPER</span></div><div class="line">    <span class="keyword">const</span> updateNormals = <span class="function">(<span class="params">geo</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> w = geo.parameters.widthSegments</div><div class="line">        <span class="keyword">const</span> h = geo.parameters.heightSegments;</div><div class="line">        <span class="comment">// just call compute vertex normals for all points first</span></div><div class="line">        geo.computeVertexNormals();</div><div class="line">        <span class="comment">// need to fix the seam normals though</span></div><div class="line">        <span class="keyword">const</span> x = w;</div><div class="line">        <span class="keyword">let</span> y = <span class="number">1</span>;</div><div class="line">        <span class="keyword">const</span> normal = geo.getAttribute(<span class="string">'normal'</span>);</div><div class="line">        <span class="keyword">while</span>(y &lt; h)&#123;</div><div class="line">            <span class="keyword">const</span> i =  getIndex(geo, x, y),</div><div class="line">            i2 = i - x;</div><div class="line">            <span class="keyword">const</span> v = getV3(normal, i2);</div><div class="line">            normal.setXYZ(i, v.x, v.y, v.z);</div><div class="line">            y += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        normal.needsUpdate = <span class="literal">true</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// PUBLIC API</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// create the mesh object</span></div><div class="line">    <span class="comment">//api.create = (size, w, h, texture) =&gt; &#123;</span></div><div class="line">    api.create = <span class="function">(<span class="params">opt</span>) =&gt;</span> &#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.size = opt.size === <span class="literal">undefined</span> ? <span class="number">1</span> : opt.size;</div><div class="line">        opt.w = opt.w === <span class="literal">undefined</span> ? <span class="number">10</span> : opt.w;</div><div class="line">        opt.h = opt.h === <span class="literal">undefined</span> ? <span class="number">10</span> : opt.h;</div><div class="line">        <span class="keyword">const</span> mesh = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">            <span class="keyword">new</span> THREE.SphereGeometry(opt.size, opt.w, opt.h, <span class="number">0</span>, <span class="built_in">Math</span>.PI * <span class="number">2</span>), </div><div class="line">            opt.material || <span class="keyword">new</span> THREE.MeshPhongMaterial(&#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'white'</span>,</div><div class="line">                <span class="attr">map</span>: opt.texture || <span class="literal">null</span></div><div class="line">            &#125;));</div><div class="line">        <span class="keyword">const</span> pos = mesh.geometry.getAttribute(<span class="string">'position'</span>);</div><div class="line">        mesh.userData.pos = pos;</div><div class="line">        mesh.userData.pos_base = pos.clone();</div><div class="line">        <span class="keyword">return</span> mesh;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// main update method</span></div><div class="line">    api.update = <span class="function">(<span class="params">mesh, alpha, opt</span>) =&gt;</span> &#123;</div><div class="line">        alpha = alpha === <span class="literal">undefined</span> ? <span class="number">0</span> : alpha;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.forPoint = opt.forPoint || DEFAULT_FORPOINT;</div><div class="line">        opt.forPole = opt.forPole || DEFAULT_FORPOLE;</div><div class="line">        <span class="comment">// mutate</span></div><div class="line">        <span class="keyword">const</span> geo = mesh.geometry;</div><div class="line">        <span class="keyword">const</span> pos = mesh.userData.pos;</div><div class="line">        <span class="keyword">const</span> pos_base = mesh.userData.pos_base; </div><div class="line">        <span class="keyword">const</span> w = geo.parameters.widthSegments;</div><div class="line">        <span class="keyword">const</span> h = geo.parameters.heightSegments;</div><div class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(i &lt; pos.count)&#123;</div><div class="line">            <span class="keyword">const</span> x = i % ( w + <span class="number">1</span>);</div><div class="line">            <span class="keyword">const</span> y = <span class="built_in">Math</span>.floor(i / ( h + <span class="number">1</span>) );</div><div class="line">            <span class="keyword">const</span> vs = getV3(pos_base, i);</div><div class="line">            <span class="keyword">let</span> v = vs.clone();</div><div class="line">            <span class="comment">// do something special for top and bottom points</span></div><div class="line">            <span class="keyword">if</span>(y === <span class="number">0</span> || y === h)&#123;</div><div class="line">                v = opt.forPole(vs.clone(), i, x, y, mesh, alpha, opt);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="comment">// else to what needs to be done for all others</span></div><div class="line">                <span class="keyword">if</span>(x &lt; w)&#123;</div><div class="line">                    v = opt.forPoint(vs.clone(), i, x, y, mesh, alpha, opt);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="comment">// deal with seam by setting to point that was all ready set</span></div><div class="line">                    v.copy( getV3(pos, getIndex(geo, x, y) - w ) );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            pos.setXYZ(i, v.x, v.y, v.z);</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        pos.needsUpdate = <span class="literal">true</span>;</div><div class="line">        <span class="comment">// update normals</span></div><div class="line">        updateNormals(geo);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">    (<span class="keyword">this</span>[<span class="string">'sphereMutate'</span>] = &#123;&#125;));</div></pre></td></tr></table></figure>
<h3 id="2-1-Random-unit-lengths-lerping-back-and-forth"><a href="#2-1-Random-unit-lengths-lerping-back-and-forth" class="headerlink" title="2.1 - Random unit lengths lerping back and forth"></a>2.1 - Random unit lengths lerping back and forth</h3><p>For my first demo of this new sphere mutate module I made a demo that is like that of what I worked out for the r1 form of this threejs example. That is that I just move all the points in and out to and from random vector unit lengths.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// threejs-examples-sphere-mutate - r2 </span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, RENDRER, LIGHT</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0.02</span>,<span class="number">0.02</span>,<span class="number">0.02</span>)</div><div class="line">    <span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">0.5</span>, <span class="number">1000</span>);</div><div class="line">    camera.position.set(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    <span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">0.8</span>);</div><div class="line">    dl.position.set(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>);</div><div class="line">    scene.add(dl);</div><div class="line">    <span class="keyword">const</span> al = <span class="keyword">new</span> THREE.AmbientLight(<span class="number">0xffffff</span>, <span class="number">0.2</span>);</div><div class="line">    scene.add(al);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// TEXTURE</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// USING THREE DATA TEXTURE To CREATE A RAW DATA TEXTURE</span></div><div class="line">    <span class="keyword">const</span> width = <span class="number">256</span>, height = <span class="number">256</span>;</div><div class="line">    <span class="keyword">const</span> size = width * height;</div><div class="line">    <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>( <span class="number">4</span> * size );</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i ++ ) &#123;</div><div class="line">        <span class="keyword">const</span> stride = i * <span class="number">4</span>;</div><div class="line">        <span class="keyword">const</span> a1 = i / size;</div><div class="line">        <span class="keyword">const</span> a2 = <span class="number">1</span> - <span class="built_in">Math</span>.abs(<span class="number">0.5</span> - a1 * <span class="number">2</span> % <span class="number">1</span>) / <span class="number">0.5</span>;</div><div class="line">        <span class="keyword">const</span> v = <span class="number">105</span> + <span class="number">150</span> * <span class="built_in">Math</span>.random();</div><div class="line">        data[ stride ] = v * a1;</div><div class="line">        data[ stride + <span class="number">1</span> ] = v * (<span class="number">1</span> - a1);</div><div class="line">        data[ stride + <span class="number">2</span> ] = v * a2</div><div class="line">        data[ stride + <span class="number">3</span> ] = <span class="number">255</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> texture = <span class="keyword">new</span> THREE.DataTexture( data, width, height );</div><div class="line">    texture.needsUpdate = <span class="literal">true</span>;</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// GEOMETRY, MESH</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">//const mesh = sphereMutate.create(1.25, 40, 40, texture);</span></div><div class="line">    <span class="keyword">const</span> mesh = sphereMutate.create(&#123;</div><div class="line">        <span class="attr">size</span>: <span class="number">1.25</span>, <span class="attr">w</span>: <span class="number">40</span>, <span class="attr">h</span>: <span class="number">40</span>, <span class="attr">texture</span>: texture</div><div class="line">    &#125;);</div><div class="line">    scene.add(mesh);</div><div class="line">    camera.lookAt(mesh.position);</div><div class="line">    <span class="comment">// update options</span></div><div class="line">    <span class="keyword">const</span> updateOpt = &#123;</div><div class="line">        <span class="attr">forPoint</span> : <span class="function"><span class="keyword">function</span>(<span class="params">vs, i, x, y, mesh, alpha</span>)</span>&#123;</div><div class="line">            <span class="keyword">const</span> mud = mesh.userData;</div><div class="line">            <span class="keyword">const</span> state = mud.state = mud.state === <span class="literal">undefined</span> ? [] : mud.state;</div><div class="line">            <span class="keyword">if</span>(!state[i])&#123;</div><div class="line">                state[i] = &#123;</div><div class="line">                    <span class="attr">v</span>: vs.clone().normalize().multiplyScalar(<span class="number">1.25</span> + <span class="number">0.25</span> * <span class="built_in">Math</span>.random()),</div><div class="line">                    <span class="attr">count</span>: <span class="number">1</span> + <span class="built_in">Math</span>.floor( <span class="built_in">Math</span>.random() * <span class="number">9</span> ),</div><div class="line">                    <span class="attr">offset</span>: <span class="built_in">Math</span>.random()</div><div class="line">                &#125;;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">const</span> alpha2 = (state[i].offset + state[i].count * alpha) % <span class="number">1</span>;</div><div class="line">            <span class="keyword">const</span> alpha3 = <span class="number">1</span> - <span class="built_in">Math</span>.abs(<span class="number">0.5</span> - alpha2) / <span class="number">0.5</span>;</div><div class="line">            <span class="keyword">return</span> vs.lerp(state[i].v, alpha3);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    sphereMutate.update(mesh, <span class="number">0</span>, updateOpt);</div><div class="line">    <span class="comment">// normals helper</span></div><div class="line">    <span class="keyword">let</span> helper = <span class="literal">null</span>;</div><div class="line">    <span class="comment">//if(THREE.VertexNormalsHelper)&#123;</span></div><div class="line">    <span class="comment">//    helper = new THREE.VertexNormalsHelper(mesh, 0.1, 0x00ff00);</span></div><div class="line">    <span class="comment">//    scene.add(helper);</span></div><div class="line">    <span class="comment">//&#125;</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// ANIMATION LOOP</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">new</span> THREE.OrbitControls(camera, renderer.domElement);</div><div class="line">    <span class="keyword">const</span> FPS_UPDATE = <span class="number">12</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">    FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">    FRAME_MAX = <span class="number">800</span>;</div><div class="line">    <span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">    frame = <span class="number">0</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="comment">// update</span></div><div class="line">    <span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> alpha = frame / frameMax;</div><div class="line">        mesh.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">4</span> * alpha; </div><div class="line">        sphereMutate.update(mesh, alpha * <span class="number">4</span> % <span class="number">1</span>, updateOpt);</div><div class="line">        <span class="keyword">if</span>(helper)&#123;</div><div class="line">            helper.update();</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// loop</span></div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">            <span class="comment">// update, render</span></div><div class="line">            update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            <span class="comment">// step frame</span></div><div class="line">            frame += FPS_MOVEMENT * secs;</div><div class="line">            frame %= FRAME_MAX;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h3 id="2-2-Sin-Wave-demo"><a href="#2-2-Sin-Wave-demo" class="headerlink" title="2.2 - Sin Wave demo"></a>2.2 - Sin Wave demo</h3><p>I wanted to make at least one example that makes use of Math.sin as a way to adjust the geometry of a sphere. This then results in a cool wave like effect that I had in mind when starting to make this.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// threejs-examples-sphere-mutate - r2 </span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, RENDRER, LIGHT</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0.02</span>,<span class="number">0.02</span>,<span class="number">0.02</span>)</div><div class="line">    <span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">0.5</span>, <span class="number">1000</span>);</div><div class="line">    camera.position.set(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    <span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">0.8</span>);</div><div class="line">    dl.position.set(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>);</div><div class="line">    scene.add(dl);</div><div class="line">    <span class="keyword">const</span> al = <span class="keyword">new</span> THREE.AmbientLight(<span class="number">0xffffff</span>, <span class="number">0.2</span>);</div><div class="line">    scene.add(al);</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// GEOMETRY, MESH</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh = sphereMutate.create(&#123;</div><div class="line">        <span class="attr">size</span>: <span class="number">1.25</span>, <span class="attr">w</span>: <span class="number">60</span>, <span class="attr">h</span>: <span class="number">60</span>, <span class="attr">material</span>: <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123;<span class="attr">wireframe</span>: <span class="literal">true</span>, <span class="attr">wireframeLinewidth</span> : <span class="number">3</span>&#125;)</div><div class="line">    &#125;);</div><div class="line">    scene.add(mesh);</div><div class="line">    camera.lookAt(mesh.position);</div><div class="line">    <span class="comment">// update options</span></div><div class="line">    <span class="keyword">const</span> updateOpt = &#123;</div><div class="line">        <span class="attr">forPoint</span> : <span class="function"><span class="keyword">function</span>(<span class="params">vs, i, x, y, mesh, alpha</span>)</span>&#123;</div><div class="line">            <span class="keyword">const</span> geo = mesh.geometry;</div><div class="line">            <span class="keyword">const</span> w = geo.parameters.widthSegments;</div><div class="line">            <span class="keyword">const</span> h = geo.parameters.heightSegments;</div><div class="line">            <span class="keyword">const</span> a1 = x / w;</div><div class="line">            <span class="keyword">const</span> a2 = y / h;</div><div class="line">            <span class="keyword">const</span> radian1 = <span class="built_in">Math</span>.PI * <span class="number">16</span> * a1 + <span class="built_in">Math</span>.PI * (<span class="number">2</span> + <span class="number">16</span> * a2) * alpha;</div><div class="line">            <span class="keyword">const</span> radian2 = <span class="built_in">Math</span>.PI * <span class="number">16</span> * a2 + <span class="built_in">Math</span>.PI * <span class="number">8</span> * alpha;</div><div class="line">            <span class="keyword">const</span> n1 = ( <span class="built_in">Math</span>.PI + <span class="built_in">Math</span>.sin( radian1 ) ) / <span class="built_in">Math</span>.PI;</div><div class="line">            <span class="keyword">const</span> n2 = ( <span class="built_in">Math</span>.PI + <span class="built_in">Math</span>.sin( radian2 ) ) / <span class="built_in">Math</span>.PI;</div><div class="line">            <span class="keyword">const</span> n3 = ( n1 + n2 ) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">const</span> v2 = vs.clone().normalize().multiplyScalar( vs.length() + <span class="number">0.2</span> * n3 );</div><div class="line">            <span class="keyword">return</span> vs.lerp(v2, <span class="number">1</span> - <span class="built_in">Math</span>.abs(<span class="number">0.5</span> - alpha) / <span class="number">0.5</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    sphereMutate.update(mesh, <span class="number">0</span>, updateOpt);</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// ANIMATION LOOP</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">new</span> THREE.OrbitControls(camera, renderer.domElement);</div><div class="line">    <span class="keyword">const</span> FPS_UPDATE = <span class="number">12</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">    FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">    FRAME_MAX = <span class="number">800</span>;</div><div class="line">    <span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">    frame = <span class="number">0</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="comment">// update</span></div><div class="line">    <span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> alpha = frame / frameMax;</div><div class="line">        sphereMutate.update(mesh, alpha * <span class="number">4</span> % <span class="number">1</span>, updateOpt);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// loop</span></div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">            <span class="comment">// update, render</span></div><div class="line">            update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            <span class="comment">// step frame</span></div><div class="line">            frame += FPS_MOVEMENT * secs;</div><div class="line">            frame %= FRAME_MAX;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h3 id="2-3-Map-Demo"><a href="#2-3-Map-Demo" class="headerlink" title="2.3 - Map Demo"></a>2.3 - Map Demo</h3><p>Another idea that I had is to just have some kind of map system as a way to define what the changes in unit length should be.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// threejs-examples-sphere-mutate - r2 </span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, RENDRER, LIGHT</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0.02</span>,<span class="number">0.02</span>,<span class="number">0.02</span>)</div><div class="line">    <span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">0.5</span>, <span class="number">1000</span>);</div><div class="line">    camera.position.set(<span class="number">1.5</span>, <span class="number">1.5</span>, <span class="number">1.5</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    <span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">0.8</span>);</div><div class="line">    dl.position.set(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>);</div><div class="line">    scene.add(dl);</div><div class="line">    <span class="keyword">const</span> al = <span class="keyword">new</span> THREE.AmbientLight(<span class="number">0xffffff</span>, <span class="number">0.2</span>);</div><div class="line">    scene.add(al);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// TEXTURE</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// USING THREE DATA TEXTURE To CREATE A RAW DATA TEXTURE</span></div><div class="line">    <span class="keyword">const</span> width = <span class="number">64</span>, height = <span class="number">64</span>;</div><div class="line">    <span class="keyword">const</span> size = width * height;</div><div class="line">    <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>( <span class="number">4</span> * size );</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i ++ ) &#123;</div><div class="line">        <span class="keyword">const</span> stride = i * <span class="number">4</span>;</div><div class="line">        <span class="keyword">const</span> v = <span class="number">30</span> + <span class="number">110</span> * <span class="built_in">Math</span>.random();</div><div class="line">        data[ stride ] = <span class="number">0</span>;</div><div class="line">        data[ stride + <span class="number">1</span> ] = v;</div><div class="line">        data[ stride + <span class="number">2</span> ] = <span class="number">0</span></div><div class="line">        data[ stride + <span class="number">3</span> ] = <span class="number">255</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> texture = <span class="keyword">new</span> THREE.DataTexture( data, width, height );</div><div class="line">    texture.needsUpdate = <span class="literal">true</span>;</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// GEOMETRY, MESH</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh = sphereMutate.create(&#123;</div><div class="line">        <span class="attr">size</span>: <span class="number">0.25</span>, <span class="attr">w</span>: <span class="number">128</span>, <span class="attr">h</span>: <span class="number">128</span>, <span class="attr">texture</span>: texture</div><div class="line">    &#125;);</div><div class="line">    scene.add(mesh);</div><div class="line">    camera.lookAt(mesh.position);</div><div class="line">    <span class="comment">// MAP DATA</span></div><div class="line">    <span class="keyword">const</span> map_w = <span class="number">16</span>;</div><div class="line">    <span class="keyword">const</span> map_data = [</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,</div><div class="line">        <span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,</div><div class="line">        <span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,</div><div class="line">        <span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,</div><div class="line">        <span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,</div><div class="line">        <span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,</div><div class="line">        <span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,</div><div class="line">        <span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</div><div class="line">        <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span></div><div class="line">    ];</div><div class="line">    <span class="comment">// update options</span></div><div class="line">    <span class="keyword">const</span> updateOpt = &#123;</div><div class="line">        <span class="attr">forPoint</span> : <span class="function"><span class="keyword">function</span>(<span class="params">vs, i, x, y, mesh, alpha</span>)</span>&#123;</div><div class="line">            <span class="keyword">const</span> geo = mesh.geometry;</div><div class="line">            <span class="keyword">const</span> w = geo.parameters.widthSegments;</div><div class="line">            <span class="keyword">const</span> h = geo.parameters.heightSegments;</div><div class="line">            <span class="comment">// get grid location</span></div><div class="line">            <span class="keyword">const</span> gx = <span class="built_in">Math</span>.floor( x / w * map_w );</div><div class="line">            <span class="keyword">const</span> gy = <span class="built_in">Math</span>.floor( ( y - <span class="number">1</span> ) / ( h - <span class="number">1</span>) * map_w );</div><div class="line">            <span class="keyword">const</span> gi = gy * map_w + gx;</div><div class="line">            <span class="keyword">const</span> dy = map_data[gi];</div><div class="line">            <span class="keyword">const</span> ulb = <span class="number">0.25</span> + <span class="number">0.75</span> * alpha;</div><div class="line">            <span class="keyword">const</span> uld = <span class="number">0.75</span> - <span class="number">0.75</span> * alpha</div><div class="line">            <span class="keyword">return</span> vs.normalize().multiplyScalar(ulb + dy / <span class="number">5</span> * uld);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    sphereMutate.update(mesh, <span class="number">0</span>, updateOpt);</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// ANIMATION LOOP</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">new</span> THREE.OrbitControls(camera, renderer.domElement);</div><div class="line">    <span class="keyword">const</span> FPS_UPDATE = <span class="number">12</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">    FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">    FRAME_MAX = <span class="number">200</span>;</div><div class="line">    <span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">    frame = <span class="number">0</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="comment">// update</span></div><div class="line">    <span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> alpha = frame / frameMax;</div><div class="line">        <span class="keyword">let</span> b = <span class="number">1</span> - <span class="built_in">Math</span>.abs( <span class="number">0.5</span> - alpha ) / <span class="number">0.5</span>;</div><div class="line">        sphereMutate.update(mesh, b, updateOpt);</div><div class="line">        mesh.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">2</span> * alpha;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// loop</span></div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">            <span class="comment">// update, render</span></div><div class="line">            update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            <span class="comment">// step frame</span></div><div class="line">            frame += FPS_MOVEMENT * secs;</div><div class="line">            frame %= FRAME_MAX;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="1-Random-Vector-unit-length-while-preserving-direction"><a href="#1-Random-Vector-unit-length-while-preserving-direction" class="headerlink" title="1 - Random Vector unit length while preserving direction"></a>1 - Random Vector unit length while preserving direction</h2><p>For r1 of my sphere mutation threejs example project I wanted to just make an example that makes better use of buffer attribute class features in place of what I made first in r0. If you still want to check out the older code for whatever reason it is down below in a latter section in this post as I am thinking that I will want to always pull the latest revisions up to the top.</p>
<iframe class="youtube_video" src="https://www.youtube.com/embed/w91r95Dzlvo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<p>Anyway the main feature of interest here is the create new vectors helper function that will create and append arrays to the <a href="/2021/02/16/threejs-userdata/">User Data object</a> of a mesh object based off of the original state of the position attribute of the buffer geometry of the sphere. The goal here is to create to arrays of vector3 objects, one of which is for each point in the original position attribute state, and the other is a new state of random points to lerp to. In my later update geometry method I will be using the <a href="/2022/05/17/threejs-vector3-lerp/">lerp method of the Vector3</a> class to transform the starting state of the sphere geometry to this new set of points that are random vector unit lengths but with the same direction as the original points.</p>
<p>I then have a special create mesh helper function that will create a mesh object with a sphere geometry and also set up the pos_base property of the user data object with a clone of the starting state of the sphere geometry. On top of that I am also calling the create new vectors helper for the first time which will of course set up those additional user data object properties that i want to have at the ready for updating things. Speaking of updating things the final helper function of interest here then is the update geometry helper function that I will be calling in the main update method of the animation loop for this example. In this method I am looping over each point in the sphere geometry and using the lerp method to update each point of the sphere to a position that is between the state point and the new random vector unit length point based on a given alpha value.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// threejs-examples-sphere-mutate - r1 - random vector unit length with same direction</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, RENDRER, LIGHT</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0.02</span>,<span class="number">0.02</span>,<span class="number">0.02</span>)</div><div class="line">    <span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">0.5</span>, <span class="number">1000</span>);</div><div class="line">    camera.position.set(<span class="number">1.25</span>, <span class="number">0.25</span>, <span class="number">1.25</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    <span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">1</span>);</div><div class="line">    dl.position.set(<span class="number">3</span>, <span class="number">1</span>, <span class="number">-2</span>);</div><div class="line">    scene.add(dl);</div><div class="line">    <span class="keyword">const</span> al = <span class="keyword">new</span> THREE.AmbientLight(<span class="number">0xffffff</span>, <span class="number">0.1</span>);</div><div class="line">    scene.add(al);</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// create new vectors</span></div><div class="line">    <span class="keyword">const</span> createNewVectors = <span class="function">(<span class="params">mesh, mag</span>) =&gt;</span> &#123;</div><div class="line">        mag = mag === <span class="literal">undefined</span> ? <span class="number">0.25</span> : mag</div><div class="line">        <span class="keyword">const</span> pos = mesh.userData.pos_base;</div><div class="line">        <span class="keyword">const</span> len = pos.count, vstart=[], vend= [];</div><div class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">const</span> v = <span class="keyword">new</span> THREE.Vector3(pos.getX(i), pos.getY(i), pos.getZ(i));</div><div class="line">            <span class="keyword">const</span> ul = v.length();</div><div class="line">            vstart.push(v);</div><div class="line">            vend.push(v.clone().normalize().multiplyScalar(ul - mag + mag * <span class="number">2</span> * <span class="built_in">Math</span>.random()));</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        mesh.userData.vstart = vstart;</div><div class="line">        mesh.userData.vend = vend;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create the mesh object</span></div><div class="line">    <span class="keyword">const</span> createMesh = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> mesh = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">            <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">40</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="built_in">Math</span>.PI * <span class="number">1.6</span>), </div><div class="line">            <span class="keyword">new</span> THREE.MeshPhongMaterial(&#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'white'</span>,</div><div class="line">                <span class="attr">map</span>: texture,</div><div class="line">                <span class="attr">side</span>: THREE.DoubleSide</div><div class="line">            &#125;));</div><div class="line">        mesh.userData.pos_base = mesh.geometry.getAttribute(<span class="string">'position'</span>).clone();</div><div class="line">        createNewVectors(mesh);</div><div class="line">        <span class="keyword">return</span> mesh;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// update the mesh object</span></div><div class="line">    <span class="keyword">const</span> updateMeshGeo = <span class="function">(<span class="params">mesh, alpha</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> geo = mesh.geometry;</div><div class="line">        <span class="keyword">const</span> pos = geo.getAttribute(<span class="string">'position'</span>);</div><div class="line">        <span class="keyword">const</span> len = pos.count;</div><div class="line">        <span class="keyword">const</span> mud = mesh.userData;</div><div class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">const</span> v = mud.vstart[i].clone().lerp( mud.vend[i], alpha );</div><div class="line">            pos.array[i * <span class="number">3</span>] = v.x;</div><div class="line">            pos.array[i * <span class="number">3</span> + <span class="number">1</span>] = v.y;</div><div class="line">            pos.array[i * <span class="number">3</span> + <span class="number">2</span>] = v.z;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        pos.needsUpdate = <span class="literal">true</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// TEXTURE</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// USING THREE DATA TEXTURE To CREATE A RAW DATA TEXTURE</span></div><div class="line">    <span class="keyword">const</span> width = <span class="number">32</span>, height = <span class="number">32</span>;</div><div class="line">    <span class="keyword">const</span> size = width * height;</div><div class="line">    <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>( <span class="number">4</span> * size );</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i ++ ) &#123;</div><div class="line">        <span class="keyword">const</span> stride = i * <span class="number">4</span>;</div><div class="line">        <span class="keyword">const</span> a1 = i / size;</div><div class="line">        <span class="keyword">const</span> a2 = i % width / width;</div><div class="line">        <span class="keyword">const</span> v = <span class="number">30</span> + <span class="number">70</span> * <span class="built_in">Math</span>.random();</div><div class="line">        data[ stride ] = v + <span class="number">150</span> * a1;           <span class="comment">// red</span></div><div class="line">        data[ stride + <span class="number">1</span> ] = v + <span class="number">150</span> - <span class="number">150</span> * a1; <span class="comment">// green</span></div><div class="line">        data[ stride + <span class="number">2</span> ] = v + <span class="number">50</span> * a2;        <span class="comment">// blue</span></div><div class="line">        data[ stride + <span class="number">3</span> ] = <span class="number">255</span>;                <span class="comment">// alpha</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> texture = <span class="keyword">new</span> THREE.DataTexture( data, width, height );</div><div class="line">    texture.needsUpdate = <span class="literal">true</span>;</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// GEOMETRY, MESH</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh = createMesh();</div><div class="line">    scene.add(mesh);</div><div class="line">    camera.lookAt(mesh.position);</div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="comment">// ANIMATION LOOP</span></div><div class="line">    <span class="comment">// ---------- ----------</span></div><div class="line">    <span class="keyword">new</span> THREE.OrbitControls(camera, renderer.domElement);</div><div class="line">    <span class="keyword">const</span> FPS_UPDATE = <span class="number">12</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">    FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">    FRAME_MAX = <span class="number">300</span>;</div><div class="line">    <span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">    frame = <span class="number">0</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="comment">// update</span></div><div class="line">    <span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> alpha = frame / frameMax;</div><div class="line">        <span class="keyword">let</span> bias = <span class="number">1</span> - <span class="built_in">Math</span>.abs(<span class="number">0.5</span> - (alpha * <span class="number">4</span> % <span class="number">1</span>)) / <span class="number">0.5</span>;</div><div class="line">        <span class="keyword">if</span>(frame === <span class="number">0</span>)&#123;</div><div class="line">            createNewVectors(mesh, <span class="number">0.05</span> + <span class="number">0.20</span> * <span class="built_in">Math</span>.random())</div><div class="line">        &#125;</div><div class="line">        updateMeshGeo(mesh, bias);</div><div class="line">        mesh.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">4</span> * alpha;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// loop</span></div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">            <span class="comment">// update, render</span></div><div class="line">            update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            <span class="comment">// step frame</span></div><div class="line">            frame += FPS_MOVEMENT * secs;</div><div class="line">            frame %= FRAME_MAX;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="0-The-first-mutation-of-sphere-example"><a href="#0-The-first-mutation-of-sphere-example" class="headerlink" title="0 - The first mutation of sphere example"></a>0 - The first mutation of sphere example</h2><p>So now for the older r0 source code of this threejs example where I am changing the position of a point at the top of a sphere. In this example I started out with by set vertex helper method that I worked out in a previous example this week that had to do with the position attribute in general. This helper makes use of the geometry index property as a way to help change the right position data in the position attribute of a given geometry. When using the THREE.SphereGeometry constructor the return geometry will contain this index property as the constructor sets up a position attribute with a lower than usual number of points by reusing points. With certain other geometries there may not be an index, or there are ways of making a sphere geometry not indexed but maybe that is all a matter for another revision of this example or a whole other post.</p>
<p>I then have my update sphere top point helper method where I just pass a sphere geometry as the first argument, and then the y value for the top point of the sphere. So in other words this is a method where I can pull the top point of a sphere up or down along the y axis. Inside this helper method I get a reference to the position attribute of the sphere geometry, and then I also create a new position object that will be used for all points of all triangles that are at that point. I then use the set vertex helper to set the position of all of these points in the body of a while loop. When it comes to setting up a condition for getting out of the while loop I have found that I can use the width segments parameter as a way to create a value that seems to work well with just about any sphere that I pass to it.</p>
<p>I then set up a scene object, renderer and camera just like with any other threejs example. I then create a mesh object that will of course use the THREE.SphereGeomerty constructor  and add the mesh to the scene. I then also have a main animation loop for this example and in the body of that loop I am calling my update sphere top point method that will change the position of the top point of the sphere over time.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// set location of a vert given an index value in geometry.index</span></div><div class="line">    <span class="keyword">var</span> setVert = <span class="function"><span class="keyword">function</span> (<span class="params">geometry, vertIndex, pos</span>) </span>&#123;</div><div class="line">        pos = pos || &#123;&#125;;</div><div class="line">        <span class="keyword">var</span> posIndex = geometry.index.array[vertIndex] * <span class="number">3</span>,</div><div class="line">        position = geometry.getAttribute(<span class="string">'position'</span>);</div><div class="line">        position.array[posIndex] = pos.x === <span class="literal">undefined</span> ? position.array[posIndex] : pos.x;</div><div class="line">        position.array[posIndex + <span class="number">1</span>] = pos.y === <span class="literal">undefined</span> ? position.array[posIndex + <span class="number">1</span>] : pos.y;</div><div class="line">        position.array[posIndex + <span class="number">2</span>] = pos.z === <span class="literal">undefined</span> ? position.array[posIndex + <span class="number">2</span>] : pos.z;</div><div class="line">        position.needsUpdate = <span class="literal">true</span>;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// update top of sphere</span></div><div class="line">    <span class="keyword">var</span> updateSphereTopPoint = <span class="function"><span class="keyword">function</span> (<span class="params">geometry, topPoint</span>) </span>&#123;</div><div class="line">        topPoint = topPoint === <span class="literal">undefined</span> ? <span class="number">0.5</span> : topPoint;</div><div class="line">        <span class="keyword">var</span> position = geometry.getAttribute(<span class="string">'position'</span>);</div><div class="line">        <span class="keyword">var</span> pos = &#123;</div><div class="line">            <span class="attr">x</span>: position.array[<span class="number">0</span>],</div><div class="line">            <span class="attr">y</span>: topPoint,</div><div class="line">            <span class="attr">z</span>: position.array[<span class="number">2</span>]</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// getting width segments of sphere</span></div><div class="line">        <span class="keyword">var</span> ws = geometry.parameters.widthSegments;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; ws * <span class="number">3</span>) &#123;</div><div class="line">            setVert(geometry, i, pos);</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// scene</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"> </div><div class="line">    <span class="comment">// GEOMETRY</span></div><div class="line">    <span class="keyword">var</span> geometry = <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">30</span>, <span class="number">10</span>);</div><div class="line">    <span class="keyword">var</span> mesh = <span class="keyword">new</span> THREE.Mesh(geometry, <span class="keyword">new</span> THREE.MeshStandardMaterial(&#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'red'</span>,</div><div class="line">                <span class="attr">side</span>: THREE.DoubleSide</div><div class="line">            &#125;));</div><div class="line">    scene.add(mesh);</div><div class="line"> </div><div class="line">    <span class="comment">// CAMERA</span></div><div class="line">    <span class="keyword">var</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">4</span> / <span class="number">3</span>, <span class="number">0.5</span>, <span class="number">1000</span>);</div><div class="line">    camera.position.set(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    camera.lookAt(mesh.position);</div><div class="line">    scene.add(camera);</div><div class="line"> </div><div class="line">    <span class="comment">// LIGHT</span></div><div class="line">    <span class="keyword">var</span> light = <span class="keyword">new</span> THREE.PointLight(<span class="number">0xffffff</span>, <span class="number">1</span>);</div><div class="line">    light.position.set(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">    camera.add(light);</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.AmbientLight(<span class="number">0xffffff</span>, <span class="number">0.25</span>));</div><div class="line"> </div><div class="line">    <span class="comment">// RENDER</span></div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>);</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> per = <span class="number">0</span>,</div><div class="line">    bias,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    maxFrames = <span class="number">300</span>,</div><div class="line">    FPS = <span class="number">30</span>;</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span> (secs &gt; <span class="number">1</span> / FPS) &#123;</div><div class="line">            per += <span class="number">1</span> / (maxFrames / FPS) * secs;</div><div class="line">            per %= <span class="number">1</span>;</div><div class="line">            bias = <span class="number">1</span> - <span class="built_in">Math</span>.abs(per - <span class="number">0.5</span>) / <span class="number">0.5</span>;</div><div class="line">            <span class="comment">// calling update sphere helper</span></div><div class="line">            updateSphereTopPoint(geometry, <span class="number">0.75</span> - <span class="number">0.75</span> * bias);</div><div class="line"> </div><div class="line">            renderer.render(scene, camera);</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line"> </div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<p>This example might have turned out into a decent starting point at least when it comes to just playing around with sphere geometry, however there are so many other things that come to mind that I would like to work out and have a better understanding in place still. Some things that might help would be to just loop over all the points in a geometry and return all the points that share the same point in space. That way I can just call that method and move all points that are at that location which might prove to be a very helpful tool when it comes to doing things like this.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So then that will be it for now when it comes to this threejs example on mutating the values of a position attribute of a geometry of a sphere. Thus far I have to versions of this example, but I have many more ideas for sure when it comes to this sort of thing. There is also doing what I am doing here but with one of the other built in geometries such as a plane geometry, or maybe even better yet a custom geometry that is just three points in space when it comes to focusing on cretin fore basics better.</p>
<p>There as a whole lot more that comes to mind that I have not even wrote down in terms of additional similar ideas for sphere mutation projects. I will still want to work out at least a few more basic core examples though before I start to go nuts with this and start making a whole bunch more revisions, maybe even going to far as making some kind of module that helper abstract away much of what I have code to learn thus far about sphere geometry and then just make a whole bunch of demos for each future revision.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/" data-id="clfy54j7p02f6q4v1qgormcm1" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/three-js/">three.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/06/11/threejs-examples-plane-mutate/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Mutating a point in the geometry created with the plane geometry constrictor with threejs
        
      </div>
    </a>
  
  
    <a href="/2021/06/09/threejs-buffer-geometry-attributes-uv/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Texture offsets of buffer geometries in threejs with the uv attribute</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/index.html';
    this.page.identifier = '886';
    this.page.title = 'Sphere Geometry Mutation of position attribute threejs example';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 15.45px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.64px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13.64px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.82px;">express</a> <a href="/tags/games/" style="font-size: 17.27px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.55px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.73px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.64px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.55px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.91px;">python</a> <a href="/tags/statistics/" style="font-size: 14.09px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19.09px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16.36px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/03/31/threejs-quaternion-premultiply/">Quaternion premultiply method in threejs</a>
          </li>
        
          <li>
            <a href="/2023/03/24/threejs-quaternion/">Quaternion rotation objects in threejs</a>
          </li>
        
          <li>
            <a href="/2023/03/17/threejs-examples-svg-tools/">SVG tools module threejs example</a>
          </li>
        
          <li>
            <a href="/2023/03/10/threejs-examples-camera-planes/">Camera Planes module threejs example</a>
          </li>
        
          <li>
            <a href="/2023/03/03/threejs-examples-breath-module/">A Breath Module threejs project example</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas</a>
  
    <a href="https://www.youtube.com/user/javaweaver" class="mobile-nav-link">Youtube</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2021/06/10/threejs-examples-sphere-mutate/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>