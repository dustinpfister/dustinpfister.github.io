<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>A game framework JavaScript example | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This week I made another major JavaScript example this time it is a current standard game framework. This project is actually me using a whole bunch of different projects that I have made over time to">
<meta property="og:type" content="article">
<meta property="og:title" content="A game framework JavaScript example">
<meta property="og:url" content="https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="This week I made another major JavaScript example this time it is a current standard game framework. This project is actually me using a whole bunch of different projects that I have made over time to">
<meta property="og:updated_time" content="2021-09-03T19:19:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A game framework JavaScript example">
<meta name="twitter:description" content="This week I made another major JavaScript example this time it is a current standard game framework. This project is actually me using a whole bunch of different projects that I have made over time to">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS-Examples</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas-Examples</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-js-javascript-example-game-framework" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/03/js-javascript-example-game-framework/" class="article-date"> Published:
  <time datetime="2021-09-03T17:39:00.000Z" itemprop="datePublished">2021-09-03</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2021/09/03/js-javascript-example-game-framework/" class="article-date"> Modified:
  <time datetime="2021-09-03T19:19:34.000Z" itemprop="dateModified">2021-09-03</time>
</a>

    <span class="article-date">V1.25</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      A game framework JavaScript example
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>This week I made another major <a href="/2021/04/02/js-javascript-example/">JavaScript example</a> this time it is a current standard game framework. This project is actually me using a whole bunch of different projects that I have made over time to create one massive central project of a javaScript example. The thing about this here is that I am getting tired of writing the same code over and over again each time I start a new project, which is often going to be the case when it comes to making the project a vanilla javaScript project. After all that term means I am writing all the code from the ground up rather than using some popular framework. So if I am getting tired of writing everything all over again each time I start a new project, but I do not want to use someone else framework, then I guess I just have to make my own.</p>
<p>As of this writing this game frame work has all the basic features that I would want to have in a game frame work at least. A must have feature of a project such as this would be a state machine which is in place all ready. On top of that there is a canvas module that supports layering, and an object pool that I can use to quickly create a collection of display objects.</p>
<a id="more"></a>
<h2 id="1-The-utils-lib"><a href="#1-The-utils-lib" class="headerlink" title="1 - The utils lib"></a>1 - The utils lib</h2><p>First off when  it comes to making any kind of major project like this I am going to want to have a main utility library. This is a place where I will park and and all methods that I might want to use across one or more modules in the over all project, and I can not thing of nay better place to park them. I have <a href="/2021/08/06/js-javascript-example-utils/">wrote another javaScript example post on a general from of this kind of utility module</a>, but I use a custom cut form of it for any given project.</p>
<p>For this game framework thus far I have made one important additional that I will likely add to my general from of this kind of utilizes lib, which is a basic http client. For this I quickly put together something that works okay thus far that just makes use of <a href="/2018/03/28/js-xmlhttprequest/">XMLHttpRequest to preform http requests</a>. One of the features that I want to have in this game framework is an external assets loader of some kind, so this is a much have method.</p>
<p>So far I just have some of the usual suspect methods when it comes to game development. With that said there is a bounding box methods, as well as a distance method. I also often end up needing a mathematical modulo method when working out game logic also.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> utils = &#123;&#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** *********/</span></div><div class="line"><span class="comment">//  HTTP</span></div><div class="line"> <span class="comment">/********* ********** ********** *********/</span></div><div class="line"> </div><div class="line"><span class="comment">// very simple http client</span></div><div class="line">utils.http = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> opt = opt || &#123;&#125;;</div><div class="line">    <span class="comment">// default options</span></div><div class="line">    opt.url = opt.url || <span class="string">''</span>;</div><div class="line">    opt.method = opt.method || <span class="string">'GET'</span>;</div><div class="line">    opt.async = opt.async === <span class="literal">undefined</span> ? <span class="literal">true</span>: opt.async;</div><div class="line">    opt.body = opt.body === <span class="literal">undefined</span> ? <span class="literal">null</span>: opt.body;</div><div class="line">    opt.onDone = opt.onDone || utils.noop;</div><div class="line">    opt.onError = opt.onError || utils.noop;</div><div class="line">    opt.responseType = opt.responseType || <span class="string">''</span>;  <span class="comment">// set to 'blob' for png</span></div><div class="line">    <span class="comment">// create and set up xhr</span></div><div class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">    xhr.responseType = opt.responseType;</div><div class="line">    xhr.open(opt.method, opt.url, opt.async);</div><div class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</div><div class="line">            <span class="keyword">if</span>(xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">400</span>)&#123;</div><div class="line">                opt.onDone.call(xhr, xhr.response, xhr);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                opt.onError.call(xhr, xhr);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// send</span></div><div class="line">    xhr.send(opt.body);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// load just a png file, this calls utils.http with proper settings, and the response is an Image</span></div><div class="line">utils.httpPNG = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">    opt = opt || &#123;&#125;;</div><div class="line">    opt.onDone = opt.onDone || utils.noop;</div><div class="line">    opt.onError = opt.onError || utils.noop;</div><div class="line">    utils.http(&#123;</div><div class="line">        <span class="attr">url</span>: opt.url,</div><div class="line">        <span class="attr">responseType</span>: <span class="string">'blob'</span>,</div><div class="line">        <span class="attr">onDone</span> : <span class="function"><span class="keyword">function</span>(<span class="params">res, xhr</span>)</span>&#123;</div><div class="line">            <span class="keyword">var</span> imageURL = <span class="built_in">window</span>.URL.createObjectURL(res);</div><div class="line">            <span class="keyword">var</span> image = <span class="keyword">new</span> Image();</div><div class="line">            image.src = imageURL;</div><div class="line">            opt.onDone.call(xhr, image, xhr);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">onError</span>: opt.onError</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** *********/</span></div><div class="line"><span class="comment">//  MISCELLANEOUS METHODS</span></div><div class="line"> <span class="comment">/********* ********** ********** *********/</span></div><div class="line"> </div><div class="line"><span class="comment">// no operation ref</span></div><div class="line">utils.noop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"><span class="comment">// distance</span></div><div class="line">utils.distance = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, x2, y2</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(x1 - x2, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(y1 - y2, <span class="number">2</span>));</div><div class="line">&#125;;</div><div class="line"><span class="comment">// bounding box</span></div><div class="line">utils.boundingBox = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, w1, h1, x2, y2, w2, h2</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> !(</div><div class="line">        y1 + h1 &lt; y2 ||</div><div class="line">        y1 &gt; y2 + h2 ||</div><div class="line">        x1 + w1 &lt; x2 ||</div><div class="line">        x1 &gt; x2 + w2);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// mathematical modulo</span></div><div class="line">utils.mod = <span class="function"><span class="keyword">function</span> (<span class="params">x, m</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (x % m + m) % m;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** *********/</span></div><div class="line"><span class="comment">//  BASIC EXP SYSTEM</span></div><div class="line"> <span class="comment">/********* ********** ********** *********/</span></div><div class="line"> </div><div class="line"><span class="comment">// Basic experience point system methods</span></div><div class="line">utils.XP = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// default values</span></div><div class="line">    <span class="keyword">var</span> default_deltaNext = <span class="number">50</span>,</div><div class="line">    defualt_cap = <span class="number">100</span>;</div><div class="line">    <span class="comment">// get level with given xp</span></div><div class="line">    <span class="keyword">var</span> getLevel = <span class="function"><span class="keyword">function</span> (<span class="params">xp, deltaNext</span>) </span>&#123;</div><div class="line">        deltaNext = deltaNext === <span class="literal">undefined</span> ? default_deltaNext : deltaNext;</div><div class="line">        <span class="keyword">return</span> (<span class="number">1</span> + <span class="built_in">Math</span>.sqrt(<span class="number">1</span> + <span class="number">8</span> * xp / deltaNext)) / <span class="number">2</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get exp to the given level with given current_level and xp</span></div><div class="line">    <span class="keyword">var</span> getXP = <span class="function"><span class="keyword">function</span> (<span class="params">level, deltaNext</span>) </span>&#123;</div><div class="line">        deltaNext = deltaNext === <span class="literal">undefined</span> ? default_deltaNext : deltaNext;</div><div class="line">        <span class="keyword">return</span> ((<span class="built_in">Math</span>.pow(level, <span class="number">2</span>) - level) * deltaNext) / <span class="number">2</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// parse a levelObj by XP</span></div><div class="line">    <span class="keyword">var</span> parseByXP = <span class="function"><span class="keyword">function</span> (<span class="params">xp, cap, deltaNext</span>) </span>&#123;</div><div class="line">        <span class="comment">//cap = cap === undefined ? default_cap : cap;</span></div><div class="line">        <span class="keyword">var</span> l = getLevel(xp);</div><div class="line">        l = l &gt; cap ? cap : l;</div><div class="line">        <span class="keyword">var</span> level = <span class="built_in">Math</span>.floor(l),</div><div class="line">        forNext = getXP(level + <span class="number">1</span>);</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">level</span>: level,</div><div class="line">            <span class="attr">levelFrac</span>: l,</div><div class="line">            <span class="attr">per</span>: l % <span class="number">1</span>,</div><div class="line">            <span class="attr">xp</span>: xp,</div><div class="line">            <span class="attr">forNext</span>: l === cap ? <span class="literal">Infinity</span> : forNext,</div><div class="line">            <span class="attr">toNext</span>: l === cap ? <span class="literal">Infinity</span> : forNext - xp</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="comment">// use getXP method and then pass that to parseXP for utils.XP.parseByLevel</span></div><div class="line">        parseByLevel: <span class="function"><span class="keyword">function</span> (<span class="params">l, cap, deltaNext</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> parseByXP(getXP(l, deltaNext), cap);</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// can just directly use parseByXP for utils.XP.parseByXP</span></div><div class="line">        parseByXP: parseByXP</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="2-The-object-pool-lib"><a href="#2-The-object-pool-lib" class="headerlink" title="2 - The object pool lib"></a>2 - The object pool lib</h2><p>A must have feature of any kind of game framework might be to have some kind of object pool module. For this I started out with what it is that I worked out for my <a href="/2020/07/20/canvas-example-object-pool/">canvas example post on object pools</a>, and I made just a few minor changes thus far.</p>
<p>The module is used by calling the main create method of the module, and when doing so I pass some options when it comes to how to go about setting up the object pool. One of the most impotent options of this would be the count option which is what the fixed size of the object pool module should be. I also can give methods that are to be fired when an object is spawned, updated and purged.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> poolMod = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// Public API</span></div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line">    <span class="comment">// get next inactive object in the given pool</span></div><div class="line">    <span class="keyword">var</span> getInactive = <span class="function"><span class="keyword">function</span> (<span class="params">pool</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = pool.objects.length,</div><div class="line">        obj;</div><div class="line">        <span class="keyword">while</span> (i--) &#123;</div><div class="line">            obj = pool.objects[i];</div><div class="line">            <span class="keyword">if</span> (!obj.active) &#123;</div><div class="line">                <span class="keyword">return</span> obj;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a new pool</span></div><div class="line">    api.create = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.count = opt.count || <span class="number">10</span>;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>,</div><div class="line">        pool = &#123;</div><div class="line">            <span class="attr">objects</span>: [],</div><div class="line">            <span class="attr">secsCap</span>: opt.secsCap === <span class="literal">undefined</span> ? <span class="literal">Infinity</span> : opt.secsCap,</div><div class="line">            <span class="attr">disableLifespan</span>: opt.disableLifespan || <span class="literal">false</span>,</div><div class="line">            <span class="attr">data</span>: opt.data || &#123;&#125;,</div><div class="line">            <span class="attr">spawn</span>: opt.spawn || <span class="function"><span class="keyword">function</span> (<span class="params">obj, pool, state, opt</span>) </span>&#123;&#125;,</div><div class="line">            <span class="attr">purge</span>: opt.purge || <span class="function"><span class="keyword">function</span> (<span class="params">obj, pool, state</span>) </span>&#123;&#125;,</div><div class="line">            <span class="attr">update</span>: opt.update || <span class="function"><span class="keyword">function</span> (<span class="params">obj, pool, state, secs</span>) </span>&#123;&#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">while</span> (i &lt; opt.count) &#123;</div><div class="line">            pool.objects.push(&#123;</div><div class="line">                <span class="attr">active</span>: <span class="literal">false</span>,</div><div class="line">                <span class="attr">i</span>: i,</div><div class="line">                <span class="attr">x</span>: opt.x === <span class="literal">undefined</span> ? <span class="number">0</span> : opt.x,</div><div class="line">                <span class="attr">y</span>: opt.y === <span class="literal">undefined</span> ? <span class="number">0</span> : opt.y,</div><div class="line">                <span class="attr">w</span>: opt.w === <span class="literal">undefined</span> ? <span class="number">32</span> : opt.w,</div><div class="line">                <span class="attr">h</span>: opt.h === <span class="literal">undefined</span> ? <span class="number">32</span> : opt.h,</div><div class="line">                <span class="attr">heading</span>: opt.heading === <span class="literal">undefined</span> ? <span class="number">0</span> : opt.heading,</div><div class="line">                <span class="attr">pps</span>: opt.pps === <span class="literal">undefined</span> ? <span class="number">32</span> : opt.pps,</div><div class="line">                <span class="attr">lifespan</span>: opt.lifespan || <span class="number">3</span>,</div><div class="line">                <span class="attr">data</span>: &#123;&#125;</div><div class="line">            &#125;);</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pool;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// spawn the next inactive object in the given pool</span></div><div class="line">    api.spawn = <span class="function"><span class="keyword">function</span> (<span class="params">pool, state, opt</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> obj = getInactive(pool);</div><div class="line">        state = state || &#123;&#125;;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">if</span> (obj) &#123;</div><div class="line">            <span class="keyword">if</span> (!obj.active) &#123;</div><div class="line">                obj.active = <span class="literal">true</span>;</div><div class="line">                pool.spawn.call(pool, obj, pool, state, opt);</div><div class="line">                <span class="keyword">return</span> obj;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;;</div><div class="line">    api.spawnAll = <span class="function"><span class="keyword">function</span>(<span class="params">pool, state, opt</span>)</span>&#123;</div><div class="line">        pool.objects.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span> (!obj.active) &#123;</div><div class="line">                obj.active = <span class="literal">true</span>;</div><div class="line">                pool.spawn.call(pool, obj, pool, state, opt);</div><div class="line">                <span class="keyword">return</span> obj;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">return</span> pool.objects;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// update a pool object by a secs value</span></div><div class="line">    api.update = <span class="function"><span class="keyword">function</span> (<span class="params">pool, secs, state</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = pool.objects.length,</div><div class="line">        obj;</div><div class="line">        state = state || &#123;&#125;; <span class="comment">// your projects state object</span></div><div class="line">        secs = secs &gt; pool.secsCap ? pool.secsCap : secs;</div><div class="line">        <span class="keyword">while</span> (i--) &#123;</div><div class="line">            obj = pool.objects[i];</div><div class="line">            <span class="keyword">if</span> (obj.active) &#123;</div><div class="line">                pool.update.call(pool, obj, pool, state, secs);</div><div class="line">                <span class="comment">// if disableLifespan featre</span></div><div class="line">                <span class="keyword">if</span>(pool.disableLifespan)&#123;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="comment">// else use lifespan feature</span></div><div class="line">                    obj.lifespan -= secs;</div><div class="line">                    obj.lifespan = obj.lifespan &lt; <span class="number">0</span> ? <span class="number">0</span> : obj.lifespan;</div><div class="line">                    <span class="keyword">if</span> (obj.lifespan === <span class="number">0</span>) &#123;</div><div class="line">                        obj.active = <span class="literal">false</span>;</div><div class="line">                        pool.purge.call(pool, obj, pool, state);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// set all to inActive or active state</span></div><div class="line">    api.setActiveStateForAll = <span class="function"><span class="keyword">function</span> (<span class="params">pool, bool</span>) </span>&#123;</div><div class="line">        bool = bool === <span class="literal">undefined</span> ? <span class="literal">false</span> : bool;</div><div class="line">        <span class="keyword">var</span> i = pool.objects.length,</div><div class="line">        obj;</div><div class="line">        <span class="keyword">while</span> (i--) &#123;</div><div class="line">            obj = pool.objects[i];</div><div class="line">            obj.active = bool;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// move the given object by its current heading and pps</span></div><div class="line">    api.moveByPPS = <span class="function"><span class="keyword">function</span> (<span class="params">obj, secs</span>) </span>&#123;</div><div class="line">        obj.x += <span class="built_in">Math</span>.cos(obj.heading) * obj.pps * secs;</div><div class="line">        obj.y += <span class="built_in">Math</span>.sin(obj.heading) * obj.pps * secs;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// check bounds for the given display object and canvas and return true if the object</span></div><div class="line">    <span class="comment">// is out of bounds and false if it is not.</span></div><div class="line">    api.checkBounds = <span class="function"><span class="keyword">function</span> (<span class="params">obj, canvas</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (obj.x &gt;= canvas.width || obj.x &lt; obj.w * <span class="number">-1</span> || obj.y &gt; canvas.height || obj.y &lt; obj.h * <span class="number">-1</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// bounding box</span></div><div class="line">    <span class="comment">//api.boundingBox = function (a, b) &#123;</span></div><div class="line">    <span class="comment">//    return utils.boundingBox(a.x, a.y, a.w, a.h, b.x, b.y, b.w, b.h);</span></div><div class="line">    <span class="comment">//&#125;;</span></div><div class="line">    <span class="comment">// return public method</span></div><div class="line">    <span class="keyword">return</span> api;</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="3-The-canvas-lib-and-plug-ins"><a href="#3-The-canvas-lib-and-plug-ins" class="headerlink" title="3 - The canvas lib and plug-ins"></a>3 - The canvas lib and plug-ins</h2><p>I am going to want to have a canvas module as part of this game framework as that is just a major part of making any kind of html and javaScript game these days. The module should have at least a few basic features that such a module should have, and the first thing that comes to mind for this sort of thing is to have layers actually. Last week I started another javaScript example that is just this more or less which is of course my first <a href="/2021/08/27/js-javascript-example-canvas-module">canvas module javaScript example</a>. So I started with what I had for that post, and just started making a few changes here and there, and added some plug ins for it.</p>
<h3 id="3-1-The-canvas-lib"><a href="#3-1-The-canvas-lib" class="headerlink" title="3.1 - The canvas lib"></a>3.1 - The canvas lib</h3><p>Here is the canvas lib source code as it currently stands as of this writing. In the body of the core source code of this module I have a few built in draw methods. One f which is to create a current layer, another is to draw a background. I also have built in draw methods for printing some text to a layer, as well as a collection of points created with one of the points methods built into this module or added by way of a plug in.</p>
<p>Speaking of points there are also just one built in points method which will create and return a box in the from of a collection of points. After that it is just a bunch of helper functions for the public methods of this module, one of which is for creating the main stack of layers that is used with this modules other public methods. On top of course having a pubic method for creating a stack of layers there is also the main draw and create points methods as well as a load method which is what I use ti extend the features of this module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> FEATURES = &#123;&#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** *********</span></div><div class="line"> Draw Methods</div><div class="line">********** ********** *********/</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> drawMethods = FEATURES.drawMethods = &#123;&#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// clear a layer</span></div><div class="line">    drawMethods.clear = <span class="function"><span class="keyword">function</span>(<span class="params">stack, ctx, canvas, layerObj</span>)</span>&#123;</div><div class="line">        ctx.clearRect(<span class="number">-2</span>, <span class="number">-2</span>, canvas.width + <span class="number">2</span>, canvas.height + <span class="number">2</span>);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// draw a background</span></div><div class="line">    drawMethods.background = <span class="function"><span class="keyword">function</span> (<span class="params">stack, ctx, canvas, layerObj, background</span>) </span>&#123;</div><div class="line">        ctx.fillStyle = background || stack.background || <span class="string">'black'</span>;</div><div class="line">        ctx.fillRect(<span class="number">-2</span>, <span class="number">-2</span>, canvas.width + <span class="number">2</span>, canvas.height + <span class="number">2</span>);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// built in print method</span></div><div class="line">    drawMethods.print = <span class="function"><span class="keyword">function</span>(<span class="params">stack, ctx, canvas, layerObj, text, x, y, opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.fontSize = opt.fontSize || <span class="number">10</span>;</div><div class="line">        ctx.fillStyle = opt.fillStyle || <span class="string">'black'</span>;</div><div class="line">        ctx.textBaseline = opt.baseLine || <span class="string">'top'</span>;</div><div class="line">        ctx.textAlign = opt.align || <span class="string">'left'</span>;</div><div class="line">        ctx.font = opt.fontSize + <span class="string">'px arial'</span>;</div><div class="line">        ctx.fillText(text, x, y);    </div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// draw a points collection</span></div><div class="line">    drawMethods.points = <span class="function"><span class="keyword">function</span> (<span class="params">stack, ctx, canvas, layerObj, points, cx, cy, opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        ctx.save();</div><div class="line">        ctx.translate(cx, cy);</div><div class="line">        points.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">pointArray</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> len = pointArray.length,</div><div class="line">            close = opt.close === <span class="literal">undefined</span> ? <span class="literal">true</span> : opt.close,</div><div class="line">            fill = opt.fill === <span class="literal">undefined</span> ? <span class="string">'black'</span> : opt.fill,</div><div class="line">            stroke = opt.stroke === <span class="literal">undefined</span> ? <span class="string">'white'</span> : opt.stroke,</div><div class="line">            lineWidth = opt.lineWidth === <span class="literal">undefined</span> ? <span class="number">3</span> : opt.lineWidth,</div><div class="line">            el,</div><div class="line">            i = <span class="number">2</span>;</div><div class="line">            ctx.beginPath();</div><div class="line">            ctx.moveTo(pointArray[<span class="number">0</span>], pointArray[<span class="number">1</span>]);</div><div class="line">            <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">                el = pointArray[i];</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> el === <span class="string">'number'</span>) &#123;</div><div class="line">                    ctx.lineTo(el, pointArray[i + <span class="number">1</span>]);</div><div class="line">                    i += <span class="number">2</span>;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">var</span> parts = el.split(<span class="string">':'</span>);</div><div class="line">                    <span class="keyword">if</span> (parts[<span class="number">0</span>] === <span class="string">'close'</span>) &#123;</div><div class="line">                        close = parts[<span class="number">1</span>] === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (parts[<span class="number">0</span>] === <span class="string">'stroke'</span>) &#123;</div><div class="line">                        stroke = parts[<span class="number">1</span>] || <span class="literal">false</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (parts[<span class="number">0</span>] === <span class="string">'fill'</span>) &#123;</div><div class="line">                        fill = parts[<span class="number">1</span>] || <span class="literal">false</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (parts[<span class="number">0</span>] === <span class="string">'lineWidth'</span>) &#123;</div><div class="line">                        lineWidth = parts[<span class="number">1</span>] || <span class="number">1</span>;</div><div class="line">                    &#125;</div><div class="line">                    i += <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            ctx.lineWidth = lineWidth;</div><div class="line">            <span class="keyword">if</span> (close) &#123;</div><div class="line">                ctx.closePath();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (fill) &#123;</div><div class="line">                ctx.fillStyle = fill;</div><div class="line">                ctx.fill();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (stroke) &#123;</div><div class="line">                ctx.strokeStyle = stroke;</div><div class="line">                ctx.stroke();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        ctx.restore();</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** *********</span></div><div class="line"> Points Methods</div><div class="line">********** ********** *********/</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> pointsMethods = FEATURES.pointsMethods = &#123;&#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// create a box</span></div><div class="line">    pointsMethods.box = <span class="function"><span class="keyword">function</span>(<span class="params">sx, sy, w, h</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> x = sx - w / <span class="number">4</span>,</div><div class="line">        y = sy - h / <span class="number">4</span>;</div><div class="line">        <span class="keyword">var</span> points = [[</div><div class="line">            x, y, x + w / <span class="number">2</span>, y,</div><div class="line">            x + w / <span class="number">2</span>, y + h / <span class="number">2</span>, x, y + h / <span class="number">2</span></div><div class="line">        ]];</div><div class="line">        <span class="keyword">return</span> points;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** *********</span></div><div class="line"> HELPERS</div><div class="line">********** ********** *********/</div><div class="line"> </div><div class="line">    <span class="comment">// get a canvas relative position that is adjusted for scale</span></div><div class="line">    <span class="keyword">var</span> getCanvasRelative = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> canvas = e.target,</div><div class="line">        bx = canvas.getBoundingClientRect(),</div><div class="line">        pos = &#123;</div><div class="line">            <span class="attr">x</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientX : e.clientX) - bx.left,</div><div class="line">            <span class="attr">y</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientY : e.clientY) - bx.top,</div><div class="line">            <span class="attr">bx</span>: bx</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// adjust for native canvas matrix size</span></div><div class="line">        pos.x = <span class="built_in">Math</span>.floor((pos.x / canvas.scrollWidth) * canvas.width);</div><div class="line">        pos.y = <span class="built_in">Math</span>.floor((pos.y / canvas.scrollHeight) * canvas.height);</div><div class="line">        <span class="keyword">return</span> pos;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create and return a canvas pointer event handler for a stack</span></div><div class="line">    <span class="keyword">var</span> canvasPointerEventHandler = <span class="function"><span class="keyword">function</span> (<span class="params">stack, state, events</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> pos = getCanvasRelative(e),</div><div class="line">            handler = <span class="literal">null</span>;</div><div class="line">            e.preventDefault();</div><div class="line">            <span class="keyword">if</span> (e.type === <span class="string">'mousedown'</span> || e.type === <span class="string">'touchstart'</span>) &#123;</div><div class="line">                handler = events[<span class="string">'pointerStart'</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (e.type === <span class="string">'mousemove'</span> || e.type === <span class="string">'touchmove'</span>) &#123;</div><div class="line">                handler = events[<span class="string">'pointerMove'</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (e.type === <span class="string">'mouseup'</span> || e.type === <span class="string">'touchend'</span>) &#123;</div><div class="line">                handler = events[<span class="string">'pointerEnd'</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (handler) &#123;</div><div class="line">                handler.call(state, e, pos, state, stack);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// attach canvas pointer events</span></div><div class="line">    <span class="keyword">var</span> attachCanvasPointerEvents = <span class="function"><span class="keyword">function</span> (<span class="params">stack</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> handler = canvasPointerEventHandler(stack, stack.state, stack.events),</div><div class="line">        canvas = stack[stack.length - <span class="number">1</span>].canvas,</div><div class="line">        options = &#123;</div><div class="line">            <span class="attr">passive</span>: <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">        canvas.addEventListener(<span class="string">'mousedown'</span>, handler, options);</div><div class="line">        canvas.addEventListener(<span class="string">'mousemove'</span>, handler, options);</div><div class="line">        canvas.addEventListener(<span class="string">'mouseup'</span>, handler, options);</div><div class="line">        canvas.addEventListener(<span class="string">'touchstart'</span>, handler, options);</div><div class="line">        canvas.addEventListener(<span class="string">'touchmove'</span>, handler, options);</div><div class="line">        canvas.addEventListener(<span class="string">'touchend'</span>, handler, options);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a single layer object</span></div><div class="line">    <span class="keyword">var</span> createLayer = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.append = opt.append === <span class="literal">undefined</span> ? <span class="literal">true</span> : opt.append;</div><div class="line">        <span class="keyword">var</span> layer = &#123;&#125;;</div><div class="line">        <span class="comment">// a layer should have a container</span></div><div class="line">        layer.container = opt.container || <span class="built_in">document</span>.getElementById(<span class="string">'canvas-app'</span>) || <span class="built_in">document</span>.body;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> layer.container === <span class="string">'string'</span>) &#123;</div><div class="line">            layer.container = <span class="built_in">document</span>.querySelector(layer.container);</div><div class="line">        &#125;</div><div class="line">        layer.canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</div><div class="line">        layer.ctx = layer.canvas.getContext(<span class="string">'2d'</span>);</div><div class="line">        <span class="comment">// assign the 'canvas_layer' className</span></div><div class="line">        layer.canvas.className = <span class="string">'canvas_layer'</span>;</div><div class="line">        <span class="comment">// set native width</span></div><div class="line">        layer.canvas.width = opt.width === <span class="literal">undefined</span> ? <span class="number">320</span> : opt.width;</div><div class="line">        layer.canvas.height = opt.height === <span class="literal">undefined</span> ? <span class="number">240</span> : opt.height;</div><div class="line">        <span class="comment">// translate by 0.5, 0.5</span></div><div class="line">        layer.ctx.translate(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line">        <span class="comment">// disable default action for onselectstart</span></div><div class="line">        layer.canvas.onselectstart = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// append canvas to container</span></div><div class="line">        <span class="keyword">if</span> (opt.append) &#123;</div><div class="line">            layer.container.appendChild(layer.canvas);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> layer;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** *********</span></div><div class="line"> PUBLIC API</div><div class="line">********** ********** *********/</div><div class="line"> </div><div class="line">    <span class="comment">// create a stack of layers as an 'Array Like' Object</span></div><div class="line">    api.createLayerStack = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="comment">// creating an array like object</span></div><div class="line">        <span class="keyword">var</span> stack = &#123;</div><div class="line">            <span class="attr">length</span>: opt.length === <span class="literal">undefined</span> ? <span class="number">2</span> : opt.length,</div><div class="line">            <span class="attr">container</span>: opt.container || <span class="built_in">document</span>.getElementById(<span class="string">'canvas-app'</span>) || <span class="built_in">document</span>.body,</div><div class="line">            <span class="attr">events</span>: opt.events || &#123;&#125;,</div><div class="line">            <span class="attr">state</span>: opt.state || &#123;&#125;,</div><div class="line">            <span class="attr">background</span>: opt.background || <span class="string">'blue'</span></div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> stack.container === <span class="string">'string'</span>) &#123;</div><div class="line">            stack.container = <span class="built_in">document</span>.querySelector(stack.container);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// layer options</span></div><div class="line">        <span class="keyword">var</span> layerOpt = &#123;</div><div class="line">            <span class="attr">container</span>: stack.container,</div><div class="line">            <span class="attr">append</span>: <span class="literal">true</span>,</div><div class="line">            <span class="attr">width</span>: opt.width || <span class="number">320</span>,</div><div class="line">            <span class="attr">height</span>: opt.height || <span class="number">240</span></div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// create layers for the stack</span></div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; stack.length) &#123;</div><div class="line">            stack[i] = createLayer(layerOpt);</div><div class="line">            stack[i].i = i;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        attachCanvasPointerEvents(stack);</div><div class="line">        <span class="keyword">return</span> stack;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// main draw method</span></div><div class="line">    api.draw = <span class="function"><span class="keyword">function</span> (<span class="params">stack, key, layerIndex</span>) </span>&#123;</div><div class="line">        <span class="comment">// layer object</span></div><div class="line">        <span class="keyword">var</span> layerObj = stack[layerIndex];</div><div class="line">        <span class="comment">// CORE ARGUMENTS created from stack, and layerIndex arguments of canvasMod.draw</span></div><div class="line">        <span class="keyword">var</span> coreArgu = [stack, layerObj.ctx, layerObj.canvas, layerObj];</div><div class="line">        <span class="comment">// ADDITIONAL ARGUMNETS that will change depending on the draw method used with key argument of canvasMod.draw</span></div><div class="line">        <span class="keyword">var</span> addArgu = [];</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &gt; <span class="number">3</span>) &#123;</div><div class="line">            addArgu = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">3</span>, <span class="built_in">arguments</span>.length);</div><div class="line">        &#125;</div><div class="line">        FEATURES.drawMethods[key].apply(stack, coreArgu.concat(addArgu));</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create points</span></div><div class="line">    api.createPoints = <span class="function"><span class="keyword">function</span> (<span class="params">stack, key</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> coreArgu = [stack]; </div><div class="line">        <span class="keyword">var</span> addArgu = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">2</span>, <span class="built_in">arguments</span>.length);</div><div class="line">        <span class="keyword">var</span> points = pointsMethods[key].apply(stack, coreArgu.concat(addArgu));</div><div class="line">        <span class="keyword">return</span> points;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// load additional FEATURES</span></div><div class="line">    api.load = <span class="function"><span class="keyword">function</span>(<span class="params">plugObj</span>)</span>&#123;</div><div class="line">         <span class="built_in">Object</span>.keys(plugObj).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">featuresKey</span>)</span>&#123;</div><div class="line">             <span class="keyword">var</span> featureArray = plugObj[featuresKey];</div><div class="line">             featureArray.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)</span>&#123;</div><div class="line">                 FEATURES[featuresKey][feature.name] = feature.method;</div><div class="line">             &#125;)   </div><div class="line">         &#125;);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">    (<span class="keyword">this</span>[<span class="string">'canvasMod'</span>] = &#123;&#125;));</div></pre></td></tr></table></figure>
<h3 id="3-2-The-buttons-canvas-plug-in"><a href="#3-2-The-buttons-canvas-plug-in" class="headerlink" title="3.2 - The buttons canvas plug-in"></a>3.2 - The buttons canvas plug-in</h3><p>I made a buttons plug in for this canvas module when I started a buttons feature for this game framework. This canvas plug in will add two draw methods then, one of which will draw a single button object, the other will draw all buttons for the current state.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">canvasMod.load(&#123;</div><div class="line">    <span class="attr">drawMethods</span> : [</div><div class="line">        <span class="comment">// draw a button</span></div><div class="line">        &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'button'</span>,</div><div class="line">            <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params">stack, ctx, canvas, layerObj, button</span>)</span>&#123;</div><div class="line">                ctx.fillStyle = <span class="string">'white'</span>;</div><div class="line">                ctx.strokeStyle = <span class="string">'black'</span>;</div><div class="line">                ctx.beginPath();</div><div class="line">                ctx.rect(button.x, button.y, button.w, button.h);</div><div class="line">                ctx.fill();</div><div class="line">                ctx.stroke();</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// draw a button collection for the current state object</span></div><div class="line">        &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'stateButtons'</span>,</div><div class="line">            <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params">stack, ctx, canvas, layerObj, sm</span>)</span>&#123;</div><div class="line">                <span class="keyword">var</span> state = sm.states[sm.currentState];</div><div class="line">                <span class="built_in">Object</span>.keys(state.buttons).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">buttonKey</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> button = state.buttons[buttonKey];</div><div class="line">                    canvasMod.draw(stack, <span class="string">'button'</span>, layerObj.i, button);</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="3-3-The-mod-pool-canvas-plug-in"><a href="#3-3-The-mod-pool-canvas-plug-in" class="headerlink" title="3.3 - The mod-pool canvas plug-in"></a>3.3 - The mod-pool canvas plug-in</h3><p>When I added the object pool to the over all project I also wanted to add a basic draw method for a pool of objects. This is something that will need to be refined at least a little more even when it comes to having a bland general form of this kind if draw method. The module however can also serve as a starting point for making another kind of canvas plug in that I might have to make on a per project basis. For example say I am making a game where I want to display hp bars for display objects, and other info that has to do with the specific nature of a game, I will need to go beyond something simple like this then.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">canvasMod.load(&#123;</div><div class="line">    <span class="attr">drawMethods</span> : [</div><div class="line">        <span class="comment">// basic draw a pool method</span></div><div class="line">        &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'pool'</span>,</div><div class="line">            <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params">stack, ctx, canvas, layerObj, pool, opt</span>)</span>&#123;</div><div class="line">                opt = opt || &#123;&#125;</div><div class="line">                pool.objects.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">                    ctx.fillStyle = opt.fillStyle || obj.data.fillStyle || <span class="string">'white'</span>;</div><div class="line">                    ctx.strokeStyle = opt.strokeStyle || obj.data.strokeStyle || <span class="string">'black'</span>;</div><div class="line">                    <span class="keyword">if</span>(obj.active || opt.drawAll)&#123;</div><div class="line">                        ctx.beginPath();</div><div class="line">                        ctx.rect(obj.x, obj.y, obj.w, obj.h);</div><div class="line">                        ctx.fill();</div><div class="line">                        ctx.stroke();</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="3-4-The-points-circle-plug-in"><a href="#3-4-The-points-circle-plug-in" class="headerlink" title="3.4 - The points-circle plug-in"></a>3.4 - The points-circle plug-in</h3><p>This points circle plug in is yet another plug in that I added just for the hell of it. I may make some of these features built into the canvas module itself at some point maybe, but for now I have them as optional pug ins outside of the canvas module. This plug in will add just to points methods to the canvas module that are circle and oval points method. So then that is it just having some methods for creating a circle and oval in terms of a collection of points.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">canvasMod.load(&#123;</div><div class="line">    <span class="comment">// points methods to add</span></div><div class="line">    pointsMethods : [</div><div class="line">        <span class="comment">// a circle method</span></div><div class="line">        &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'circle'</span>,</div><div class="line">            <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params">stack, cx, cy, radius, pointCount</span>)</span>&#123;</div><div class="line">                pointCount = pointCount === <span class="literal">undefined</span> ? <span class="number">100</span> : pointCount;</div><div class="line">                <span class="keyword">return</span> canvasMod.createPoints(stack, <span class="string">'oval'</span>, cx, cy, radius, radius, pointCount);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// an oval method</span></div><div class="line">        &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'oval'</span>,</div><div class="line">            <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params">stack, cx, cy, radius1, radius2, pointCount</span>)</span>&#123;</div><div class="line">                pointCount = pointCount === <span class="literal">undefined</span> ? <span class="number">100</span> : pointCount;</div><div class="line">                <span class="keyword">var</span> points = [[]];</div><div class="line">                <span class="keyword">var</span> i = <span class="number">0</span>, x, y, radian;</div><div class="line">                <span class="keyword">while</span>(i &lt; pointCount)&#123;</div><div class="line">                    radian = <span class="built_in">Math</span>.PI * <span class="number">2</span> / pointCount * i;</div><div class="line">                    x = cx + <span class="built_in">Math</span>.cos(radian) * radius1;</div><div class="line">                    y = cy + <span class="built_in">Math</span>.sin(radian) * radius2;</div><div class="line">                    points[<span class="number">0</span>].push(x, y);</div><div class="line">                    i += <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> points;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="4-The-game-frame-lib"><a href="#4-The-game-frame-lib" class="headerlink" title="4 - The game frame lib"></a>4 - The game frame lib</h2><p>Now for the current state of the main game frame module that is what I will be using in demo files to create a main state machine object, and add state objects to it. In this module I have to create methods for creating state machine objects, one of which is to create the main state machine object, and the other is to create a more base object of a state machine object that is used for nested states when making a game module.</p>
<p>I then have a bunch of helper methods that are many used with the main create state machine public method. For example there is a helper that will create and add a state object to the main state object in the event that there is a loader option in the given options object. There are also helper methods that are used to check if a button has been click when it comes to the buttons collection feature of state objects.</p>
<p>The additional public methods thus far have to do with pushing additional state objects to a main state object, and setting what the current state is. The punch state object method is a way to make sure that empty properties of a state object are filled with something at least. The set state method should always be used to change states when and where needed to make sure that the end and start hooks of state objects will fire.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"><span class="comment">//  CREATE State Machine PUBLIC Methods and helpers</span></div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"> </div><div class="line">    <span class="comment">// create a minimal sm object ( For setting up a nested sm object, and the base of a main sm object )</span></div><div class="line">    api.smCreateMin = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="comment">// return a base sm object</span></div><div class="line">        <span class="keyword">var</span> sm = &#123;</div><div class="line">            <span class="attr">currentState</span>: opt.currentState || <span class="string">''</span>,</div><div class="line">            <span class="attr">states</span>: opt.states || &#123;&#125;,</div><div class="line">            <span class="attr">events</span>: opt.events || &#123;&#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">return</span> sm;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// helpers for main create method</span></div><div class="line">    <span class="keyword">var</span> callStateObjectPointerEvent = <span class="function"><span class="keyword">function</span>(<span class="params">pointerType, e, pos, sm</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> state = sm.states[sm.currentState],</div><div class="line">        handler;</div><div class="line">        <span class="keyword">if</span>(state)&#123;</div><div class="line">            handler = state.events[pointerType];</div><div class="line">            <span class="keyword">if</span>(handler)&#123;</div><div class="line">                handler.call(sm, e, pos, sm);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// check if a button was clicked for the current state, if so call the onClick method for it</span></div><div class="line">    <span class="keyword">var</span> buttonCheck = <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> state = sm.states[sm.currentState];</div><div class="line">        <span class="keyword">var</span> buttonKeys = <span class="built_in">Object</span>.keys(state.buttons);</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, len = buttonKeys.length, button;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            button = state.buttons[buttonKeys[i]];</div><div class="line">            <span class="keyword">if</span>(utils.boundingBox(button.x, button.y, button.w, button.h, pos.x, pos.y, <span class="number">1</span>, <span class="number">1</span>))&#123;</div><div class="line">                button.onClick.call(sm, e, pos, sm, button);</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> pushLoaderState = <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">        gameFrame.smPushState(sm, &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'loader'</span>,</div><div class="line">            <span class="attr">start</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">                canvasMod.draw(sm.layers, <span class="string">'background'</span>, <span class="number">0</span>);</div><div class="line">                <span class="comment">// set up images array</span></div><div class="line">                sm.images = [];</div><div class="line">                <span class="keyword">var</span> loaderObj = sm.loader;</div><div class="line">                <span class="comment">// if we have images to load start the requests for them</span></div><div class="line">                <span class="keyword">if</span>(sm.loader.images)&#123;</div><div class="line">                    <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">                    <span class="keyword">while</span>(i &lt; sm.loader.images.count)&#123;</div><div class="line">                        (<span class="function"><span class="keyword">function</span>(<span class="params">imageIndex</span>)</span>&#123;</div><div class="line">                           utils.httpPNG(&#123;</div><div class="line">                                <span class="attr">url</span>: sm.loader.images.baseURL + <span class="string">'/'</span> + imageIndex + <span class="string">'.png'</span>,</div><div class="line">                                <span class="comment">// set to sm images if all goes well</span></div><div class="line">                                onDone : <span class="function"><span class="keyword">function</span>(<span class="params">image, xhr</span>)</span>&#123;</div><div class="line">                                    sm.images[imageIndex] = image;</div><div class="line">                                &#125;,</div><div class="line">                                <span class="comment">// just a blank image for now if there is an error</span></div><div class="line">                                onError: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                                    sm.images[imageIndex] = <span class="keyword">new</span> Image();</div><div class="line">                                &#125;</div><div class="line">                            &#125;);</div><div class="line">                        &#125;(i));</div><div class="line">                        i += <span class="number">1</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, secs</span>)</span>&#123; </div><div class="line">                <span class="keyword">if</span>(sm.loader.images)&#123;</div><div class="line">                    <span class="comment">// start game state when all images are loaded</span></div><div class="line">                    <span class="keyword">if</span>(sm.images.length === sm.loader.images.count)&#123;</div><div class="line">                        gameFrame.smSetState(sm, <span class="string">'game'</span>);</div><div class="line">                    &#125;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="comment">// no images just progress to game state</span></div><div class="line">                    gameFrame.smSetState(sm, <span class="string">'game'</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, layers</span>)</span>&#123;</div><div class="line">                <span class="keyword">var</span> ctx = layers[<span class="number">1</span>].ctx,</div><div class="line">                canvas = layers[<span class="number">1</span>].canvas,</div><div class="line">                cx = canvas.width / <span class="number">2</span>,</div><div class="line">                cy = canvas.height / <span class="number">2</span>;</div><div class="line">                <span class="comment">// clear</span></div><div class="line">                canvasMod.draw(layers, <span class="string">'clear'</span>, <span class="number">1</span>);</div><div class="line">                <span class="comment">// if images</span></div><div class="line">                <span class="keyword">if</span>(sm.loader.images)&#123;</div><div class="line">                    ctx.fillStyle = <span class="string">'white'</span></div><div class="line">                    ctx.strokeStyle = <span class="string">'black'</span>;</div><div class="line">                    ctx.beginPath();</div><div class="line">                    ctx.rect(<span class="number">0</span>, cy - <span class="number">10</span>, canvas.width * (sm.images.length / sm.loader.images.count) , <span class="number">10</span>);</div><div class="line">                    ctx.fill();</div><div class="line">                    ctx.stroke();</div><div class="line">                    canvasMod.draw(layers, <span class="string">'print'</span>, <span class="number">1</span>, sm.images.length + <span class="string">' / '</span> + sm.loader.images.count, cx, cy + <span class="number">15</span>, &#123;</div><div class="line">                        <span class="attr">align</span>: <span class="string">'center'</span>,</div><div class="line">                        <span class="attr">fontSize</span>: <span class="number">30</span></div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create the main sm object</span></div><div class="line">    api.smCreateMain = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="comment">// create base sm object</span></div><div class="line">        <span class="keyword">var</span> sm = api.smCreateMin(opt);</div><div class="line">        <span class="comment">// values that can be set by options</span></div><div class="line">        sm.ver = opt.ver || <span class="string">''</span>;</div><div class="line">        sm.game = opt.game || &#123;&#125;;</div><div class="line">        sm.fps = sm.fps === <span class="literal">undefined</span> ? <span class="number">30</span> : opt.fps;</div><div class="line">        sm.loader = opt.loader || &#123;&#125;;</div><div class="line">        sm.images = [];</div><div class="line">        <span class="comment">// events</span></div><div class="line">        sm.events = opt.events || &#123;</div><div class="line">            <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;</div><div class="line">                buttonCheck(e, pos, sm);</div><div class="line">                callStateObjectPointerEvent(<span class="string">'pointerStart'</span>, e, pos, sm);   </div><div class="line">            &#125;,</div><div class="line">            <span class="attr">pointerMove</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;</div><div class="line">                callStateObjectPointerEvent(<span class="string">'pointerMove'</span>, e, pos, sm);</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">pointerEnd</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;</div><div class="line">                callStateObjectPointerEvent(<span class="string">'pointerEnd'</span>, e, pos, sm); </div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// set up stack of canvas layers using the canvas module</span></div><div class="line">        sm.layers = canvasMod.createLayerStack(&#123;</div><div class="line">            <span class="attr">length</span>: opt.canvasLayers === <span class="literal">undefined</span> ? <span class="number">3</span> : opt.canvasLayers,</div><div class="line">            <span class="attr">container</span>: opt.canvasContainer || <span class="built_in">document</span>.getElementById(<span class="string">'canvas-app'</span>) || <span class="built_in">document</span>.body,</div><div class="line">            <span class="attr">events</span>: sm.events,</div><div class="line">            <span class="attr">state</span>: sm,</div><div class="line">            <span class="attr">width</span>: opt.width,</div><div class="line">            <span class="attr">height</span>: opt.height</div><div class="line">        &#125;);</div><div class="line">        sm.debugMode = opt.debugMode || <span class="literal">false</span>;</div><div class="line">        <span class="comment">// value that should not be set by options</span></div><div class="line">        sm.secs = <span class="number">0</span>;</div><div class="line">        sm.stopLoop = <span class="literal">false</span>;</div><div class="line">        sm.lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">        <span class="comment">// if sm.loader.images push built in loader state</span></div><div class="line">        <span class="keyword">if</span>(sm.loader.images)&#123;</div><div class="line">            pushLoaderState(sm);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// main loop</span></div><div class="line">        sm.loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">            sm.secs = (now - sm.lt) / <span class="number">1000</span>,</div><div class="line">            state = sm.states[sm.currentState] || &#123;&#125;;</div><div class="line">            <span class="keyword">if</span> (sm.secs &gt;= <span class="number">1</span> / sm.fps) &#123;</div><div class="line">                <span class="comment">// update</span></div><div class="line">                <span class="keyword">var</span> update = state.update;</div><div class="line">                <span class="keyword">if</span>(update)&#123;</div><div class="line">                    update.call(sm, sm, sm.secs);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// draw</span></div><div class="line">                <span class="keyword">var</span> drawMethod = state.draw;</div><div class="line">                <span class="keyword">if</span>(drawMethod)&#123;</div><div class="line">                    drawMethod.call(sm, sm, sm.layers);</div><div class="line">                &#125;                </div><div class="line">                sm.lt = now;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// if sm.stopLoop === false, then keep looping</span></div><div class="line">            <span class="keyword">if</span>(!sm.stopLoop)&#123;</div><div class="line">                requestAnimationFrame(sm.loop);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// stop loop on any page error</span></div><div class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span>(sm.debugMode)&#123;</div><div class="line">                sm.stopLoop = <span class="literal">true</span>;</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'error: '</span> + e.message);</div><div class="line">                <span class="built_in">console</span>.log(e);</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'loop stoped'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">return</span> sm;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"><span class="comment">//  PUSH NEW STATE OBJECTS</span></div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"> </div><div class="line">    <span class="comment">// push a new state object</span></div><div class="line">    api.smPushState = <span class="function"><span class="keyword">function</span>(<span class="params">sm, opt</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> state = &#123;</div><div class="line">            <span class="attr">name</span>: opt.name || <span class="string">'state_'</span> + <span class="built_in">Object</span>.keys(sm.states).length</div><div class="line">        &#125;;</div><div class="line">        state.buttons = opt.buttons || &#123;&#125;;</div><div class="line">        state.start = opt.start || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        state.end = opt.end || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        state.update = opt.update || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        state.draw = opt.draw || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        state.events = opt.events || &#123;&#125;;</div><div class="line">        sm.states[state.name] = state;</div><div class="line">        <span class="keyword">return</span> state;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"><span class="comment">//  SET THE CURRENT STATE</span></div><div class="line"><span class="comment">/********* ********** ********** ********** *********/</span></div><div class="line"> </div><div class="line">    <span class="comment">// set the current state</span></div><div class="line">    api.smSetState = <span class="function"><span class="keyword">function</span>(<span class="params">sm, newState</span>)</span>&#123;</div><div class="line">        <span class="comment">// get a ref to the old state</span></div><div class="line">        <span class="keyword">var</span> oldState = sm.states[sm.currentState];</div><div class="line">        <span class="comment">// call the on end hook for the old state if it has one</span></div><div class="line">        <span class="keyword">if</span>(oldState)&#123;</div><div class="line">            <span class="keyword">var</span> endHook = oldState.end;</div><div class="line">            <span class="keyword">if</span>(endHook)&#123;</div><div class="line">                endHook.call(sm, sm);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// change to the new state, and call the start hook it it has one</span></div><div class="line">        sm.currentState = newState;</div><div class="line">        <span class="keyword">var</span> newState = sm.states[sm.currentState];</div><div class="line">        <span class="keyword">var</span> startHook = newState.start;</div><div class="line">        <span class="keyword">if</span>(startHook)&#123;</div><div class="line">            startHook.call(sm, sm);</div><div class="line">        &#125;</div><div class="line">    &#125;;  </div><div class="line">&#125;</div><div class="line">    (<span class="keyword">this</span>[<span class="string">'gameFrame'</span>] = &#123;&#125;));</div></pre></td></tr></table></figure>
<h2 id="5-Demos-thus-far"><a href="#5-Demos-thus-far" class="headerlink" title="5 - Demos thus far"></a>5 - Demos thus far</h2><p>So then Now that I have my game framework together I will want to make at least a few quick demos of this framework to make sure that it is working just the way that I would like to to with the features that I have added thus far.</p>
<h3 id="5-1-Basic-hello-world-demo"><a href="#5-1-Basic-hello-world-demo" class="headerlink" title="5.1 - Basic hello world demo"></a>5.1 - Basic hello world demo</h3><p>So the the first demo that I put together is just the usual hello world type demo where the goal is to just print hello world on the screen. However for this demo I wanted to also test out a few of the other features of this game framework other than the print draw method that I have built into the canvas framework.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create an sm object</span></div><div class="line"><span class="keyword">var</span> sm = gameFrame.smCreateMain(&#123;</div><div class="line">    <span class="attr">currentState</span>: <span class="string">'game'</span>, <span class="comment">// set starting state object to use</span></div><div class="line">    width: <span class="number">640</span>,</div><div class="line">    <span class="attr">height</span>: <span class="number">480</span>,</div><div class="line">    <span class="attr">game</span>: &#123;</div><div class="line">        <span class="attr">text</span>: <span class="string">'Hello World'</span>,</div><div class="line">        <span class="attr">pool</span>: poolMod.create(&#123;</div><div class="line">            <span class="attr">count</span>: <span class="number">8</span>,</div><div class="line">            <span class="attr">secsCap</span>: <span class="number">0.25</span>,</div><div class="line">            <span class="attr">disableLifespan</span>: <span class="literal">true</span>,</div><div class="line">            <span class="attr">spawn</span>: <span class="function"><span class="keyword">function</span>(<span class="params">obj, pool</span>)</span>&#123;</div><div class="line">                obj.data.homeRadian = <span class="built_in">Math</span>.PI * <span class="number">2</span> / pool.objects.length * obj.i;</div><div class="line">                obj.data.deltaRadian = <span class="number">0</span>;</div><div class="line">                obj.data.radian = obj.data.homeRadian;</div><div class="line">                obj.data.radius = <span class="number">200</span>;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">update</span>: <span class="function"><span class="keyword">function</span> (<span class="params">obj, pool, sm, secs</span>)</span>&#123;</div><div class="line">               obj.data.deltaRadian = <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">45</span> * secs;</div><div class="line">               obj.data.radian += obj.data.deltaRadian;</div><div class="line">               obj.data.radian = utils.mod(obj.data.radian, <span class="built_in">Math</span>.PI * <span class="number">2</span>);  </div><div class="line">               obj.lifespan = <span class="number">1</span>;</div><div class="line">               obj.x = <span class="number">320</span> - obj.w / <span class="number">2</span> + <span class="built_in">Math</span>.cos(obj.data.radian) * obj.data.radius;</div><div class="line">               obj.y = <span class="number">240</span> - obj.h / <span class="number">2</span> + <span class="built_in">Math</span>.sin(obj.data.radian) * obj.data.radius;</div><div class="line">            &#125;</div><div class="line">        &#125;),</div><div class="line">        <span class="attr">cx</span>: <span class="number">320</span>,</div><div class="line">        <span class="attr">cy</span>: <span class="number">240</span>,</div><div class="line">        <span class="attr">x</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">y</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">dir</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">dx</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">printOptions</span>: &#123;</div><div class="line">            <span class="attr">align</span>: <span class="string">'center'</span>,</div><div class="line">            <span class="attr">baseLine</span>: <span class="string">'middle'</span>,</div><div class="line">            <span class="attr">fontSize</span>: <span class="number">40</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">pointerDown</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line"><span class="comment">// add at least one state object</span></div><div class="line">gameFrame.smPushState(sm, &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'game'</span>,</div><div class="line">    <span class="comment">// start hook will just fire once when the state object starts</span></div><div class="line">    start: <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">        <span class="comment">// draw background once</span></div><div class="line">        canvasMod.draw(sm.layers, <span class="string">'background'</span>, <span class="number">0</span>);</div><div class="line">        <span class="comment">// spawn</span></div><div class="line">        poolMod.spawnAll(sm.game.pool, sm, &#123;&#125;);</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// what to do on each update</span></div><div class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params">sm, secs</span>)</span>&#123;</div><div class="line">        sm.game.dx += <span class="number">64</span> * secs * sm.game.dir;</div><div class="line">        <span class="keyword">if</span>(sm.game.dx &gt;= <span class="number">32</span>)&#123;</div><div class="line">            sm.game.dx = <span class="number">32</span>;</div><div class="line">            sm.game.dir = <span class="number">-1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(sm.game.dx &lt;= <span class="number">-32</span>)&#123;</div><div class="line">            sm.game.dx = <span class="number">-32</span>;</div><div class="line">            sm.game.dir = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        sm.game.x = sm.game.cx + sm.game.dx;</div><div class="line">        sm.game.y = sm.game.cy;</div><div class="line">        <span class="comment">// update game.pool</span></div><div class="line">        poolMod.update(sm.game.pool, secs, sm);</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// draw will be called after each update</span></div><div class="line">    draw: <span class="function"><span class="keyword">function</span>(<span class="params">sm, layers</span>)</span>&#123;</div><div class="line">        canvasMod.draw(layers, <span class="string">'clear'</span>, <span class="number">1</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'pool'</span>, <span class="number">1</span>, sm.game.pool);</div><div class="line">        canvasMod.draw(layers, <span class="string">'print'</span>, <span class="number">1</span>, sm.game.text, sm.game.x, sm.game.y, sm.game.printOptions);</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// events for this state</span></div><div class="line">    events: &#123;</div><div class="line">        <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;</div><div class="line">            sm.game.pointerDown = <span class="literal">true</span>;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">pointerMove</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(sm.game.pointerDown)&#123;</div><div class="line">                sm.game.cx = pos.x;</div><div class="line">                sm.game.cy = pos.y;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">pointerEnd</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;</div><div class="line">            sm.game.pointerDown = <span class="literal">false</span>;</div><div class="line">            sm.game.cx = <span class="number">320</span>;</div><div class="line">            sm.game.cy = <span class="number">240</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// start the state machine</span></div><div class="line">gameFrame.smSetState(sm, <span class="string">'game'</span>);</div><div class="line">sm.loop();</div></pre></td></tr></table></figure>
<h3 id="5-1-Demo-of-Menus"><a href="#5-1-Demo-of-Menus" class="headerlink" title="5.1 - Demo of Menus"></a>5.1 - Demo of Menus</h3><p>When I added buttons as a feature of the game framework I wanted to set start a demo to make sure that they are working the way that they should be. There is a bit more that I might want to add when it comes to this feature at some point but for now this is the basic demo of the buttons feature.</p>
<p>the basic idea of buttons is to just have the option of having a collection of button objects when creating a state object. When I create a button object I have the option to add an on click method that will be the logic that is to fire when one of these buttons are click by the user with the mouse or a touch screen. For now in this example i am just using these buttons to change the current state object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create an sm object</span></div><div class="line"><span class="keyword">var</span> sm = gameFrame.smCreateMain(&#123;</div><div class="line">    <span class="attr">currentState</span>: <span class="string">'mainMenu'</span>, </div><div class="line">    <span class="attr">width</span>: <span class="number">640</span>,</div><div class="line">    <span class="attr">height</span>: <span class="number">480</span>,</div><div class="line">    <span class="attr">game</span>: &#123;&#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line"><span class="comment">// a main menu state</span></div><div class="line">gameFrame.smPushState(sm, &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'mainMenu'</span>,</div><div class="line">    <span class="attr">buttons</span>: &#123;</div><div class="line">        <span class="attr">newGame</span>: &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">100</span>, <span class="attr">w</span>: <span class="number">64</span>, <span class="attr">h</span>:<span class="number">64</span>, <span class="attr">disp</span>: <span class="string">'New Game'</span>, <span class="attr">onClick</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm, button</span>)</span>&#123;</div><div class="line">            gameFrame.smSetState(sm, <span class="string">'game'</span>);</div><div class="line">        &#125;&#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">start</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">        canvasMod.draw(sm.layers, <span class="string">'background'</span>, <span class="number">0</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, layers</span>)</span>&#123;</div><div class="line">        canvasMod.draw(layers, <span class="string">'clear'</span>, <span class="number">1</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'print'</span>, <span class="number">1</span>, sm.currentState, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'stateButtons'</span>, <span class="number">1</span>, sm);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// a game state</span></div><div class="line">gameFrame.smPushState(sm, &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'game'</span>,</div><div class="line">    <span class="attr">buttons</span>: &#123;</div><div class="line">        <span class="attr">back</span>: &#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">100</span>, <span class="attr">w</span>: <span class="number">64</span>, <span class="attr">h</span>:<span class="number">64</span>, <span class="attr">disp</span>: <span class="string">'New Game'</span>, <span class="attr">onClick</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm, button</span>)</span>&#123;</div><div class="line">            gameFrame.smSetState(sm, <span class="string">'mainMenu'</span>);</div><div class="line">        &#125;&#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">start</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">        canvasMod.draw(sm.layers, <span class="string">'background'</span>, <span class="number">0</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, secs</span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;,</div><div class="line">    <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, layers</span>)</span>&#123;</div><div class="line">        canvasMod.draw(layers, <span class="string">'clear'</span>, <span class="number">1</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'print'</span>, <span class="number">1</span>, sm.currentState, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'stateButtons'</span>, <span class="number">1</span>, sm);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">events</span>: &#123;</div><div class="line">        <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;,</div><div class="line">        <span class="attr">pointerMove</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;,</div><div class="line">        <span class="attr">pointerEnd</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// start the state machine</span></div><div class="line">gameFrame.smSetState(sm, <span class="string">'mainMenu'</span>);</div><div class="line">sm.loop();</div></pre></td></tr></table></figure>
<h3 id="5-1-Demo-of-the-loader"><a href="#5-1-Demo-of-the-loader" class="headerlink" title="5.1 - Demo of the loader"></a>5.1 - Demo of the loader</h3><p>I am going to want to start making games that make use of external image assets so I will want to have a assets loader in the game framework. As of this writing there is such an assets loader in the framework, and in order to use it I just need to add a loader object to the options object that I pass to the create main state machine object method of the game frame work.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create an sm object</span></div><div class="line"><span class="keyword">var</span> sm = gameFrame.smCreateMain(&#123;</div><div class="line">    <span class="attr">currentState</span>: <span class="string">'loader'</span>, </div><div class="line">    <span class="attr">width</span>: <span class="number">640</span>,</div><div class="line">    <span class="attr">height</span>: <span class="number">480</span>,</div><div class="line">    <span class="attr">game</span>: &#123;&#125;,</div><div class="line">    <span class="attr">loader</span>: &#123;</div><div class="line">        <span class="attr">images</span>: &#123; <span class="comment">// load 0.png, and 1.png at ./img</span></div><div class="line">            baseURL: <span class="string">'./img'</span>,</div><div class="line">            <span class="attr">count</span>: <span class="number">2</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line"><span class="comment">// a game state</span></div><div class="line">gameFrame.smPushState(sm, &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'game'</span>,</div><div class="line">    <span class="attr">buttons</span>: &#123;</div><div class="line">        <span class="comment">//back: &#123; x: 100, y: 100, w: 64, h:64, disp: 'New Game', onClick: function(e, pos, sm, button)&#123;      </span></div><div class="line">        <span class="comment">//&#125;&#125;</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">start</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">        canvasMod.draw(sm.layers, <span class="string">'background'</span>, <span class="number">0</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, secs</span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;,</div><div class="line">    <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span>(<span class="params">sm, layers</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> canvas = layers[<span class="number">1</span>].canvas,</div><div class="line">        ctx = layers[<span class="number">1</span>].ctx;</div><div class="line">        canvasMod.draw(layers, <span class="string">'clear'</span>, <span class="number">1</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'print'</span>, <span class="number">1</span>, sm.currentState, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">        canvasMod.draw(layers, <span class="string">'stateButtons'</span>, <span class="number">1</span>, sm);</div><div class="line">        <span class="comment">// drawing images to the canvas</span></div><div class="line">        ctx.drawImage(sm.images[<span class="number">0</span>], <span class="number">29.5</span>, <span class="number">29.5</span>);</div><div class="line">        ctx.drawImage(sm.images[<span class="number">1</span>], <span class="number">100.5</span>, <span class="number">29.5</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">events</span>: &#123;</div><div class="line">        <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;,</div><div class="line">        <span class="attr">pointerMove</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;,</div><div class="line">        <span class="attr">pointerEnd</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e, pos, sm</span>)</span>&#123;&#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// start the state machine</span></div><div class="line">gameFrame.smSetState(sm, <span class="string">'loader'</span>);</div><div class="line">sm.loop();</div></pre></td></tr></table></figure>
<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6 - Conclusion"></a>6 - Conclusion</h2><p>So far this framework seems to be working okay, at least when it comes to the silly demos that I have made for it thus far. There may be a few more features and changes that I will want to make for this thing of course, however I do not want to go to nuts with this thing just yet. The core set of features that I would want to have in a game framework are there such as a state machine, basic canvas, and object pool modules. In order to really know what should be added on top of what I have all ready I am going to want to make more demos, and actual projects. However for the most part I am thing that what I will want to do is just further refine the features that are all ready in place.</p>
<p>I would like to keep this framework fairly minimal when it comes to features, but there is the idea of created a whole new framework only not from the ground up, as I would start with this source code thus far. There are features like a grid module, and various kinds of draw methods, and points methods that I might not want to add to a basic framework like this. However when it comes to making a certain set of games, with certain common features there is making a framework with things like that baked into the framework that is a kind of extinction of what I have work out here.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/" data-id="cl66sczd9010ohsv19qqz2w9t" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/09/10/nodejs-simple-http-request-get-post-system/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          A Simple nodejs example of a server that responds to post requests
        
      </div>
    </a>
  
  
    <a href="/2021/08/27/js-javascript-example-canvas-module/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Canvas Module JavaScript example</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/index.html';
    this.page.identifier = '927';
    this.page.title = 'A game framework JavaScript example';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.5px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.5px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.5px;">angular</a> <a href="/tags/animation/" style="font-size: 12px;">animation</a> <a href="/tags/automation/" style="font-size: 12px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.5px;">backbone</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.5px;">canvas</a> <a href="/tags/corejs/" style="font-size: 13px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 11px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.5px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.5px;">express</a> <a href="/tags/games/" style="font-size: 17px;">games</a> <a href="/tags/git/" style="font-size: 13px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 12px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.5px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.5px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.5px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.5px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.5px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.5px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.5px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.5px;">python</a> <a href="/tags/statistics/" style="font-size: 14px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/07/29/threejs-examples-aplerp/">An advanced Lerping module threejs example</a>
          </li>
        
          <li>
            <a href="/2022/07/22/threejs-capsule-geometry/">Capsule geometry in threejs</a>
          </li>
        
          <li>
            <a href="/2022/07/15/threejs-examples-object-grid-wrap-land/">THREEJS Looping land animation using the Object grid wrap module</a>
          </li>
        
          <li>
            <a href="/2022/07/08/threejs-examples-weird-face-one/">Weird face one threejs example</a>
          </li>
        
          <li>
            <a href="/2022/07/01/threejs-examples-lerp-geo/">Lerping the points of a geometry from one to another</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS-Examples</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas-Examples</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2021/09/03/js-javascript-example-game-framework/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>