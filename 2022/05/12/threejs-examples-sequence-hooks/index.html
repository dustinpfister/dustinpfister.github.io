<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>threejs example using a sequence module with hooks | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="When it comes to starting to make some kind of actual product with threejs rather than just simple code examples for the sake of blog posts, I have started going in the direction of making videos. Thu">
<meta property="og:type" content="article">
<meta property="og:title" content="threejs example using a sequence module with hooks">
<meta property="og:url" content="https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="When it comes to starting to make some kind of actual product with threejs rather than just simple code examples for the sake of blog posts, I have started going in the direction of making videos. Thu">
<meta property="og:updated_time" content="2022-10-28T17:07:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="threejs example using a sequence module with hooks">
<meta name="twitter:description" content="When it comes to starting to make some kind of actual product with threejs rather than just simple code examples for the sake of blog posts, I have started going in the direction of making videos. Thu">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image, as well as the link to my youtube -->
        <a href="https://www.youtube.com/user/javaweaver"><div class="selfimage"></div></a>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas</a>
        
          <a class="main-nav-link" href="https://www.youtube.com/user/javaweaver">Youtube</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-threejs-examples-sequence-hooks" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/05/12/threejs-examples-sequence-hooks/" class="article-date"> Published:
  <time datetime="2022-05-12T17:44:00.000Z" itemprop="datePublished">2022-05-12</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2022/05/12/threejs-examples-sequence-hooks/" class="article-date"> Modified:
  <time datetime="2022-10-28T17:07:41.000Z" itemprop="dateModified">2022-10-28</time>
</a>

    <span class="article-date">V1.22</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/three-js/">three.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      threejs example using a sequence module with hooks
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>When it comes to starting to make some kind of actual product with <a href="https://threejs.org/docs/#manual/en/introduction/Creating-a-scene" target="_blank" rel="external">threejs</a> rather than just simple code examples for the sake of blog posts, I have started going in the direction of making videos. Thus far I have made a whole bunch of You tube videos for my various blog posts on threejs that I have wrote thus far, and still have a lot more to make if I am going to keep up with that. Anyway when it comes to making videos with a little javaScript code I have found that I like to break things down into what I have code to call sequences. So for this <a href="/2021/02/19/threejs-examples/">threejs project examples</a> post I will be going over the source code of a new sequences module that I have made.</p>
<p>These sequences are just a way of having not just one update method, but an array of update methods with a current index for an update method that will be set based on a percent value that is based off of a current frame index value relative to that of a max frame value. This is something that I have all ready done with a sequence module that I have all ready made for my various video projects, one collection of which has to do with making video embeds for these blog posts. Anyway after using the module that I have made before for a while now I have found that there are a number of additional features that I should add, one of which is to not just have a collection of objects with an update method, but also before and after hook methods that will always fire before and after the calling of the current update method. This way I can use the before hook to set values that are a kind of default value for the sequence object, rather than repeating lines of code for each update method.</p>
<p>While I was making this module I also thought of a whole bunch of other features that are features that I really should have in this kind of module and managed to sneak them into the module also. This allows for me to set what the percent values should be for each update method by means of seconds values for each object, which I have come to find is a must have feature compared to doing the math manually for that. Also although I have made it so that using seconds values is the default when using the create method of the module, this feature can be disabled in the event that I just want to set percent values for each object like that of what I have been dong thus far.</p>
<a id="more"></a>
<iframe class="youtube_video" src="https://www.youtube.com/embed/3IlQ4zDaNz8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<h2 id="This-video-sequences-module-and-what-to-know-first"><a href="#This-video-sequences-module-and-what-to-know-first" class="headerlink" title="This video sequences module and what to know first"></a>This video sequences module and what to know first</h2><p>This is a post on the source code of a javaScript module, and a little additional demo code that I aim to use to make threejs powered videos for my various blog posts here, as well as other video projects that I might start or continue to work in in the future. It should go without saying but I will make it clear here, this is an advanced post on the <a href="/2018/04/04/threejs-getting-started/">subject of threejs</a> and client side <a href="/2018/11/27/js-getting-started/">web programming using javaScript</a>, so I am taking some liberties and assuming that you have at least a little background with these topics.</p>
<h3 id="Know-at-least-the-basics-of-a-the-request-animation-frame-method-or-the-threejs-clock-object"><a href="#Know-at-least-the-basics-of-a-the-request-animation-frame-method-or-the-threejs-clock-object" class="headerlink" title="Know at least the basics of a the request animation frame method or the threejs clock object"></a>Know at least the basics of a the request animation frame method or the threejs clock object</h3><p>In client side javaScript there is the <a href="/2018/03/13/js-request-animation-frame/">request animation frame method</a> that is often what is used to set up a basic animation loop. There are a few other options for this sort of thing such as set time out, but when it comes to rendering rather than updating a model it is mostly just the request animation frame method that is used. I often just use this method, but there is also a <a href="/2021/05/28/threejs-clock/">threejs built in clock feature</a> for this sot of thing as well.</p>
<h3 id="Version-numbers-matter"><a href="#Version-numbers-matter" class="headerlink" title="Version numbers matter"></a>Version numbers matter</h3><p>I was using r135 of threejs when I first wrote this post, and the last time I came around to doing some editing for r1 of the module I was using r140. On my end everything was working fine with these versions of threejs.</p>
<h3 id="source-code-is-up-on-github"><a href="#source-code-is-up-on-github" class="headerlink" title="source code is up on github"></a>source code is up on github</h3><p>The source code examples I am writing about here can also be found in my <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/forpost/threejs-examples-sequence-hooks" target="_blank" rel="external">test threejs repo</a> On Github. This is a pretty major module that I use regularly when making my various demo videos for these blog posts including this one. I have two versions of this module thus far, both of which I am writing about here in this post, however I might all ready have later revisions in the works at the repo, and it might be a long time until I come around to doing some more editing here.</p>
<h2 id="0-First-version-r0-of-this-video-sequences-hooks-module"><a href="#0-First-version-r0-of-this-video-sequences-hooks-module" class="headerlink" title="0 - First version ( r0 ) of this video sequences hooks module"></a>0 - First version ( r0 ) of this video sequences hooks module</h2><p>In this section I will be going over the first revision of this sequence hooks module, which might also be the only revision if I never have a need to improve this or fix any bugs. Anyway in this section I will be going over two files then, one of which is the sequence hooks javaScript file itself, and the other is just a demo of this module that tests out the features of this module.</p>
<p>Here I have the source code of the module itself for the state of the first revision of it. When it comes to this there are a few public methods but for the most part there are just the create and set frame methods that I will just be using for most if not all projects. In a video project I will be using the create method to create a standard sequence object, and then that object is what I will be passing to the set frame method that will in turn call the before objects hook method first, then one of the update methods for the current object in the objects array, and then of course the after objects hook.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// seq-hooks-r0.js</span></div><div class="line"><span class="comment">// sequence hooks library from threejs-examples-sequence-hooks</span></div><div class="line"><span class="keyword">var</span> seqHooks = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="keyword">var</span> getPer = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> a / b;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> getBias = <span class="function"><span class="keyword">function</span>(<span class="params">per</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> - <span class="built_in">Math</span>.abs( <span class="number">0.5</span> - per ) / <span class="number">0.5</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// update the given seq object by way of a frame, and maxFrame value</span></div><div class="line">    api.setFrame = <span class="function"><span class="keyword">function</span>(<span class="params">seq, frame, frameMax</span>)</span>&#123;</div><div class="line">        seq.frame = frame === <span class="literal">undefined</span> ? <span class="number">0</span> : frame;</div><div class="line">        seq.frameMax = frameMax === <span class="literal">undefined</span> ? <span class="number">100</span> : frameMax;</div><div class="line">        <span class="comment">// set main per and bias values</span></div><div class="line">        seq.per = getPer(seq.frame, seq.frameMax);</div><div class="line">        seq.bias = getBias(seq.per);</div><div class="line">        <span class="comment">// update object index</span></div><div class="line">        seq.objectIndex = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">var</span> obj = seq.objects[i];</div><div class="line">            <span class="keyword">var</span> per2 = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(seq.objects[i + <span class="number">1</span>] != <span class="literal">undefined</span>)&#123;</div><div class="line">                per2 = seq.objects[i + <span class="number">1</span>].per;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// if this is the current object update object </span></div><div class="line">            <span class="comment">// index as well as other relevant values</span></div><div class="line">            <span class="keyword">if</span>(seq.per &gt;= obj.per &amp;&amp; seq.per &lt; per2)&#123;</div><div class="line">                seq.objectIndex = i;</div><div class="line">                seq.partFrameMax = <span class="built_in">Math</span>.floor( (per2 - obj.per) * seq.frameMax );</div><div class="line">                seq.partFrame = seq.frame - <span class="built_in">Math</span>.floor(seq.frameMax * obj.per);</div><div class="line">                seq.partPer = getPer(seq.partFrame, seq.partFrameMax);</div><div class="line">                seq.partBias = getBias(seq.partPer);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// call before hook</span></div><div class="line">        seq.beforeObjects(seq);</div><div class="line">        <span class="comment">// call update for current object</span></div><div class="line">        <span class="keyword">var</span> obj = seq.objects[seq.objectIndex];</div><div class="line">        <span class="keyword">if</span>(obj)&#123;</div><div class="line">            seq.obj = obj;</div><div class="line">            obj.update(seq, seq.partPer, seq.partBias, obj);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// call after objects hook</span></div><div class="line">        seq.afterObjects(seq);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get total secs value helper</span></div><div class="line">    <span class="keyword">var</span> getTotalSecs = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> seq.objects.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc, obj</span>)</span>&#123; <span class="keyword">return</span> acc + (obj.secs || <span class="number">0</span>) &#125;, <span class="number">0</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// just get an array of per values based on sec values for each object, and DO NOT MUTATE the seq object</span></div><div class="line">    api.getPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">var</span> perValues = [];</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">var</span> per = perValues[i - <span class="number">1</span>];</div><div class="line">            <span class="keyword">if</span>( per === <span class="literal">undefined</span> )&#123;</div><div class="line">                perValues.push(<span class="number">0</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">var</span> perDelta = seq.objects[i - <span class="number">1</span>].secs / secsTotal;</div><div class="line">                perValues.push( <span class="built_in">parseFloat</span>( ( per + perDelta ).toFixed(<span class="number">4</span>) ) );         </div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> perValues;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a target frames value</span></div><div class="line">    api.getTargetFrames = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        fps = fps === <span class="literal">undefined</span> ? <span class="number">30</span> : fps;</div><div class="line">        <span class="keyword">var</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.ceil(secsTotal * fps);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// set per values</span></div><div class="line">    api.setPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        <span class="comment">// set seq.totalSecs</span></div><div class="line">        seq.totalSecs = getTotalSecs(seq);</div><div class="line">        <span class="comment">// set per values</span></div><div class="line">        api.getPerValues(seq).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">per, i</span>)</span>&#123;</div><div class="line">            seq.objects[i].per = per;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set frameMax</span></div><div class="line">        seq.frameMax = api.getTargetFrames(seq, fps);</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create new seq object method</span></div><div class="line">    <span class="keyword">var</span> noop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">    api.create = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.setPerValues = opt.setPerValues === <span class="literal">undefined</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div><div class="line">        <span class="keyword">var</span> seq = &#123;&#125;;</div><div class="line">        seq.objectIndex = <span class="number">0</span>;</div><div class="line">        seq.per = <span class="number">0</span>;</div><div class="line">        seq.bias = <span class="number">0</span>;</div><div class="line">        seq.frame = <span class="number">0</span>;</div><div class="line">        seq.frameMax = <span class="number">100</span>;</div><div class="line">        <span class="comment">// parse hooks</span></div><div class="line">        seq.beforeObjects = opt.beforeObjects || noop;</div><div class="line">        seq.afterObjects = opt.afterObjects || noop;</div><div class="line">        <span class="comment">// parse objects</span></div><div class="line">        seq.objects = opt.objects || [];</div><div class="line">        seq.objects = seq.objects.map(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">            obj.per = obj.per === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.per;</div><div class="line">            obj.secs = obj.secs === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.secs;</div><div class="line">            obj.data = obj.data || &#123;&#125;;</div><div class="line">            obj.update = obj.update || noop;</div><div class="line">            <span class="keyword">return</span> obj;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set per values is part of the create process</span></div><div class="line">        <span class="keyword">if</span>(opt.setPerValues)&#123;</div><div class="line">            api.setPerValues(seq, opt.fps === <span class="literal">undefined</span> ? <span class="number">30</span>: opt.fps);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// return public api</span></div><div class="line">    <span class="keyword">return</span> api;</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="0-1-Basic-hello-world-type-example"><a href="#0-1-Basic-hello-world-type-example" class="headerlink" title="0.1 - Basic hello world type example"></a>0.1 - Basic hello world type example</h3><p>For this basic demo of the sequence hooks module I will be using the before objects hook to define some default values for a camera, as well as setting the rotation of a mesh over the whole duration of the video. I am then using the after objects hook to make sure that I am always calling the update projection matrix method of the camera after setting values for the camera in the before objects hook as well as the current update method in the objects array of the sequence object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>));</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">40</span>, <span class="number">640</span> / <span class="number">480</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>);</div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="keyword">var</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">var</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="comment">// before current object hook</span></div><div class="line">        beforeObjects: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">             <span class="comment">// default value for camera</span></div><div class="line">             camera.fov = <span class="number">60</span>;</div><div class="line">             camera.aspect = <span class="number">640</span> / <span class="number">480</span>;</div><div class="line">             camera.position.set(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">             camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">             <span class="comment">// always rotate mesh object</span></div><div class="line">             mesh1.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">2</span> * seq.per;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// after current object hook</span></div><div class="line">        afterObjects: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">             <span class="comment">// always update the projection matrix so that any values</span></div><div class="line">             <span class="comment">// like fov or aspect take effect from before hook, and </span></div><div class="line">             <span class="comment">// current update method in seq.objects</span></div><div class="line">             camera.updateProjectionMatrix();</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// the objects for eac sequence</span></div><div class="line">        objects: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.fov = <span class="number">10</span> + <span class="number">50</span> * partPer;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                     <span class="keyword">var</span> w = <span class="number">640</span> - <span class="number">320</span> * partPer;</div><div class="line">                     <span class="keyword">var</span> h = <span class="number">480</span> + <span class="number">240</span> * partPer;</div><div class="line">                     camera.aspect = w / h;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">var</span> secs = <span class="number">0</span>,</div><div class="line">    fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="0-2-Part-Frame-example"><a href="#0-2-Part-Frame-example" class="headerlink" title="0.2 - Part Frame example"></a>0.2 - Part Frame example</h3><p>One thing that I have found to be a problem with r0 of the sequence hooks module has to do with the expressions that I am using to set the values of the part frame and part frame max properties of the sequence object. In some cases this can result in part percent values that are over that of 1 which I would consider not valid and results in weird rendering issues in some videos. This is then the first major bug that I would like to fix in r1, along with adding other feature that I think I should have in this now that I have used it for a long time when making <a href="https://www.youtube.com/user/javaweaver" target="_blank" rel="external">videos for the javaweaver channel on youtube</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>))</div><div class="line">    <span class="keyword">var</span> width = <span class="number">640</span>, height = <span class="number">480</span>,</div><div class="line">    fieldOfView = <span class="number">40</span>, aspectRatio = width / height,</div><div class="line">    near = <span class="number">0.1</span>, far = <span class="number">1000</span>,</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(fieldOfView, aspectRatio, near, far);</div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(width, height);</div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="keyword">var</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">var</span> mesh2 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">30</span>, <span class="number">30</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh2);</div><div class="line">    </div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">var</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            mesh2.position.set(<span class="number">4</span> - <span class="number">8</span> * seq.bias, <span class="number">0</span>, <span class="number">1</span>);</div><div class="line">            <span class="comment">//!!! I get werid partper values in r0 THOUGH</span></div><div class="line">            <span class="keyword">if</span>(seq.partPer &gt;= <span class="number">1</span>)&#123;</div><div class="line">                <span class="built_in">console</span>.log(seq.objectIndex, seq.partPer.toFixed(<span class="number">2</span>), seq.frame + <span class="string">' / '</span> + seq.frameMax)</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">10</span> - <span class="number">20</span> * partPer, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">10</span> - <span class="number">20</span> * partPer);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">2</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">10</span> - <span class="number">20</span> * partPer, <span class="number">-10</span>);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> a = <span class="number">-10</span> + <span class="number">20</span> * partPer;</div><div class="line">                    camera.position.set(a, a, a);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">var</span> secs = <span class="number">0</span>,</div><div class="line">    fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="0-3-using-more-than-one-seq-object-example"><a href="#0-3-using-more-than-one-seq-object-example" class="headerlink" title="0.3 - using more than one seq object example"></a>0.3 - using more than one seq object example</h3><p>So now for a demo script just for the sake of making sure that this module is working out okay just the way I like it to. I am thinking that I should test out the default feature when it comes to setting secs values for each object, but also a few more nested sequence objects that make use of the per values like I have been doing thus far with the older sequence module. So then I maybe it would be a good idea to have two mesh objects one of which is mutated by making use of one or more nested sequence objects that will be used in a main sequence objects, and then another mesh object that will just be mutated with over time in the before objects method of the main sequence object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>))</div><div class="line">    <span class="keyword">var</span> width = <span class="number">640</span>, height = <span class="number">480</span>,</div><div class="line">    fieldOfView = <span class="number">40</span>, aspectRatio = width / height,</div><div class="line">    near = <span class="number">0.1</span>, far = <span class="number">1000</span>,</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(fieldOfView, aspectRatio, near, far);</div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(width, height);</div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="keyword">var</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">var</span> mesh2 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">30</span>, <span class="number">30</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh2);</div><div class="line">    <span class="comment">// seq object for mesh1 that scales the mesh</span></div><div class="line">    <span class="keyword">var</span> seq_mesh1_scale = seqHooks.create(&#123;</div><div class="line">        <span class="attr">setPerValues</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            mesh1.scale.set(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> s = <span class="number">1</span> + <span class="number">2</span> * partPer;</div><div class="line">                    mesh1.scale.set(s, s, s);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0.15</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    mesh1.scale.set(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0.25</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> s = <span class="number">3</span> - <span class="number">2</span> * partPer;</div><div class="line">                    mesh1.scale.set(s, s, s);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// seq object for mesh1 that rotates the mesh</span></div><div class="line">    <span class="keyword">var</span> seq_mesh1_rotate = seqHooks.create(&#123;</div><div class="line">        <span class="attr">setPerValues</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            mesh1.scale.set(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">            mesh1.rotation.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            mesh1.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">4</span> * seq.per;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    mesh1.rotation.x = <span class="built_in">Math</span>.PI * <span class="number">1.5</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0.5</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    mesh1.rotation.x = <span class="built_in">Math</span>.PI;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">var</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            <span class="keyword">var</span> r = <span class="built_in">Math</span>.PI * <span class="number">2</span> * seq.per;</div><div class="line">            <span class="keyword">var</span> x = <span class="built_in">Math</span>.cos(r) * <span class="number">4</span>;</div><div class="line">            <span class="keyword">var</span> z = <span class="built_in">Math</span>.sin(r) * <span class="number">4</span>;</div><div class="line">            mesh2.position.set(x, <span class="number">0</span>, z);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">afterObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            camera.lookAt(mesh1.position);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">per</span>: <span class="number">0</span>,</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="comment">// seq_mesh1</span></div><div class="line">                    seqHooks.setFrame(seq_mesh1_scale, seq.partFrame, seq.partFrameMax);</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    camera.position.set(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    camera.position.set(<span class="number">10</span> - <span class="number">20</span> * partPer, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">10</span> - <span class="number">7</span> * partPer, <span class="number">10</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">3</span>, <span class="number">10</span>);</div><div class="line">                    <span class="keyword">var</span> x = <span class="number">10</span> * partBias;</div><div class="line">                    camera.lookAt(mesh1.position.clone().add(<span class="keyword">new</span> THREE.Vector3(x, <span class="number">0</span>, <span class="number">0</span>)));</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">10</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="comment">// seq_mesh1</span></div><div class="line">                    seqHooks.setFrame(seq_mesh1_rotate, seq.partFrame, seq.partFrameMax);</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">3</span> - <span class="number">10</span> * partPer, <span class="number">10</span> - <span class="number">30</span> * partPer);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">var</span> secs = <span class="number">0</span>,</div><div class="line">    fps_update = <span class="number">10</span>,</div><div class="line">    fps_movement = <span class="number">30</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="1-Revision-r1-of-the-sequence-hooks-module"><a href="#1-Revision-r1-of-the-sequence-hooks-module" class="headerlink" title="1 - Revision r1 of the sequence hooks module"></a>1 - Revision r1 of the sequence hooks module</h2><p>I have been using r0 of this module for a few months now, and have found that there are a few features that I should add to help keep me from having to repeat the same code over and over again from on video to the next. That is that I would like to have a get per method that I can call of the seq object to get a value from 0 to 1 that will change depending on the current fame rather to a max frame value for the video as a whole, or a current sequence object. This is all ready the case with a static value but I would like to be able to pass a count argument that will change the number of times 0 progress to 1 over the duration of a sequence or video as a whole.</p>
<iframe class="youtube_video" src="https://www.youtube.com/embed/hBUt0Jc0lL4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>



<p>On top of having a get percent function I would also like to have a get bias function that goes from 0 to 1 back to zero a count of times in a linear way. Also I would like another function that works like this get bias function only it uses the Math sin method to do so in a not so linear way.</p>
<p>There is also the part frame bug that I wanted to tackle in this revision, and so so in a way where I can still use the buggy old behavior if I want to if it turns out that my newer expressions do not work as expect in all situations. With that said all of this has been addresses and added in r1 of the module here.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* seq-hooks-r1.js - sequence hooks library from threejs-examples-sequence-hooks</span></div><div class="line"> *    * added an seq.getPer method</div><div class="line"> *    * added an seq.getBias and seq.getSinBias methods</div><div class="line"> *    * new public methods for getPer, getBias, and getSinBias</div><div class="line"> *    * added an seg.pff (Part Frame Function) that can be set via create options</div><div class="line"> *    * pff function is used to set what expressions to use to get partFrame and partFrame max values</div><div class="line"> *    * three built in pff functions 'r0', 'r0Cap', and 'r1' with a default of 'r1'</div><div class="line"> *    * can define a custom pff function if needed by just using a function rather than string value for seq.pff</div><div class="line"> */</div><div class="line"><span class="keyword">var</span> seqHooks = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// SET PART FRAME FUNCTIONS</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="keyword">var</span> partFrameFunctions = &#123;</div><div class="line">        <span class="comment">// expressions used in r0</span></div><div class="line">        r0: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            seq.partFrameMax = <span class="built_in">Math</span>.floor( (per2 - obj.per) * seq.frameMax );</div><div class="line">            seq.partFrame = seq.frame - <span class="built_in">Math</span>.floor( seq.frameMax * obj.per );</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">r0cap</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            partFrameFunctions[<span class="string">'r0'</span>](seq, per2, obj);</div><div class="line">            seq.partFrame = seq.partFrame &gt;= seq.partFrameMax ? seq.partFrameMax - <span class="number">1</span> : seq.partFrame;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// new expression for r1</span></div><div class="line">        r1: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            seq.partFrameMax = <span class="built_in">Math</span>.round( (per2 - obj.per) * seq.frameMax );</div><div class="line">            seq.partFrame = <span class="built_in">Math</span>.floor(seq.frame - seq.frameMax * obj.per);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// no operation</span></div><div class="line">    <span class="keyword">var</span> noop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">    <span class="comment">// internal get per method</span></div><div class="line">    <span class="keyword">var</span> getPer = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> a / b;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// internal get bias method</span></div><div class="line">    <span class="keyword">var</span> getBias = <span class="function"><span class="keyword">function</span>(<span class="params">per</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> - <span class="built_in">Math</span>.abs( <span class="number">0.5</span> - per ) / <span class="number">0.5</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get total secs value helper</span></div><div class="line">    <span class="keyword">var</span> getTotalSecs = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> seq.objects.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc, obj</span>)</span>&#123; <span class="keyword">return</span> acc + (obj.secs || <span class="number">0</span>) &#125;, <span class="number">0</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get sin bias helper</span></div><div class="line">    <span class="keyword">var</span> getSinBias = <span class="function"><span class="keyword">function</span>(<span class="params">per</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> b = getBias(per);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.sin( <span class="built_in">Math</span>.PI * <span class="number">0.5</span> * b );</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create and return a getPer method to be used as seq.getPer</span></div><div class="line">    <span class="keyword">var</span> createGetPerMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="comment">// by default return current 1 count per value for the current sequence object</span></div><div class="line">            count = count === <span class="literal">undefined</span> ? <span class="number">1</span> : count;</div><div class="line">            objectPer = objectPer === <span class="literal">undefined</span> ? <span class="literal">true</span>: objectPer;</div><div class="line">            <span class="comment">// if I want a objectPer value</span></div><div class="line">            <span class="keyword">var</span> a = seq.partFrame, b = seq.partFrameMax;</div><div class="line">            <span class="comment">// not object per</span></div><div class="line">            <span class="keyword">if</span>(!objectPer)&#123;</div><div class="line">                a = seq.frame; </div><div class="line">                b = seq.frameMax;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// base p value</span></div><div class="line">            <span class="keyword">var</span> p = getPer(a, b);</div><div class="line">            <span class="comment">// return base p value effected by count</span></div><div class="line">            <span class="keyword">return</span> p * count % <span class="number">1</span>;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a get bias method to be used for sm.getBias</span></div><div class="line">    <span class="keyword">var</span> createGetBiasMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="keyword">var</span> per = seq.getPer(count, objectPer);</div><div class="line">            <span class="keyword">return</span> getBias(per);</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a get bias method to be used for sm.getBias</span></div><div class="line">    <span class="keyword">var</span> createGetSinBiasMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="keyword">var</span> per = seq.getPer(count, objectPer);</div><div class="line">            <span class="keyword">return</span> getSinBias(per);</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// CREATE - create and return a new seq object</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// create new seq object method</span></div><div class="line">    api.create = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.setPerValues = opt.setPerValues === <span class="literal">undefined</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div><div class="line">        <span class="keyword">var</span> seq = &#123;&#125;;</div><div class="line">        seq.objectIndex = <span class="number">0</span>;</div><div class="line">        seq.per = <span class="number">0</span>;</div><div class="line">        seq.bias = <span class="number">0</span>;</div><div class="line">        seq.frame = <span class="number">0</span>;</div><div class="line">        seq.frameMax = <span class="number">100</span>;</div><div class="line">        seq.pff = opt.pff || <span class="string">'r1'</span>;</div><div class="line">        <span class="comment">// parse hooks</span></div><div class="line">        seq.beforeObjects = opt.beforeObjects || noop;</div><div class="line">        seq.afterObjects = opt.afterObjects || noop;</div><div class="line">        <span class="comment">// parse objects</span></div><div class="line">        seq.objects = opt.objects || [];</div><div class="line">        seq.objects = seq.objects.map(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">            obj.per = obj.per === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.per;</div><div class="line">            obj.secs = obj.secs === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.secs;</div><div class="line">            obj.data = obj.data || &#123;&#125;;</div><div class="line">            obj.update = obj.update || noop;</div><div class="line">            <span class="keyword">return</span> obj;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set per values is part of the create process</span></div><div class="line">        <span class="keyword">if</span>(opt.setPerValues)&#123;</div><div class="line">            api.setPerValues(seq, opt.fps === <span class="literal">undefined</span> ? <span class="number">30</span>: opt.fps);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// create get per method for this object</span></div><div class="line">        seq.getPer = createGetPerMethod(seq);</div><div class="line">        seq.getBias = createGetBiasMethod(seq);</div><div class="line">        seq.getSinBias = createGetSinBiasMethod(seq);</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// SET FRAME</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// update the given seq object by way of a frame, and maxFrame value</span></div><div class="line">    api.setFrame = <span class="function"><span class="keyword">function</span>(<span class="params">seq, frame, frameMax</span>)</span>&#123;</div><div class="line">        seq.frame = frame === <span class="literal">undefined</span> ? <span class="number">0</span> : frame;</div><div class="line">        seq.frameMax = frameMax === <span class="literal">undefined</span> ? <span class="number">100</span> : frameMax;</div><div class="line">        <span class="comment">// just making sure frame value is vaild</span></div><div class="line">        seq.frame = seq.frame % frameMax;</div><div class="line">        <span class="comment">// set main per and bias values</span></div><div class="line">        seq.per = getPer(seq.frame, seq.frameMax);</div><div class="line">        seq.bias = getBias(seq.per);</div><div class="line">        <span class="comment">// update object index</span></div><div class="line">        seq.objectIndex = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">var</span> obj = seq.objects[i];</div><div class="line">            <span class="keyword">var</span> per2 = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(seq.objects[i + <span class="number">1</span>] != <span class="literal">undefined</span>)&#123;</div><div class="line">                per2 = seq.objects[i + <span class="number">1</span>].per;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// if this is the current object update object </span></div><div class="line">            <span class="comment">// index as well as other relevant values</span></div><div class="line">            <span class="keyword">if</span>(seq.per &gt;= obj.per &amp;&amp; seq.per &lt; per2)&#123;</div><div class="line">                seq.objectIndex = i;</div><div class="line">                <span class="comment">// fix for #0 still allows for using old methid for setting partFrame values if needed</span></div><div class="line">                <span class="comment">// while also allowing for addtional custom fix if needed by setting seq.pff to a function</span></div><div class="line">                <span class="comment">// see partFrameFunctions above for examples</span></div><div class="line">                <span class="keyword">if</span>(<span class="keyword">typeof</span> seq.pff === <span class="string">'function'</span>)&#123;</div><div class="line">                    seq.pff(seq, per2, obj);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    partFrameFunctions[seq.pff](seq, per2, obj);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// set partPer and partBias</span></div><div class="line">                seq.partPer = getPer(seq.partFrame, seq.partFrameMax);</div><div class="line">                seq.partBias = getBias(seq.partPer);</div><div class="line">                seq.partSinBias = getSinBias(seq.partPer);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// call before hook</span></div><div class="line">        seq.beforeObjects(seq);</div><div class="line">        <span class="comment">// call update for current object</span></div><div class="line">        <span class="keyword">var</span> obj = seq.objects[seq.objectIndex];</div><div class="line">        <span class="keyword">if</span>(obj)&#123;</div><div class="line">            seq.obj = obj;</div><div class="line">            obj.update(seq, seq.partPer, seq.partBias, seq.partSinBias, obj);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// call after objects hook</span></div><div class="line">        seq.afterObjects(seq);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// PUBLIC GET PER AND BIAS METHODS</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    api.getPer = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        a = a === <span class="literal">undefined</span> ? <span class="number">0</span> : a;</div><div class="line">        b = b === <span class="literal">undefined</span> ? <span class="number">1</span> : b;</div><div class="line">        count = count === <span class="literal">undefined</span> ? <span class="number">1</span> : count;</div><div class="line">        <span class="keyword">var</span> per = a / b;</div><div class="line">        <span class="keyword">return</span> per * count % <span class="number">1</span>;</div><div class="line">    &#125;;</div><div class="line">    api.getBias = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> per = api.getPer(a, b, count);</div><div class="line">        <span class="keyword">return</span> getBias(per);</div><div class="line">    &#125;;</div><div class="line">    api.getSinBias = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> per = api.getPer(a, b, count);</div><div class="line">        <span class="keyword">return</span> getSinBias(per);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// OTHER PUBLIC METHODS</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// just get an array of per values based on sec values for each object, and DO NOT MUTATE the seq object</span></div><div class="line">    api.getPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">var</span> perValues = [];</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">var</span> per = perValues[i - <span class="number">1</span>];</div><div class="line">            <span class="keyword">if</span>( per === <span class="literal">undefined</span> )&#123;</div><div class="line">                perValues.push(<span class="number">0</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">var</span> perDelta = seq.objects[i - <span class="number">1</span>].secs / secsTotal;</div><div class="line">                perValues.push( <span class="built_in">parseFloat</span>( ( per + perDelta ).toFixed(<span class="number">4</span>) ) );</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> perValues;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a target frames value</span></div><div class="line">    api.getTargetFrames = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        fps = fps === <span class="literal">undefined</span> ? <span class="number">30</span> : fps;</div><div class="line">        <span class="keyword">var</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.ceil(secsTotal * fps);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// set per values</span></div><div class="line">    api.setPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        <span class="comment">// set seq.totalSecs</span></div><div class="line">        seq.totalSecs = getTotalSecs(seq);</div><div class="line">        <span class="comment">// set per values</span></div><div class="line">        api.getPerValues(seq).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">per, i</span>)</span>&#123;</div><div class="line">            seq.objects[i].per = per;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set frameMax</span></div><div class="line">        seq.frameMax = api.getTargetFrames(seq, fps);</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// return public api</span></div><div class="line">    <span class="keyword">return</span> api;</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="1-1-Demo-of-new-getPer-getBias-and-getSinBias-methods"><a href="#1-1-Demo-of-new-getPer-getBias-and-getSinBias-methods" class="headerlink" title="1.1 - Demo of new getPer, getBias and getSinBias methods"></a>1.1 - Demo of new getPer, getBias and getSinBias methods</h3><p>I then will want to work out at least one demo that tests these new get percent methods out. With that it would seem that the public methods of the seqhooks main global work great. I am not sure if I will need them or not but I do not thing that these should just be internal or usable for the current state of sequence objects alone.</p>
<p>It would seem that the methods that I added for the seq object work great, and the new get sin bias method results in some cool camera movement and mutation of values effects with fov and so forth.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>))</div><div class="line">    <span class="keyword">var</span> width = <span class="number">640</span>, height = <span class="number">480</span>,</div><div class="line">    fieldOfView = <span class="number">40</span>, aspectRatio = width / height,</div><div class="line">    near = <span class="number">0.1</span>, far = <span class="number">1000</span>,</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(fieldOfView, aspectRatio, near, far);</div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(width, height);</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="keyword">var</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">var</span> mesh2 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">30</span>, <span class="number">30</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh2);</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// PUBLIC seqHooks.getPer</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getPer(<span class="number">2</span>, <span class="number">10</span>, <span class="number">1</span>) ); <span class="comment">// 0.2</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getPer(<span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>) ); <span class="comment">// 0.4</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getBias(<span class="number">2</span>, <span class="number">10</span>, <span class="number">1</span>) ); <span class="comment">// 0.4</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getBias(<span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>) ); <span class="comment">// 0.8</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getSinBias(<span class="number">2</span>, <span class="number">10</span>, <span class="number">1</span>) ); <span class="comment">// 0.5877852522924731</span></div><div class="line">    <span class="built_in">console</span>.log( seqHooks.getSinBias(<span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>) ); <span class="comment">// 0.9510565162951535</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// CREATE seq objects using seq.getPer</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">var</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="comment">// before current seq.objects</span></div><div class="line">        beforeObjects: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            <span class="comment">// mesh1</span></div><div class="line">            <span class="keyword">var</span> r = <span class="built_in">Math</span>.PI * <span class="number">2</span> * seq.per;</div><div class="line">            <span class="keyword">var</span> x = <span class="built_in">Math</span>.cos(r) * <span class="number">2</span>;</div><div class="line">            <span class="keyword">var</span> z = <span class="built_in">Math</span>.sin(r) * <span class="number">2</span>;</div><div class="line">            mesh1.position.set(x, <span class="number">0</span>, z);</div><div class="line">            mesh1.lookAt(mesh2.position);</div><div class="line">            <span class="comment">// defaults for camera</span></div><div class="line">            camera.fov = <span class="number">40</span>;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// after current seq.objects</span></div><div class="line">        afterObjects: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            <span class="comment">// always update camera matrix after beforeObjects hook, </span></div><div class="line">            <span class="comment">// and current update in seq.objects</span></div><div class="line">            camera.updateProjectionMatrix();</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// array of objects for each sequnce</span></div><div class="line">        objects: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias, partSinBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> p = seq.getPer(<span class="number">4</span>);</div><div class="line">                    <span class="keyword">var</span> r = <span class="built_in">Math</span>.PI * <span class="number">2</span> * p,</div><div class="line">                    x = <span class="built_in">Math</span>.cos(r) * <span class="number">5</span>,</div><div class="line">                    z = <span class="built_in">Math</span>.sin(r) * <span class="number">5</span>;</div><div class="line">                    mesh2.position.set(x, <span class="number">0</span>, z);</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    <span class="keyword">var</span> b = seq.getSinBias(<span class="number">4</span>);</div><div class="line">                    camera.fov = <span class="number">40</span> - <span class="number">15</span> * b;</div><div class="line">                    camera.position.set(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span> - <span class="number">5</span> * partSinBias);</div><div class="line">                    camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> p = seq.getPer(<span class="number">2</span>);</div><div class="line">                    <span class="keyword">var</span> r = <span class="built_in">Math</span>.PI * <span class="number">2</span> * p,</div><div class="line">                    x = <span class="built_in">Math</span>.cos(r) * <span class="number">5</span>,</div><div class="line">                    z = <span class="built_in">Math</span>.sin(r) * <span class="number">5</span>;</div><div class="line">                    mesh2.position.set(x, z, <span class="number">0</span>);</div><div class="line">                    <span class="comment">// camera</span></div><div class="line">                    <span class="keyword">var</span> b = seq.getBias(<span class="number">2</span>);</div><div class="line">                    camera.fov = <span class="number">40</span> - <span class="number">15</span> * b;</div><div class="line">                    camera.position.set(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">                    camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="comment">//******** **********</span></div><div class="line">    <span class="keyword">var</span> secs = <span class="number">0</span>,</div><div class="line">    fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="1-2-Fix-for-partFrame-bug-in-r0-still-allows-for-older-functionally-depending-of-seq-pff-value"><a href="#1-2-Fix-for-partFrame-bug-in-r0-still-allows-for-older-functionally-depending-of-seq-pff-value" class="headerlink" title="1.2 - Fix for partFrame bug in r0, still allows for older functionally depending of seq.pff value"></a>1.2 - Fix for partFrame bug in r0, still allows for older functionally depending of seq.pff value</h3><p>There is then also the question of my new expressions that are used to set the part frame and part frame max values. I need to make sure that things look good when using them and that the part percent values do not equal, let alone go over the value of 1. It would seem that the hard coded expressions that I am using for this work well, but there might come a time where I will run into some weird rendering issues again. To address this I can use the new seq.pff value to change to another built in function that sets these part frame values, including the old expressions from r0. In addition I can also define a custom function for this if need be by just setting the value of seg.pff to a function in which I define the expressions I want to use rather than a string value.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//********</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="comment">//********</span></div><div class="line">    <span class="keyword">var</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>));</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">40</span>, <span class="number">640</span> / <span class="number">480</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">var</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>);</div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="keyword">var</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">var</span> mesh2 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.5</span>, <span class="number">30</span>, <span class="number">30</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh2);</div><div class="line">    </div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">var</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">            mesh2.position.set(<span class="number">4</span> - <span class="number">8</span> * seq.bias, <span class="number">0</span>, <span class="number">1</span>);</div><div class="line">            <span class="comment">// this will still happen depeding on the method used to get partFrame and partFrame max values</span></div><div class="line">            <span class="comment">// uncomment to use old 'r0' expressions of define custom</span></div><div class="line">            <span class="comment">//seq.pff = 'r0';</span></div><div class="line">            <span class="comment">//seq.pff = 'r0cap';</span></div><div class="line">            <span class="comment">//seq.pff = function(seq, per2, obj)&#123;</span></div><div class="line">            <span class="comment">//        seq.partFrameMax = Math.ceil( (per2 - obj.per) * seq.frameMax );</span></div><div class="line">            <span class="comment">//        seq.partFrame = Math.floor(seq.frame - seq.frameMax * obj.per);</span></div><div class="line">            <span class="comment">//&#125;;</span></div><div class="line">            <span class="keyword">if</span>(seq.partPer &gt;= <span class="number">1</span>)&#123;</div><div class="line">                <span class="built_in">console</span>.log(seq.objectIndex, seq.partPer.toFixed(<span class="number">2</span>), seq.partFrame + <span class="string">' / '</span> + seq.partFrameMax)</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">10</span> - <span class="number">20</span> * partPer, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">10</span> - <span class="number">20</span> * partPer);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">2</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    camera.position.set(<span class="number">-10</span>, <span class="number">10</span> - <span class="number">20</span> * partPer, <span class="number">-10</span>);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, partPer, partBias</span>)</span>&#123;</div><div class="line">                    <span class="keyword">var</span> a = <span class="number">-10</span> + <span class="number">20</span> * partPer;</div><div class="line">                    camera.position.set(a, a, a);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">var</span> secs = <span class="number">0</span>,</div><div class="line">    fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>,</div><div class="line">    lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>This might be a killing a mosquito with a cannon kind of situation, but if the r1 expressions work well long enough I might remove this bloat in any future revisions of this and just use the r1 expressions alone for this.</p>
<h2 id="2-Vector3-Paths-feature-added-in-r2-of-sequence-hooks"><a href="#2-Vector3-Paths-feature-added-in-r2-of-sequence-hooks" class="headerlink" title="2 - Vector3 Paths feature added in r2 of sequence hooks"></a>2 - Vector3 Paths feature added in r2 of sequence hooks</h2><p>The main feature that I wanted to add in r2 of the sequence hooks module is a way to define some paths that can be used to define the motion of objects such as mesh objects and the camera. I have started a few projects outside of this module for this sort of thing, but sense this is a module that I use all the time I thought that if i bake something into this they I will have something at the ready to use right away while I explore options for other ways of doing this sort of thing that might involve things like the Curve class for example.</p>
<p>Anyway the way that I use this so to define one or more path objects that contain an array of Vector3 objects, or an array of numbers that can be converted to such an array. One example of an array fo numbers that would work is the array of a position attribute of a buffer geometry instance which is what I am doing in one of the demos for this revision of the module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* seq-hooks.js - r2 - from threejs-examples-sequence-hooks</span></div><div class="line"> *        * Made 'OTHER' publuc methods private helper</div><div class="line"> *        * using this['seqHooks'] = &#123;&#125; in place of returning public api</div><div class="line"> *        * using let and const</div><div class="line"> *        * V3Paths</div><div class="line"> */</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SET PART FRAME FUNCTIONS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> partFrameFunctions = &#123;</div><div class="line">        <span class="comment">// expressions used in r0</span></div><div class="line">        r0: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            seq.partFrameMax = <span class="built_in">Math</span>.floor( (per2 - obj.per) * seq.frameMax );</div><div class="line">            seq.partFrame = seq.frame - <span class="built_in">Math</span>.floor( seq.frameMax * obj.per );</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">r0cap</span>: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            partFrameFunctions[<span class="string">'r0'</span>](seq, per2, obj);</div><div class="line">            seq.partFrame = seq.partFrame &gt;= seq.partFrameMax ? seq.partFrameMax - <span class="number">1</span> : seq.partFrame;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">// new expression for r1</span></div><div class="line">        r1: <span class="function"><span class="keyword">function</span>(<span class="params">seq, per2, obj</span>)</span>&#123;</div><div class="line">            seq.partFrameMax = <span class="built_in">Math</span>.round( (per2 - obj.per) * seq.frameMax );</div><div class="line">            seq.partFrame = <span class="built_in">Math</span>.floor(seq.frame - seq.frameMax * obj.per);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// no operation</span></div><div class="line">    <span class="keyword">const</span> noop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">    <span class="comment">// internal get per method</span></div><div class="line">    <span class="keyword">const</span> getPer = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> a / b;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// internal get bias method</span></div><div class="line">    <span class="keyword">const</span> getBias = <span class="function"><span class="keyword">function</span>(<span class="params">per</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> - <span class="built_in">Math</span>.abs( <span class="number">0.5</span> - per ) / <span class="number">0.5</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get total secs value helper</span></div><div class="line">    <span class="keyword">const</span> getTotalSecs = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> seq.objects.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc, obj</span>)</span>&#123; <span class="keyword">return</span> acc + (obj.secs || <span class="number">0</span>) &#125;, <span class="number">0</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get sin bias helper</span></div><div class="line">    <span class="keyword">const</span> getSinBias = <span class="function"><span class="keyword">function</span>(<span class="params">per</span>)</span>&#123;</div><div class="line">        <span class="keyword">const</span> b = getBias(per);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.sin( <span class="built_in">Math</span>.PI * <span class="number">0.5</span> * b );</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create and return a getPer method to be used as seq.getPer</span></div><div class="line">    <span class="keyword">const</span> createGetPerMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="comment">// by default return current 1 count per value for the current sequence object</span></div><div class="line">            count = count === <span class="literal">undefined</span> ? <span class="number">1</span> : count;</div><div class="line">            objectPer = objectPer === <span class="literal">undefined</span> ? <span class="literal">true</span>: objectPer;</div><div class="line">            <span class="comment">// if I want a objectPer value</span></div><div class="line">            <span class="keyword">let</span> a = seq.partFrame, b = seq.partFrameMax;</div><div class="line">            <span class="comment">// not object per</span></div><div class="line">            <span class="keyword">if</span>(!objectPer)&#123;</div><div class="line">                a = seq.frame; </div><div class="line">                b = seq.frameMax;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// base p value</span></div><div class="line">            <span class="keyword">let</span> p = getPer(a, b);</div><div class="line">            <span class="comment">// return base p value effected by count</span></div><div class="line">            <span class="keyword">return</span> p * count % <span class="number">1</span>;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a get bias method to be used for sm.getBias</span></div><div class="line">    <span class="keyword">const</span> createGetBiasMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="keyword">const</span> per = seq.getPer(count, objectPer);</div><div class="line">            <span class="keyword">return</span> getBias(per);</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create a get bias method to be used for sm.getBias</span></div><div class="line">    <span class="keyword">const</span> createGetSinBiasMethod = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">count, objectPer</span>)</span>&#123;</div><div class="line">            <span class="keyword">const</span> per = seq.getPer(count, objectPer);</div><div class="line">            <span class="keyword">return</span> getSinBias(per);</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// just get an array of per values based on sec values for each object, and DO NOT MUTATE the seq object</span></div><div class="line">    <span class="keyword">const</span> getPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq</span>)</span>&#123;</div><div class="line">        <span class="keyword">const</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">const</span> perValues = [];</div><div class="line">        <span class="keyword">let</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">const</span> per = perValues[i - <span class="number">1</span>];</div><div class="line">            <span class="keyword">if</span>( per === <span class="literal">undefined</span> )&#123;</div><div class="line">                perValues.push(<span class="number">0</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">const</span> perDelta = seq.objects[i - <span class="number">1</span>].secs / secsTotal;</div><div class="line">                perValues.push( <span class="built_in">parseFloat</span>( ( per + perDelta ).toFixed(<span class="number">4</span>) ) );</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> perValues;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a target frames value</span></div><div class="line">    <span class="keyword">const</span> getTargetFrames = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        fps = fps === <span class="literal">undefined</span> ? <span class="number">30</span> : fps;</div><div class="line">        <span class="keyword">const</span> secsTotal = getTotalSecs(seq);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.ceil(secsTotal * fps);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// set per values</span></div><div class="line">    <span class="keyword">const</span> setPerValues = <span class="function"><span class="keyword">function</span>(<span class="params">seq, fps</span>)</span>&#123;</div><div class="line">        <span class="comment">// set seq.totalSecs</span></div><div class="line">        seq.totalSecs = getTotalSecs(seq);</div><div class="line">        <span class="comment">// set per values</span></div><div class="line">        getPerValues(seq).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">per, i</span>)</span>&#123;</div><div class="line">            seq.objects[i].per = per;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set frameMax</span></div><div class="line">        seq.frameMax = getTargetFrames(seq, fps);</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// CREATE - create and return a new seq object</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// Parse a v3Paths object, filling in any blanks, anc convert forms other than v3array to v3array</span></div><div class="line">    <span class="keyword">const</span> parseV3PathsObject = <span class="function">(<span class="params">seq, v3Paths</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// check each path object given</span></div><div class="line">        v3Paths.forEach( <span class="function">(<span class="params">pathObj</span>) =&gt;</span> &#123;</div><div class="line">            <span class="comment">// must have a key, array, and lerp bool</span></div><div class="line">            pathObj.key = pathObj.key || <span class="string">'unnamed_'</span> + <span class="built_in">Object</span>.keys(seq.v3Paths.paths).length;</div><div class="line">            pathObj.array = pathObj.array || [];</div><div class="line">            pathObj.lerp = pathObj.lerp === <span class="literal">undefined</span> ? <span class="literal">false</span> : pathObj.lerp; </div><div class="line">            <span class="comment">// IF NUMBER ARRAY, convert to vector3 array</span></div><div class="line">            <span class="keyword">if</span>(<span class="keyword">typeof</span> pathObj.array[<span class="number">0</span>] === <span class="string">'number'</span>)&#123;</div><div class="line">                <span class="keyword">let</span> v3Array = [];</div><div class="line">                <span class="keyword">let</span> i = <span class="number">0</span>, len = pathObj.array.length;</div><div class="line">                <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">                    v3Array.push(<span class="keyword">new</span> THREE.Vector3(</div><div class="line">                        pathObj.array[i],</div><div class="line">                        pathObj.array[i + <span class="number">1</span>],</div><div class="line">                        pathObj.array[i + <span class="number">2</span>]</div><div class="line">                    ))</div><div class="line">                    i += <span class="number">3</span>;</div><div class="line">                &#125;</div><div class="line">                pathObj.array = v3Array;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create new seq object method</span></div><div class="line">    api.create = <span class="function"><span class="keyword">function</span>(<span class="params">opt</span>)</span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        opt.setPerValues = opt.setPerValues === <span class="literal">undefined</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div><div class="line">        <span class="keyword">const</span> seq = &#123;&#125;;</div><div class="line">        seq.objectIndex = <span class="number">0</span>;  <span class="comment">// index of current sequence object in seq.objects</span></div><div class="line">        seq.per = <span class="number">0</span>;          <span class="comment">// main per and bias values</span></div><div class="line">        seq.bias = <span class="number">0</span>;</div><div class="line">        seq.frame = <span class="number">0</span>;        <span class="comment">// frame and frameMax for the full video</span></div><div class="line">        seq.frameMax = <span class="number">100</span>;</div><div class="line">        seq.partFrameMax = <span class="number">0</span>; <span class="comment">// partFrame and partFrame max are set by the Part Frame Function ( seq.pff )</span></div><div class="line">        seq.partFrame = <span class="number">0</span>;</div><div class="line">        seq.pff = opt.pff || <span class="string">'r1'</span>;</div><div class="line">        <span class="comment">// parse hooks</span></div><div class="line">        seq.beforeObjects = opt.beforeObjects || noop;</div><div class="line">        seq.afterObjects = opt.afterObjects || noop;</div><div class="line">        <span class="comment">// setup sequence objects</span></div><div class="line">        seq.objects = ( opt.objects || [] ).map(<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">            obj.per = obj.per === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.per;</div><div class="line">            obj.secs = obj.secs === <span class="literal">undefined</span> ? <span class="number">0</span> : obj.secs;</div><div class="line">            obj.data = obj.data || &#123;&#125;;</div><div class="line">            obj.update = obj.update || noop;</div><div class="line">            obj.v3Paths = obj.v3Paths || [];</div><div class="line">            <span class="comment">// parse v3Paths into Vector3 objects if numbers are given</span></div><div class="line">            parseV3PathsObject(seq, obj.v3Paths);</div><div class="line">            <span class="keyword">return</span> obj;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// set per values is part of the create process</span></div><div class="line">        <span class="keyword">if</span>(opt.setPerValues)&#123;</div><div class="line">            setPerValues(seq, opt.fps === <span class="literal">undefined</span> ? <span class="number">30</span>: opt.fps);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// create get per method for this object</span></div><div class="line">        seq.getPer = createGetPerMethod(seq);</div><div class="line">        seq.getBias = createGetBiasMethod(seq);</div><div class="line">        seq.getSinBias = createGetSinBiasMethod(seq);</div><div class="line">        <span class="comment">// MAIN seq.v3Paths object</span></div><div class="line">        seq.v3Paths = &#123;</div><div class="line">            <span class="attr">main</span>: opt.v3Paths || [],</div><div class="line">            <span class="attr">paths</span>: &#123;&#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// get pos helper</span></div><div class="line">        seq.getPos = <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">return</span> seq.v3Paths.paths[key];</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// copy pos helper</span></div><div class="line">        seq.copyPos = <span class="function">(<span class="params">key, target</span>) =&gt;</span> &#123;</div><div class="line">            target = target || &#123;&#125;;</div><div class="line">            <span class="keyword">const</span> v3 = seq.v3Paths.paths[key];</div><div class="line">            <span class="comment">// if target is object3d assume copy to position</span></div><div class="line">            <span class="keyword">if</span>(target.isObject3D)&#123;</div><div class="line">                target.position.copy(v3);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// if instance of Vector3 assume copy to that</span></div><div class="line">            <span class="keyword">if</span>(target <span class="keyword">instanceof</span> THREE.Vector3)&#123;</div><div class="line">                target.copy(v3)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> v3;</div><div class="line">        &#125;;</div><div class="line">        parseV3PathsObject(seq, seq.v3Paths.main );</div><div class="line">        <span class="comment">// CALL SET FRAME FOR FIRST TIME</span></div><div class="line">        api.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">        <span class="keyword">return</span> seq;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SET FRAME</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// set v3 paths for an object ( main seq object or a seq.objects object )</span></div><div class="line">    <span class="keyword">const</span> setV3PathsForObject = <span class="function">(<span class="params">seq, mainObj</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> obj = mainObj ? seq : seq.objects[seq.objectIndex];</div><div class="line">        <span class="keyword">const</span> per = mainObj ? seq.per : seq.partPer;</div><div class="line">        <span class="keyword">const</span> v3Paths = mainObj ? seq.v3Paths.main : obj.v3Paths;</div><div class="line">        <span class="keyword">const</span> maxFrame = mainObj ? seq.frameMax: seq.partFrameMax;</div><div class="line">        <span class="keyword">if</span>(v3Paths)&#123;</div><div class="line">            <span class="keyword">let</span> i = <span class="number">0</span>, len = v3Paths.length;</div><div class="line">             <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">                 <span class="keyword">const</span> pathObj = v3Paths[i];</div><div class="line">                 <span class="keyword">const</span> array = pathObj.array;</div><div class="line">                 <span class="keyword">const</span> cv = <span class="keyword">new</span> THREE.Vector3(); <span class="comment">// current vector</span></div><div class="line">                 <span class="keyword">const</span> len = array.length - <span class="number">1</span>;</div><div class="line">                 <span class="keyword">let</span> vi1 = <span class="built_in">Math</span>.floor( len * per );</div><div class="line">                 <span class="keyword">let</span> vi2 = vi1 + <span class="number">1</span>;</div><div class="line">                 vi2 = vi2 &gt; len ? len : vi2;</div><div class="line">                 <span class="comment">// if lerp mode is true I will want to have a Vector3 that</span></div><div class="line">                 <span class="comment">// is between two as there is not one on a frame by frame basic</span></div><div class="line">                 <span class="keyword">if</span>(pathObj.lerp &amp;&amp; array.length &lt; maxFrame)&#123;</div><div class="line">                     <span class="keyword">const</span> alpha =  len * per % <span class="number">1</span>;</div><div class="line">                     cv.copy( array[ vi1 ] ).lerp( array[ vi2 ], alpha );</div><div class="line">                 &#125;<span class="keyword">else</span>&#123;</div><div class="line">                     <span class="comment">// if not lerp mode just copy a vector3 from</span></div><div class="line">                     <span class="comment">// the array is it is equal to or greater than</span></div><div class="line">                     <span class="comment">// the count of frames</span></div><div class="line">                     <span class="keyword">let</span> vi1 = <span class="built_in">Math</span>.floor( array.length * per );</div><div class="line">                     vi1 = vi1 &gt; len ? len : vi1;</div><div class="line">                     cv.copy( array[ vi1 ] );</div><div class="line">                 &#125;</div><div class="line">                 <span class="comment">// key in to seq.v3Paths</span></div><div class="line">                 seq.v3Paths.paths[ pathObj.key ] = cv;</div><div class="line">                 i += <span class="number">1</span>;</div><div class="line">             &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// set v3 paths for main seq and current object in seq.objects</span></div><div class="line">    <span class="keyword">const</span> setV3Paths = <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;</div><div class="line">        seq.v3Paths.paths = []; <span class="comment">// clear paths to empty array</span></div><div class="line">        setV3PathsForObject(seq, <span class="literal">true</span>);</div><div class="line">        setV3PathsForObject(seq, <span class="literal">false</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// update the given seq object by way of a frame, and maxFrame value</span></div><div class="line">    api.setFrame = <span class="function"><span class="keyword">function</span>(<span class="params">seq, frame, frameMax</span>)</span>&#123;</div><div class="line">        seq.frame = frame === <span class="literal">undefined</span> ? <span class="number">0</span> : frame;</div><div class="line">        seq.frameMax = frameMax === <span class="literal">undefined</span> ? <span class="number">100</span> : frameMax;</div><div class="line">        <span class="comment">// just making sure frame value is vaild</span></div><div class="line">        seq.frame = seq.frame % frameMax;</div><div class="line">        <span class="comment">// set main per and bias values</span></div><div class="line">        seq.per = getPer(seq.frame, seq.frameMax);</div><div class="line">        seq.bias = getBias(seq.per);</div><div class="line">        <span class="comment">// update object index</span></div><div class="line">        seq.objectIndex = <span class="number">0</span>;</div><div class="line">        <span class="keyword">let</span> i = <span class="number">0</span>, len = seq.objects.length;</div><div class="line">        <span class="keyword">while</span>(i &lt; len)&#123;</div><div class="line">            <span class="keyword">const</span> obj = seq.objects[i];</div><div class="line">            <span class="keyword">let</span> per2 = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(seq.objects[i + <span class="number">1</span>] != <span class="literal">undefined</span>)&#123;</div><div class="line">                per2 = seq.objects[i + <span class="number">1</span>].per;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// if this is the current object update object </span></div><div class="line">            <span class="comment">// index as well as other relevant values</span></div><div class="line">            <span class="keyword">if</span>(seq.per &gt;= obj.per &amp;&amp; seq.per &lt; per2)&#123;</div><div class="line">                seq.objectIndex = i;</div><div class="line">                <span class="comment">// fix for #0 still allows for using old methid for setting partFrame values if needed</span></div><div class="line">                <span class="comment">// while also allowing for addtional custom fix if needed by setting seq.pff to a function</span></div><div class="line">                <span class="comment">// see partFrameFunctions above for examples</span></div><div class="line">                <span class="keyword">if</span>(<span class="keyword">typeof</span> seq.pff === <span class="string">'function'</span>)&#123;</div><div class="line">                    seq.pff(seq, per2, obj);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    partFrameFunctions[seq.pff](seq, per2, obj);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// set partPer and partBias</span></div><div class="line">                seq.partPer = getPer(seq.partFrame, seq.partFrameMax);</div><div class="line">                seq.partBias = getBias(seq.partPer);</div><div class="line">                seq.partSinBias = getSinBias(seq.partPer);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// V3 PATHS</span></div><div class="line">        setV3Paths(seq);</div><div class="line">        <span class="comment">// call before hook</span></div><div class="line">        seq.beforeObjects(seq);</div><div class="line">        <span class="comment">// call update for current object</span></div><div class="line">        <span class="keyword">const</span> obj = seq.objects[seq.objectIndex];</div><div class="line">        <span class="keyword">if</span>(obj)&#123;</div><div class="line">            seq.obj = obj;</div><div class="line">            obj.update(seq, seq.partPer, seq.partBias, seq.partSinBias, obj);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// call after objects hook</span></div><div class="line">        seq.afterObjects(seq);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// PUBLIC GET PER AND BIAS METHODS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    api.getPer = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        a = a === <span class="literal">undefined</span> ? <span class="number">0</span> : a;</div><div class="line">        b = b === <span class="literal">undefined</span> ? <span class="number">1</span> : b;</div><div class="line">        count = count === <span class="literal">undefined</span> ? <span class="number">1</span> : count;</div><div class="line">        <span class="keyword">const</span> per = a / b;</div><div class="line">        <span class="keyword">return</span> per * count % <span class="number">1</span>;</div><div class="line">    &#125;;</div><div class="line">    api.getBias = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        <span class="keyword">const</span> per = api.getPer(a, b, count);</div><div class="line">        <span class="keyword">return</span> getBias(per);</div><div class="line">    &#125;;</div><div class="line">    api.getSinBias = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, count</span>)</span>&#123;</div><div class="line">        <span class="keyword">const</span> per = api.getPer(a, b, count);</div><div class="line">        <span class="keyword">return</span> getSinBias(per);</div><div class="line">    &#125;;</div><div class="line">&#125;( <span class="keyword">this</span>[<span class="string">'seqHooks'</span>] = &#123;&#125; ));</div></pre></td></tr></table></figure>
<h3 id="2-1-Using-an-array-of-Vector3-class-instances"><a href="#2-1-Using-an-array-of-Vector3-class-instances" class="headerlink" title="2.1 - Using an array of Vector3 class instances"></a>2.1 - Using an array of Vector3 class instances</h3><p>In this demo I am creating arrays of Vector3 objects by directly calling the Vector3 constructor function. Chances are that I will not be creating paths this way in actually projects but I just want to confirm that I can create paths this way of I want to. I am thinking that the real way that I would want to create these paths would be to use some function that will create and return an array of vector3 objects.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add( <span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>) );</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">64</span> / <span class="number">48</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">const</span> mesh2 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh2);</div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">const</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">v3Paths</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">key</span>: <span class="string">'m1pos'</span>,</div><div class="line">                <span class="attr">array</span>: [</div><div class="line">                    <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>),</div><div class="line">                    <span class="keyword">new</span> THREE.Vector3(<span class="number">2</span>,<span class="number">-1</span>, <span class="number">0</span>),</div><div class="line">                    <span class="keyword">new</span> THREE.Vector3(<span class="number">2</span>,<span class="number">-2</span>,<span class="number">-5</span>)</div><div class="line">                ],</div><div class="line">                <span class="attr">lerp</span>: <span class="literal">false</span></div><div class="line">            &#125;</div><div class="line">        ],</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;</div><div class="line">            camera.position.set(<span class="number">-10</span>, <span class="number">5</span>, <span class="number">5</span>);</div><div class="line">            camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            mesh1.position.copy(seq.v3Paths.paths[<span class="string">'m1pos'</span>] );</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">afterObjects</span>: <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;&#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            <span class="comment">// seq0 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">3</span>,</div><div class="line">                <span class="attr">v3Paths</span>: [</div><div class="line">                    &#123;</div><div class="line">                        <span class="attr">key</span>: <span class="string">'m2pos'</span>,</div><div class="line">                        <span class="attr">array</span>: [</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">5</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">4</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">2</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">1</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">-1</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">-2</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">-3</span>)</div><div class="line">                        ],</div><div class="line">                        <span class="attr">lerp</span>: <span class="literal">true</span></div><div class="line">                    &#125;</div><div class="line">                ],</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    mesh2.position.copy(seq.v3Paths.paths[<span class="string">'m2pos'</span>] );</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">// seq1 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">7</span>,</div><div class="line">                <span class="attr">v3Paths</span>: [</div><div class="line">                    &#123;</div><div class="line">                        <span class="attr">key</span>: <span class="string">'m2pos'</span>,</div><div class="line">                        <span class="attr">array</span>: [</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">4</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">3</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">2</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">-1</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">-2</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">-3</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">-4</span>, <span class="number">0</span>,<span class="number">-3</span>),</div><div class="line">                            <span class="keyword">new</span> THREE.Vector3(<span class="number">-5</span>,<span class="number">0</span>,<span class="number">-3</span>)</div><div class="line">                        ],</div><div class="line">                        <span class="attr">lerp</span>: <span class="literal">true</span></div><div class="line">                    &#125;</div><div class="line">                ],</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    mesh2.position.copy(seq.v3Paths.paths[<span class="string">'m2pos'</span>] );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">const</span> fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>;</div><div class="line">    <span class="keyword">let</span> lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="2-2-Using-an-array-of-numbers"><a href="#2-2-Using-an-array-of-numbers" class="headerlink" title="2.2 - Using an array of numbers"></a>2.2 - Using an array of numbers</h3><p>Here I am testing out that the feature that I added where an array of numbers can be used that will then be converted to an array of vector3 objects works. Here I am using an array literal as a way to define the position of a camera over time. When it comes to the position of a mesh object though I am actually using the position attribute of a buffer geometry as that is an array that is formatted thins kind of way and sure enough that works just fine.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add( <span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>) );</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">64</span> / <span class="number">48</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="keyword">const</span> pathGeo = <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">5</span>, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line">    <span class="keyword">const</span> points = <span class="keyword">new</span> THREE.Points(pathGeo, <span class="keyword">new</span> THREE.PointsMaterial(&#123;<span class="attr">size</span>: <span class="number">0.25</span>&#125;));</div><div class="line">    scene.add(points)</div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="keyword">const</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">v3Paths</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">key</span>: <span class="string">'m1pos'</span>,</div><div class="line">                <span class="comment">// using the array of a position attribute</span></div><div class="line">                array: pathGeo.getAttribute(<span class="string">'position'</span>).array,</div><div class="line">                <span class="attr">lerp</span>: <span class="literal">true</span></div><div class="line">            &#125;</div><div class="line">        ],</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;</div><div class="line">            <span class="comment">//mesh1.position.copy(seq.v3Paths.paths['m1pos'] );</span></div><div class="line">            seq.copyPos(<span class="string">'m1pos'</span>, mesh1);</div><div class="line">            <span class="comment">//mesh1.lookAt( seq.copyPos('m1pos') );</span></div><div class="line">            mesh1.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            camera.position.set(<span class="number">-12</span>, <span class="number">7</span>, <span class="number">7</span>);</div><div class="line">            camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">afterObjects</span>: <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;&#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            <span class="comment">// seq0 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">30</span>,</div><div class="line">                <span class="attr">v3Paths</span>: [</div><div class="line">                    &#123;</div><div class="line">                        <span class="attr">key</span>: <span class="string">'campos'</span>,</div><div class="line">                        <span class="attr">array</span>: [</div><div class="line">                            <span class="number">2</span>, <span class="number">14</span>, <span class="number">2</span>,</div><div class="line">                            <span class="number">0</span>, <span class="number">12</span>, <span class="number">2</span>,</div><div class="line">                            <span class="number">-5</span>, <span class="number">10</span>, <span class="number">4</span>,</div><div class="line">                            <span class="number">-8</span>, <span class="number">7</span>, <span class="number">5</span>,</div><div class="line">                            <span class="number">-12</span>, <span class="number">7</span>, <span class="number">7</span></div><div class="line">                        ],</div><div class="line">                        <span class="attr">lerp</span>: <span class="literal">true</span></div><div class="line">                    &#125;</div><div class="line">                ],</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    seq.copyPos(<span class="string">'campos'</span>, camera);</div><div class="line">                    camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">// seq1 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">30</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">const</span> fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>;</div><div class="line">    <span class="keyword">let</span> lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h3 id="2-3-Using-curve-paths-to-create-the-points"><a href="#2-3-Using-curve-paths-to-create-the-points" class="headerlink" title="2.3 - Using curve paths to create the points"></a>2.3 - Using curve paths to create the points</h3><p>This demo of the new v3 paths feature will involve the use of curve paths using the <a href="/2022/10/21/threejs-curve-quadratic-bezier-curve3/">quadratic bezier curve3 class</a>. In future revisions of this module I might want to bake in some features that have to do with creating and using paths with curves actually and mainly the use of this quadratic bezier curve class as it creates the kinds of curves that I would often like to use for movement of objects and look at points in a scene.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// SCENE, CAMERA, and RENDERER</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line">    scene.add( <span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>) );</div><div class="line">    camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">64</span> / <span class="number">48</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line">    <span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</div><div class="line">    (<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line">    renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// create curve helper</span></div><div class="line">    <span class="keyword">const</span> createCurve = <span class="function">(<span class="params">vStart, vEnd, vDelta</span>) =&gt;</span> &#123;</div><div class="line">        vDelta = vDelta || <span class="keyword">new</span> THREE.Vector3();</div><div class="line">        <span class="comment">// control point is half way between vStart and vEnd</span></div><div class="line">        vControl = vStart.clone().lerp(vEnd, <span class="number">0.5</span>).add( vDelta );</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> THREE.QuadraticBezierCurve3(vStart, vControl, vEnd);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// MESH</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</div><div class="line">        <span class="keyword">new</span> THREE.MeshNormalMaterial());</div><div class="line">    scene.add(mesh1);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// CURVE, POINTS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> curve = <span class="keyword">new</span> THREE.CurvePath();</div><div class="line">    curve.add(createCurve(</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">-5</span>, <span class="number">0</span>, <span class="number">5</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">-3</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">5</span>)</div><div class="line">    ));</div><div class="line">    curve.add(createCurve(</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">5</span>, <span class="number">0</span>, <span class="number">-3</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">-2</span>, <span class="number">0</span>, <span class="number">-5</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">4</span>, <span class="number">0</span>, <span class="number">-5</span>)</div><div class="line">    ));</div><div class="line">    curve.add(createCurve(</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">-2</span>, <span class="number">0</span>, <span class="number">-5</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">-5</span>, <span class="number">0</span>, <span class="number">2</span>),</div><div class="line">        <span class="keyword">new</span> THREE.Vector3(<span class="number">-8</span>, <span class="number">0</span>, <span class="number">2</span>)</div><div class="line">    ));</div><div class="line">    <span class="comment">// points</span></div><div class="line">    <span class="keyword">const</span> points = <span class="keyword">new</span> THREE.Points(</div><div class="line">        (<span class="keyword">new</span> THREE.BufferGeometry).setFromPoints( curve.getPoints(<span class="number">50</span>) ),</div><div class="line">        <span class="keyword">new</span> THREE.PointsMaterial(&#123; <span class="attr">size</span>: <span class="number">0.2</span>&#125;)</div><div class="line">    );</div><div class="line">    scene.add(points);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// A MAIN SEQ OBJECT</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> seq = seqHooks.create(&#123;</div><div class="line">        <span class="attr">v3Paths</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">key</span>: <span class="string">'m1pos'</span>,</div><div class="line">                <span class="attr">array</span>: curve.getPoints(<span class="number">50</span>),</div><div class="line">                <span class="attr">lerp</span>: <span class="literal">true</span></div><div class="line">            &#125;</div><div class="line">        ],</div><div class="line">        <span class="attr">beforeObjects</span>: <span class="function">(<span class="params">seq</span>) =&gt;</span> &#123;</div><div class="line">            seq.copyPos(<span class="string">'m1pos'</span>, mesh1);</div><div class="line">            mesh1.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">objects</span>: [</div><div class="line">            <span class="comment">// seq0 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">15</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    camera.position.copy(mesh1.position).add(<span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">2</span>, <span class="number">-4</span>));</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">// seq1 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">5</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    <span class="keyword">const</span> v1 = mesh1.position.clone().add(<span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">2</span>, <span class="number">-4</span>));</div><div class="line">                    <span class="keyword">const</span> v2 = <span class="keyword">new</span> THREE.Vector3(<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>);</div><div class="line">                    camera.position.copy(v1).lerp(v2, partPer);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">// seq2 - </span></div><div class="line">            &#123;</div><div class="line">                <span class="attr">secs</span>: <span class="number">10</span>,</div><div class="line">                <span class="attr">update</span>: <span class="function">(<span class="params">seq, partPer, partBias</span>) =&gt;</span> &#123;</div><div class="line">                    camera.position.set(<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>);</div><div class="line">                    camera.lookAt(mesh1.position);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">        ]</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// APP LOOP</span></div><div class="line">    <span class="keyword">const</span> fps_update = <span class="number">30</span>,</div><div class="line">    fps_movement = <span class="number">30</span>;</div><div class="line">    <span class="keyword">let</span> lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">        secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">        requestAnimationFrame(loop);</div><div class="line">        <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / fps_update)&#123;</div><div class="line">            <span class="comment">// update by hooks</span></div><div class="line">            seqHooks.setFrame(seq, seq.frame, seq.frameMax);</div><div class="line">            renderer.render(scene, camera);</div><div class="line">            seq.frame += fps_movement * secs;</div><div class="line">            seq.frame %= seq.frameMax;</div><div class="line">            lt = now;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    loop();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This is looking good so far and I think that I will be using this in place of a similar module that I made before hand that I have been using to make my videos thus far. With that sequence module I have found that there are a few features that I should have in a module such as this that I now have which is great. Mainly it was the before and after objects hooks that I wanted to have the most, but a few more ideas came up that I think I will be using now and then for future video projects.</p>
<p>I am sure that I will end up running into other problems that might result in me wanting to have just a few more additional features on top of what I am working with all ready here with this module. So at some point in the future I will likely make another revision of this module, or maybe a whole other project based off of what I worked out here.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/" data-id="cle059vg103c1dwv1zkbpnig4" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/three-js/">three.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/05/17/threejs-vector3-lerp/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Linear lerping with the Vector3 lerp method
        
      </div>
    </a>
  
  
    <a href="/2022/05/09/threejs-box3/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">The Box3 class in threejs.</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/index.html';
    this.page.identifier = '986';
    this.page.title = 'threejs example using a sequence module with hooks';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 15.45px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.64px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13.64px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.82px;">express</a> <a href="/tags/games/" style="font-size: 17.27px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.55px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.73px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.64px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.55px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.91px;">python</a> <a href="/tags/statistics/" style="font-size: 14.09px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19.09px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16.36px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/10/threejs-curves-cubicbeziercurve3/">Cubic Bezier Curves in threejs</a>
          </li>
        
          <li>
            <a href="/2023/02/03/threejs-buffer-geometry-morph-attributes/">Morph Attributes of buffer geometry objects</a>
          </li>
        
          <li>
            <a href="/2023/01/27/threejs-examples-house-two/">House Model two threejs project example</a>
          </li>
        
          <li>
            <a href="/2023/01/20/threejs-buffer-geometry-attributes-color/">Material Vertex Color and the buffer geometry attribute used for doing so</a>
          </li>
        
          <li>
            <a href="/2023/01/13/threejs-shader-material/">The shader material in threejs and getting started with a little GLSL</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas</a>
  
    <a href="https://www.youtube.com/user/javaweaver" class="mobile-nav-link">Youtube</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2022/05/12/threejs-examples-sequence-hooks/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>