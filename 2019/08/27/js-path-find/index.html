<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>Path finding with javaScript | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2019/08/27/js-path-find/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="In javaScript path finding is a subject that will come up when making certain games and projects that require finding a path from one cell position to another in a 2d grid typically. It is a major par">
<meta property="og:type" content="article">
<meta property="og:title" content="Path finding with javaScript">
<meta property="og:url" content="https://dustinpfister.github.io/2019/08/27/js-path-find/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="In javaScript path finding is a subject that will come up when making certain games and projects that require finding a path from one cell position to another in a 2d grid typically. It is a major par">
<meta property="og:updated_time" content="2021-10-07T21:53:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Path finding with javaScript">
<meta name="twitter:description" content="In javaScript path finding is a subject that will come up when making certain games and projects that require finding a path from one cell position to another in a 2d grid typically. It is a major par">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas-Examples</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-js-path-find" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/27/js-path-find/" class="article-date"> Published:
  <time datetime="2019-08-27T16:42:00.000Z" itemprop="datePublished">2019-08-27</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2019/08/27/js-path-find/" class="article-date"> Modified:
  <time datetime="2021-10-07T21:53:27.000Z" itemprop="dateModified">2021-10-07</time>
</a>

    <span class="article-date">V1.45</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Path finding with javaScript
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>In javaScript <a href="https://en.wikipedia.org/wiki/Pathfinding" target="_blank" rel="external">path finding</a> is a subject that will come up when making certain games and projects that require finding a path from one cell position to another in a 2d grid typically. It is a major part of game development when it comes to any style of game that requires such methods, as well as any kind of practical application also. </p>
<p>There are many game frameworks that might have this built in, there are also well know javaScript dependencies such as <a href="https://github.com/qiao/PathFinding.js/" target="_blank" rel="external">pathfinding.js</a> that <a href="https://qiao.github.io/PathFinding.js/visual/" target="_blank" rel="external">can be used</a> to make quick work of this aspect of javaScript Game development by making it part of the applications dependences.</p>
<p>However pathfinding.js is a little bloated, it comes with a collection of methods for path finding rather than just one tired yet true solution. It is also true that pathfinding.js no longer appears to be supported, which is not always such a bad thing mind you. It is true that if something is not broken there might very well not be a need to fix it after all, that sort of things happens now and then and that might very well be the case with pathinging.js. </p>
<p>Still there might be a need to work out a custom solution for path finding for a number of other reasons that might come up, including just making something that is a little lighter, so in this post I will be writing about making a custom path finding method in javaScript. I have not tested this solution extensively, but it is based off of what I have studied in pathfinder.js, and in any case it should still serve as a decent starting point for this sort of thing.</p>
<a id="more"></a>
<h2 id="1-Path-finding-and-what-to-know-first"><a href="#1-Path-finding-and-what-to-know-first" class="headerlink" title="1 - Path finding and what to know first"></a>1 - Path finding and what to know first</h2><p>This is a post on the subject of path finding in a javaScript environment. This is not in any way a kind of <a href="/2018/11/27/js-getting-started/">getting started type post on javaScript in general</a> in the browser, or <a href="/2017/04/05/nodejs-helloworld/">nodejs</a>, so I assume that you have some background when it comes to javaScript programing. Also there is some more that you show be aware of when it comes to some things that might be required before working out things with path finding such as working out some kind of grid or map module to begin with.</p>
<h3 id="1-1-The-score-code-examples-here-are-on-my-github-account"><a href="#1-1-The-score-code-examples-here-are-on-my-github-account" class="headerlink" title="1.1 - The score code examples here are on my github account"></a>1.1 - The score code examples here are on my github account</h3><p>On github I have my test vjs repository which is where I park all my source code examples for blog posts such as this on javaScript in general. The source code examples for this post can be found in the <a href="https://github.com/dustinpfister/test_vjs/tree/master/for_post/js-path-find" target="_blank" rel="external">for post folder for this post on path detection</a> in that repository. I get around to editing my older posts on javaScript now and then and this post is no exception, so the latest state of the examples are there. In the event that something seems wrong with the source code that would also be where to go about making a pull request.</p>
<h3 id="1-2-Might-want-to-come-up-with-some-kind-of-grid-module-first"><a href="#1-2-Might-want-to-come-up-with-some-kind-of-grid-module-first" class="headerlink" title="1.2 - Might want to come up with some kind of grid module first"></a>1.2 - Might want to come up with some kind of grid module first</h3><p>Before getting into path finding I will first need some kind of <a href="/2021/08/20/js-javascript-example-grid-module">Grid module</a>. There are a bunch of ways of going about making this kind of module, however just about any gird module will consist of a 2d collection of objects in one form or another.</p>
<h2 id="2-Vanilla-js-path-find-solution-example-for-nodejs"><a href="#2-Vanilla-js-path-find-solution-example-for-nodejs" class="headerlink" title="2 - Vanilla js path find solution example for nodejs"></a>2 - Vanilla js path find solution example for nodejs</h2><p>In this section I will be writing about my own js path fining solution that I put together after studying the source code of the PathFinding.js repository at github. I have not battle tested this, but the basic idea seems to work okay so far for what it is worth. </p>
<p>The solution makes use of a grid that is created by another dependency that I am also going to go over in this section that has to do with creating and working with a Grid. Creating a Grid module is a whole other can of worms when it comes to javaScript projects that require this sort of module, but is also closely related to path finding so the two things need to work out okay with each other. So lets start out with the grid module and then get into the path finding solution for this section.</p>
<h3 id="2-1-Grid-module"><a href="#2-1-Grid-module" class="headerlink" title="2.1 - Grid module"></a>2.1 - Grid module</h3><p>First off I need some kind of grid module, or at least decide on some kind of standard format for a grid. So then I worked out a module that will have a Class for what a single Node or tile if you prefer in a Grid, and of course a Grid class. I also worked out a number of other useful methods that I will want for this kind of module when it comes to making a path finding method of some kind. For example there is having a method that will return all of the nodes that border a given node which is an impotent first step for this sort of thing.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Node Constructor</span></div><div class="line"><span class="keyword">var</span> Node = exports.Node = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> opt = opt || &#123;&#125;;</div><div class="line">    <span class="keyword">this</span>.x = opt.x;</div><div class="line">    <span class="keyword">this</span>.y = opt.y;</div><div class="line">    <span class="keyword">this</span>.i = opt.i;</div><div class="line">    <span class="keyword">this</span>.walkable = opt.walkable === <span class="literal">undefined</span> ? <span class="literal">true</span> : opt.walkable;</div><div class="line">    <span class="keyword">this</span>.ti = opt.ti || <span class="number">0</span>; <span class="comment">// tile index used to skin the tile</span></div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// Main Grid Constructor</span></div><div class="line"><span class="keyword">var</span> Grid = exports.Grid = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">    opt = opt || &#123;&#125;;</div><div class="line">    <span class="keyword">this</span>.w = opt.w || <span class="number">8</span>;</div><div class="line">    <span class="keyword">this</span>.h = opt.h || <span class="number">6</span>;</div><div class="line">    <span class="keyword">this</span>.nodes = [];</div><div class="line">    <span class="keyword">this</span>.buildCleanNodes();</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// FromMatrix static method can be used to clone a Grid</span></div><div class="line">Grid.fromMatrix = <span class="function"><span class="keyword">function</span> (<span class="params">matrix</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> grid = <span class="keyword">new</span> Grid(&#123;</div><div class="line">            <span class="attr">w</span>: matrix[<span class="number">0</span>].length,</div><div class="line">            <span class="attr">h</span>: matrix.length</div><div class="line">        &#125;);</div><div class="line">    <span class="keyword">var</span> y = <span class="number">0</span>,</div><div class="line">    x,</div><div class="line">    m;</div><div class="line">    <span class="keyword">while</span> (y &lt; grid.h) &#123;</div><div class="line">        x = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (x &lt; grid.w) &#123;</div><div class="line">            m = matrix[y][x];</div><div class="line">            grid.nodes[y][x] = <span class="keyword">new</span> Node(&#123;</div><div class="line">                    <span class="attr">x</span>: x,</div><div class="line">                    <span class="attr">y</span>: y,</div><div class="line">                    <span class="attr">i</span>: y * grid.w + x,</div><div class="line">                    <span class="attr">walkable</span>: m.walkable,</div><div class="line">                    <span class="attr">ti</span>: m.ti || <span class="number">0</span></div><div class="line">                &#125;);</div><div class="line">            x += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        y += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> grid;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// just build a clean array of nodes for the gird</span></div><div class="line">Grid.prototype.buildCleanNodes = <span class="function"><span class="keyword">function</span> (<span class="params">ti</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.nodes = [];</div><div class="line">    <span class="keyword">var</span> y = <span class="number">0</span>,</div><div class="line">    x,</div><div class="line">    row;</div><div class="line">    ti = ti === <span class="literal">undefined</span> ? <span class="number">0</span> : ti;</div><div class="line">    <span class="keyword">while</span> (y &lt; <span class="keyword">this</span>.h) &#123;</div><div class="line">        x = <span class="number">0</span>;</div><div class="line">        row = [];</div><div class="line">        <span class="keyword">while</span> (x &lt; <span class="keyword">this</span>.w) &#123;</div><div class="line">            row.push(<span class="keyword">new</span> Node(&#123;</div><div class="line">                    <span class="attr">x</span>: x,</div><div class="line">                    <span class="attr">y</span>: y,</div><div class="line">                    <span class="attr">i</span>: y * <span class="keyword">this</span>.w + x,</div><div class="line">                    <span class="attr">walkable</span>: <span class="literal">true</span>,</div><div class="line">                    <span class="attr">ti</span>: ti</div><div class="line">                &#125;));</div><div class="line">            x += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.nodes.push(row);</div><div class="line">        y += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.nodes;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// return true if the given x and y position is in bounds</span></div><div class="line">Grid.prototype.isInBounds = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="keyword">this</span>.w) &amp;&amp; (y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="keyword">this</span>.h);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">Grid.prototype.isWalkable = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isInBounds(x, y)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.nodes[y][x].walkable;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// get the four Neighbors of a node</span></div><div class="line">Grid.prototype.getNeighbors = <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> x = node.x,</div><div class="line">    y = node.y,</div><div class="line">    neighbors = [];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isWalkable(x, y - <span class="number">1</span>)) &#123;</div><div class="line">        neighbors.push(<span class="keyword">this</span>.nodes[y - <span class="number">1</span>][x]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isWalkable(x, y + <span class="number">1</span>)) &#123;</div><div class="line">        neighbors.push(<span class="keyword">this</span>.nodes[y + <span class="number">1</span>][x]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isWalkable(x - <span class="number">1</span>, y)) &#123;</div><div class="line">        neighbors.push(<span class="keyword">this</span>.nodes[y][x - <span class="number">1</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isWalkable(x + <span class="number">1</span>, y)) &#123;</div><div class="line">        neighbors.push(<span class="keyword">this</span>.nodes[y][x + <span class="number">1</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> neighbors;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-2-Path-finder-Module"><a href="#2-2-Path-finder-Module" class="headerlink" title="2.2 - Path finder Module"></a>2.2 - Path finder Module</h3><p>Here is the actual pathfinder module that I worked out bases very loosely on the <a href="https://github.com/qiao/PathFinding.js/blob/master/src/finders/AStarFinder.js" target="_blank" rel="external">AStarFinder method of pathfinding.js</a> with many changes. The basic idea of any path finding method is to start at one node location of a grid, get the neighboring nodes, and then find which node would be the best option to move to next. This process is then repeated until a path to an end node is obtained or it is found that getting there is not possible.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Grid = <span class="built_in">require</span>(<span class="string">'./grid.js'</span>).Grid;</div><div class="line"> </div><div class="line"><span class="comment">// sort a list of open nodes</span></div><div class="line"><span class="keyword">var</span> sortOpen = <span class="function"><span class="keyword">function</span> (<span class="params">open</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> open.sort(<span class="function"><span class="keyword">function</span> (<span class="params">nodeA, nodeB</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (nodeA.weight &lt; nodeB.weight) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (nodeA.weight &gt; nodeB.weight) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// set weight for a node</span></div><div class="line"><span class="keyword">var</span> setWeight = <span class="function"><span class="keyword">function</span> (<span class="params">endNode, neighbor</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(endNode.x - neighbor.x, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(endNode.y - neighbor.y, <span class="number">2</span>))</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// build a path based an parent property</span></div><div class="line"><span class="keyword">var</span> buildPath = <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> path = [];</div><div class="line">    <span class="keyword">while</span> (node.parent) &#123;</div><div class="line">        path.push([node.x, node.y]);</div><div class="line">        node = node.parent;</div><div class="line">    &#125;</div><div class="line">    path.push([node.x, node.y]);</div><div class="line">    <span class="keyword">return</span> path;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// for Each Neighbor for the given grid, node, and open list</span></div><div class="line"><span class="keyword">var</span> forNeighbors = <span class="function"><span class="keyword">function</span> (<span class="params">grid, node, endNode, open</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> neighbors = grid.getNeighbors(node);</div><div class="line">    <span class="keyword">var</span> ni = <span class="number">0</span>,</div><div class="line">    nl = neighbors.length;</div><div class="line">    <span class="keyword">while</span> (ni &lt; nl) &#123;</div><div class="line">        <span class="keyword">var</span> neighbor = neighbors[ni];</div><div class="line">        <span class="comment">// if the neighbor is closed continue looping</span></div><div class="line">        <span class="keyword">if</span> (neighbor.closed) &#123;</div><div class="line">            ni += <span class="number">1</span>;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// set weight for the neighbor</span></div><div class="line">        neighbor.weight = setWeight(endNode, neighbor);</div><div class="line">        <span class="comment">// if the node is not opened</span></div><div class="line">        <span class="keyword">if</span> (!neighbor.opened) &#123;</div><div class="line">            neighbor.parent = node;</div><div class="line">            open.push(neighbor);</div><div class="line">            neighbor.opened = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        ni += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// Find path from start node to end node</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">givenGrid, sx, sy, ex, ey</span>) </span>&#123;</div><div class="line">    <span class="comment">// copy the given grid</span></div><div class="line">    <span class="keyword">var</span> grid = Grid.fromMatrix(givenGrid.nodes),</div><div class="line">    path = [],</div><div class="line">    open = [],</div><div class="line">    node;</div><div class="line">    <span class="comment">// set startNode and End Node to copy of grid</span></div><div class="line">    <span class="keyword">var</span> startNode = grid.nodes[sy][sx];</div><div class="line">    endNode = grid.nodes[ey][ex];</div><div class="line">    <span class="comment">// push start Node to open list</span></div><div class="line">    open.push(startNode);</div><div class="line">    startNode.opened = <span class="literal">true</span>;</div><div class="line">    startNode.weight = <span class="number">0</span>;</div><div class="line">    <span class="comment">// start walking</span></div><div class="line">    <span class="keyword">while</span> (open.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="comment">// pop out next Node from open list</span></div><div class="line">        node = open.pop();</div><div class="line">        node.closed = <span class="literal">true</span>;</div><div class="line">        <span class="comment">// if the node is the end node</span></div><div class="line">        <span class="keyword">if</span> (node === endNode) &#123;</div><div class="line">            <span class="keyword">return</span> buildPath(node);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// loop current neighbors</span></div><div class="line">        forNeighbors(grid, node, endNode, open);</div><div class="line">        <span class="comment">// sort the list of nodes be weight value to end node</span></div><div class="line">        sortOpen(open);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// return an empty array if we get here (can not get to end node)</span></div><div class="line">    <span class="keyword">return</span> [];</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-3-Helpers"><a href="#2-3-Helpers" class="headerlink" title="2.3 - Helpers"></a>2.3 - Helpers</h3><p>So then I worked out some additional code to help with things like printing the state of a grid to the standard output of the console in a node project. In this library I am using my find path module to get an array of node positions for a set path, and then drawing that.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> findPath = <span class="built_in">require</span>(<span class="string">'./find-path.js'</span>),</div><div class="line">os = <span class="built_in">require</span>(<span class="string">'os'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// print a grid</span></div><div class="line">exports.print = <span class="function">(<span class="params">grid</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">var</span> tiles = [<span class="string">'.'</span>, <span class="string">'+'</span>, <span class="string">'S'</span>, <span class="string">'E'</span>, <span class="string">'#'</span>];</div><div class="line">    grid.nodes.forEach(<span class="function">(<span class="params">row</span>) =&gt;</span> &#123;</div><div class="line">        row.forEach(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</div><div class="line">            process.stdout.write(tiles[node.ti]);</div><div class="line">        &#125;);</div><div class="line">        process.stdout.write(os.EOL);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// set the tile index value for the given path</span></div><div class="line">exports.setTileIndexValuesforPath = <span class="function">(<span class="params">grid, path, ti</span>) =&gt;</span> &#123;</div><div class="line">    ti = ti === <span class="literal">undefined</span> ? <span class="number">0</span> : ti;</div><div class="line">    path.forEach(<span class="function">(<span class="params">pt</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">let</span> node = grid.nodes[pt[<span class="number">1</span>]][pt[<span class="number">0</span>]];</div><div class="line">        node.ti = ti;</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// set the start and end point tile locations</span></div><div class="line">exports.setStartEnd = <span class="function">(<span class="params">grid, sx, sy, ex, ey</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> startNode = grid.nodes[sy][sx],</div><div class="line">    endNode = grid.nodes[ey][ex],</div><div class="line">    <span class="comment">//p = grid.findPath(startNode, endNode);</span></div><div class="line">    p = findPath(grid, sx, sy, ex, ey);</div><div class="line">    <span class="keyword">this</span>.setTileIndexValuesforPath(grid, p, <span class="number">1</span>);</div><div class="line">    startNode.ti = <span class="number">2</span>;</div><div class="line">    endNode.ti = <span class="number">3</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-4-Using-the-lib"><a href="#2-4-Using-the-lib" class="headerlink" title="2.4 - Using the lib"></a>2.4 - Using the lib</h3><p>So now that I have my grid library and by path finder worked out I can now work out some examples that make use of it. So then I worked out a few test scripts to see if things work they way that they should more or less with this.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Grid = <span class="built_in">require</span>(<span class="string">'./grid/grid.js'</span>).Grid,</div><div class="line">helpers = <span class="built_in">require</span>(<span class="string">'./grid/helpers.js'</span>);</div><div class="line"> </div><div class="line"><span class="keyword">let</span> g = <span class="keyword">new</span> Grid(&#123;</div><div class="line">        <span class="attr">w</span>: <span class="number">40</span>,</div><div class="line">        <span class="attr">h</span>: <span class="number">8</span></div><div class="line">    &#125;);</div><div class="line"> </div><div class="line">helpers.setStartEnd(g, <span class="number">0</span>, <span class="number">0</span>, <span class="number">35</span>, <span class="number">7</span>);</div><div class="line">helpers.print(g);</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Grid = <span class="built_in">require</span>(<span class="string">'./grid/grid.js'</span>).Grid,</div><div class="line">findPath = <span class="built_in">require</span>(<span class="string">'./grid/find-path.js'</span>),</div><div class="line">helpers = <span class="built_in">require</span>(<span class="string">'./grid/helpers.js'</span>);</div><div class="line"> </div><div class="line"><span class="keyword">let</span> g = Grid.fromMatrix([</div><div class="line">    [&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">false</span>,<span class="attr">ti</span>: <span class="number">4</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;],</div><div class="line">    [&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">false</span>,<span class="attr">ti</span>: <span class="number">4</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">false</span>,<span class="attr">ti</span>: <span class="number">4</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;],</div><div class="line">    [&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;],</div><div class="line">    [&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">false</span>,<span class="attr">ti</span>: <span class="number">4</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;,&#123;<span class="attr">walkable</span>: <span class="literal">true</span>,<span class="attr">ti</span>: <span class="number">0</span>&#125;],</div><div class="line">]);</div><div class="line"> </div><div class="line">helpers.setStartEnd(g, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">helpers.print(g);</div></pre></td></tr></table></figure>
<p>When I call this script form the command line I have a path from the start to end location. So it would seem that the module works okay. However I would want to do a fair amount of more testing, and I am not fully happy with how the source code looks. However I think that when it comes to really making this kind of project I will want to make it a little more front end friendly actually.</p>
<h2 id="3-Client-side-javaScript-and-canvas"><a href="#3-Client-side-javaScript-and-canvas" class="headerlink" title="3 - Client side javaScript and canvas"></a>3 - Client side javaScript and canvas</h2><p>I Worked out a nodejs solution that seems to work okay, now I will just want to make another one that will work with canvas in client side javaScript. Also while I am at it I might do a few things a little different while I am at it as I am still trying to find out what would be a good grid module for me. So then in this section I will be going over the full source code of the canvas project that I have made for this post. </p>
<h3 id="3-1-The-utils-module"><a href="#3-1-The-utils-module" class="headerlink" title="3.1 - The utils module"></a>3.1 - The utils module</h3><p>First off for this canvas example I have a general utilities library as its the case with just about all my other canvas examples and projects. For a good idea of what this kind of module is all about you might want to check out my <a href="/2021/08/06/js-javascript-example-utils/">javaScript example post on a general utilities library</a>. The basic idea is to just have a library where I can park various methods that I will want to use in one or more other files, and I can not thing of any other pace to park them for the moment.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> utils = &#123;&#125;;</div><div class="line"><span class="comment">// bounding box</span></div><div class="line">utils.boundingBox = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, w1, h1, x2, y2, w2, h2</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> !(</div><div class="line">        (y1 + h1) &lt; y2 ||</div><div class="line">        y1 &gt; (y2 + h2) ||</div><div class="line">        (x1 + w1) &lt; x2 ||</div><div class="line">        x1 &gt; (x2 + w2));</div><div class="line">&#125;;</div><div class="line"><span class="comment">// depp clone</span></div><div class="line">utils.deepCloneJSON = <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</div><div class="line">&#125;;</div><div class="line"><span class="comment">// create a canvas element</span></div><div class="line">utils.createCanvas = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">    opt = opt || &#123;&#125;;</div><div class="line">    opt.container = opt.container || <span class="built_in">document</span>.getElementById(<span class="string">'canvas-app'</span>) || <span class="built_in">document</span>.body;</div><div class="line">    opt.canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</div><div class="line">    opt.ctx = opt.canvas.getContext(<span class="string">'2d'</span>);</div><div class="line">    <span class="comment">// assign the 'canvas_example' className</span></div><div class="line">    opt.canvas.className = <span class="string">'canvas_example'</span>;</div><div class="line">    <span class="comment">// set native width</span></div><div class="line">    opt.canvas.width = opt.width === <span class="literal">undefined</span> ? <span class="number">320</span> : opt.width;</div><div class="line">    opt.canvas.height = opt.height === <span class="literal">undefined</span> ? <span class="number">240</span> : opt.height;</div><div class="line">    <span class="comment">// translate by 0.5, 0.5</span></div><div class="line">    opt.ctx.translate(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line">    <span class="comment">// disable default action for onselectstart</span></div><div class="line">    opt.canvas.onselectstart = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// append canvas to container</span></div><div class="line">    opt.container.appendChild(opt.canvas);</div><div class="line">    <span class="keyword">return</span> opt;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// get a canvas relative position that is adjusted for scale</span></div><div class="line">utils.getCanvasRelative = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> canvas = e.target,</div><div class="line">    bx = canvas.getBoundingClientRect(),</div><div class="line">    pos = &#123;</div><div class="line">        <span class="attr">x</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientX : e.clientX) - bx.left,</div><div class="line">        <span class="attr">y</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientY : e.clientY) - bx.top,</div><div class="line">        <span class="attr">bx</span>: bx</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// adjust for native canvas matrix size</span></div><div class="line">    pos.x = <span class="built_in">Math</span>.floor((pos.x / canvas.scrollWidth) * canvas.width);</div><div class="line">    pos.y = <span class="built_in">Math</span>.floor((pos.y / canvas.scrollHeight) * canvas.height);</div><div class="line">    <span class="keyword">return</span> pos;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// create and return a canvas pointer event handler</span></div><div class="line">utils.canvasPointerEventHandler = <span class="function"><span class="keyword">function</span> (<span class="params">state, events</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> pos = utils.getCanvasRelative(e),</div><div class="line">        handler = <span class="literal">null</span>;</div><div class="line">        e.preventDefault();</div><div class="line">        <span class="keyword">if</span> (e.type === <span class="string">'mousedown'</span> || e.type === <span class="string">'touchstart'</span>) &#123;</div><div class="line">            handler = events[<span class="string">'pointerStart'</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (e.type === <span class="string">'mousemove'</span> || e.type === <span class="string">'touchmove'</span>) &#123;</div><div class="line">            handler = events[<span class="string">'pointerMove'</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (e.type === <span class="string">'mouseup'</span> || e.type === <span class="string">'touchend'</span>) &#123;</div><div class="line">            handler = events[<span class="string">'pointerEnd'</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (handler) &#123;</div><div class="line">            handler.call(e, e, pos, state);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// attach canvas pointer events</span></div><div class="line">utils.canvasPointerEvents = <span class="function"><span class="keyword">function</span> (<span class="params">canvas, state, events</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> handler = utils.canvasPointerEventHandler(state, events),</div><div class="line">    options = &#123;</div><div class="line">        <span class="attr">passive</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    canvas.addEventListener(<span class="string">'mousedown'</span>, handler, options);</div><div class="line">    canvas.addEventListener(<span class="string">'mousemove'</span>, handler, options);</div><div class="line">    canvas.addEventListener(<span class="string">'mouseup'</span>, handler, options);</div><div class="line">    canvas.addEventListener(<span class="string">'touchstart'</span>, handler, options);</div><div class="line">    canvas.addEventListener(<span class="string">'touchmove'</span>, handler, options);</div><div class="line">    canvas.addEventListener(<span class="string">'touchend'</span>, handler, options);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="3-2-The-grid-module"><a href="#3-2-The-grid-module" class="headerlink" title="3.2 - The grid module"></a>3.2 - The grid module</h3><p>So then here is my grid module based off of what I made for my javaScript example post on a grid module. It is more or less the same as what I worked out for my node example above, but I just made some changes to the source code of my grid module example to create one that has path finding.</p>
<p>This is a little tricky as the grid module that I made that I wanted to use for this example works by having all the cells, or nodes if you prefer in a single array, rather than an array of arrays. There are many user space libraries, as well as built in javaScript features that use this kind of standard for a 2d matrix. However the older path finding module that I made does not use this kind of standard, so I needed to make a chunk method that will convert one standard to another. In <a href="/2017/09/13/lodash-chunk/">lodash there is a chunk</a> method that would be useful in these kinds of situations, but for this example I would like to stuck to vanilla javaScript only.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// sort a list of open nodes</span></div><div class="line">    <span class="keyword">var</span> sortOpen = <span class="function"><span class="keyword">function</span> (<span class="params">opened</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> opened.sort(<span class="function"><span class="keyword">function</span> (<span class="params">nodeA, nodeB</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (nodeA.weight &lt; nodeB.weight) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (nodeA.weight &gt; nodeB.weight) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// set weight for a node</span></div><div class="line">    <span class="keyword">var</span> setWeight = <span class="function"><span class="keyword">function</span> (<span class="params">endNode, neighbor</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(endNode.cellX - neighbor.cellY, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(endNode.cellY - neighbor.cellY, <span class="number">2</span>))</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// build a path based an parent property</span></div><div class="line">    <span class="keyword">var</span> buildPath = <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> path = [];</div><div class="line">        <span class="keyword">while</span> (node.parent) &#123;</div><div class="line">            path.push([node.cellX, node.cellY]);</div><div class="line">            node = node.parent;</div><div class="line">        &#125;</div><div class="line">        path.push([node.cellX, node.cellY]);</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// for Each Neighbor for the given grid, node, and open list</span></div><div class="line">    <span class="keyword">var</span> forNeighbors = <span class="function"><span class="keyword">function</span> (<span class="params">grid, node, endNode, opened</span>) </span>&#123;</div><div class="line">        <span class="comment">//var neighbors = grid.getNeighbors(node);</span></div><div class="line">        <span class="keyword">var</span> neighbors = gridMod.getNeighbors(grid, node);</div><div class="line">        <span class="keyword">var</span> ni = <span class="number">0</span>,</div><div class="line">        nl = neighbors.length;</div><div class="line">        <span class="keyword">while</span> (ni &lt; nl) &#123;</div><div class="line">            <span class="keyword">var</span> neighbor = neighbors[ni];</div><div class="line">            <span class="comment">// if the neighbor is closed continue looping</span></div><div class="line">            <span class="keyword">if</span> (neighbor.closed) &#123;</div><div class="line">                ni += <span class="number">1</span>;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// set weight for the neighbor</span></div><div class="line">            neighbor.weight = setWeight(endNode, neighbor);</div><div class="line">            <span class="comment">// if the node is not opened</span></div><div class="line">            <span class="keyword">if</span> (!neighbor.opened) &#123;</div><div class="line">                neighbor.parent = node;</div><div class="line">                opened.push(neighbor);</div><div class="line">                neighbor.opened = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            ni += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    api.getPath = <span class="function"><span class="keyword">function</span> (<span class="params">grid, sx, sy, ex, ey</span>) </span>&#123;</div><div class="line">        <span class="comment">// copy the given grid</span></div><div class="line">        <span class="comment">//var grid = Grid.fromMatrix(givenGrid.nodes),</span></div><div class="line">        <span class="keyword">var</span> grid = utils.deepCloneJSON(grid),</div><div class="line">        nodes = api.chunk(grid),</div><div class="line">        path = [],</div><div class="line">        opened = [],</div><div class="line">        node;</div><div class="line">        <span class="comment">// set startNode and End Node to copy of grid</span></div><div class="line">        <span class="keyword">var</span> startNode = nodes[sy][sx];</div><div class="line">        endNode = nodes[ey][ex];</div><div class="line">        <span class="comment">// push start Node to open list</span></div><div class="line">        opened.push(startNode);</div><div class="line">        startNode.opened = <span class="literal">true</span>;</div><div class="line">        startNode.weight = <span class="number">0</span>;</div><div class="line">        <span class="comment">// start walking</span></div><div class="line">        <span class="keyword">while</span> (opened.length &gt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="comment">// pop out next Node from open list</span></div><div class="line">            node = opened.pop();</div><div class="line">            node.closed = <span class="literal">true</span>;</div><div class="line">            <span class="comment">// if the node is the end node</span></div><div class="line">            <span class="keyword">if</span> (node === endNode) &#123;</div><div class="line">                <span class="keyword">return</span> buildPath(node);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// loop current neighbors</span></div><div class="line">            forNeighbors(grid, node, endNode, opened);</div><div class="line">            <span class="comment">// sort the list of nodes be weight value to end node</span></div><div class="line">            sortOpen(opened);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// return an empty array if we get here (can not get to end node)</span></div><div class="line">        <span class="keyword">return</span> [];</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// create a grid object</span></div><div class="line">    api.create = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">var</span> grid = &#123;</div><div class="line">            <span class="attr">cellSelected</span>: <span class="literal">null</span>, <span class="comment">// selected cell ref</span></div><div class="line">            cells: []</div><div class="line">        &#125;;</div><div class="line">        grid.cellSize = opt.cellSize === <span class="literal">undefined</span> ? <span class="number">32</span> : opt.cellSize;</div><div class="line">        grid.w = opt.w === <span class="literal">undefined</span> ? <span class="number">8</span> : opt.w;</div><div class="line">        grid.h = opt.h === <span class="literal">undefined</span> ? <span class="number">8</span> : opt.h;</div><div class="line">        grid.xOffset = opt.xOffset === <span class="literal">undefined</span> ? <span class="number">0</span> : opt.xOffset;</div><div class="line">        grid.yOffset = opt.yOffset === <span class="literal">undefined</span> ? <span class="number">0</span> : opt.yOffset;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>,</div><div class="line">        cell,</div><div class="line">        len = grid.w * grid.h;</div><div class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">            cell = &#123;</div><div class="line">                <span class="attr">i</span>: i, <span class="comment">// store index for this cell</span></div><div class="line">                cellX: i % grid.w, <span class="comment">// grid index pos values as uppercase X, and Y</span></div><div class="line">                cellY: <span class="built_in">Math</span>.floor(i / grid.w),</div><div class="line">                <span class="attr">walkable</span>: <span class="literal">true</span>,</div><div class="line">                <span class="attr">closed</span>: <span class="literal">false</span>,</div><div class="line">                <span class="attr">data</span>: &#123;&#125;</div><div class="line">                <span class="comment">// user data object</span></div><div class="line">            &#125;;</div><div class="line">            <span class="comment">// cell pixel pos values as lowercase x, and y</span></div><div class="line">            cell.x = grid.xOffset + cell.cellX * grid.cellSize;</div><div class="line">            cell.y = grid.yOffset + cell.cellY * grid.cellSize;</div><div class="line">            grid.cells.push(cell);</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> grid;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get method</span></div><div class="line">    api.get = <span class="function"><span class="keyword">function</span> (<span class="params">grid, ix, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">return</span> grid.cells[ix];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> grid.cells[y * grid.w + ix];</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get a cell by the given pixel position</span></div><div class="line">    api.getCellByPixlePos = <span class="function"><span class="keyword">function</span> (<span class="params">grid, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cellX = <span class="built_in">Math</span>.floor((x - grid.xOffset) / grid.cellSize),</div><div class="line">        cellY = <span class="built_in">Math</span>.floor((y - grid.yOffset) / grid.cellSize),</div><div class="line">        cell;</div><div class="line">        <span class="keyword">if</span> (cellX &gt;= <span class="number">0</span> &amp;&amp; cellY &gt;= <span class="number">0</span> &amp;&amp; cellX &lt; grid.w &amp;&amp; cellY &lt; grid.h) &#123;</div><div class="line">            <span class="keyword">return</span> grid.cells[cellY * grid.w + cellX];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// selected cell check</span></div><div class="line">    api.selectedCheck = <span class="function"><span class="keyword">function</span> (<span class="params">grid, x, y, onSelect, onUnselect</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cell = api.getCellByPixlePos(grid, x, y);</div><div class="line">        <span class="keyword">if</span> (cell) &#123;</div><div class="line">            <span class="keyword">if</span> (cell === grid.cellSelected) &#123;</div><div class="line">                onUnselect(cell, grid, x, y);</div><div class="line">                grid.cellSelected = <span class="literal">null</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span> (grid.cellSelected) &#123;</div><div class="line">                    onUnselect(grid.cellSelected, grid, x, y);</div><div class="line">                &#125;</div><div class="line">                grid.cellSelected = cell;</div><div class="line">                onSelect(cell, grid, x, y);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> (grid.cellSelected) &#123;</div><div class="line">                onUnselect(grid.cellSelected, grid, x, y);</div><div class="line">                grid.cellSelected = <span class="literal">null</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get a chunk form of a grid</span></div><div class="line">    api.chunk = <span class="function"><span class="keyword">function</span> (<span class="params">grid</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> arr = [],</div><div class="line">        row,</div><div class="line">        i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; grid.cells.length) &#123;</div><div class="line">            row = grid.cells.slice(i, i + grid.w);</div><div class="line">            arr.push(row);</div><div class="line">            i += grid.w;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> arr;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// return true if the given x and y position is in bounds</span></div><div class="line">    api.isInBounds = <span class="function"><span class="keyword">function</span> (<span class="params">grid, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; grid.w) &amp;&amp; (y &gt;= <span class="number">0</span> &amp;&amp; y &lt; grid.h);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// is the given cell location walkable?</span></div><div class="line">    api.isWalkable = <span class="function"><span class="keyword">function</span> (<span class="params">grid, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (api.isInBounds(grid, x, y)) &#123;</div><div class="line">            <span class="keyword">return</span> api.get(grid, x, y).walkable; <span class="comment">//grid.nodes[y][x].walkable;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get the four Neighbors of a node</span></div><div class="line">    api.getNeighbors = <span class="function"><span class="keyword">function</span> (<span class="params">grid, node</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> x = node.cellX,</div><div class="line">        y = node.cellY,</div><div class="line">        neighbors = [];</div><div class="line">        <span class="keyword">if</span> (api.isWalkable(grid, x, y - <span class="number">1</span>)) &#123;</div><div class="line">            <span class="comment">//neighbors.push(this.nodes[y - 1][x]);</span></div><div class="line">            neighbors.push(gridMod.get(grid, x, y - <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (api.isWalkable(grid, x, y + <span class="number">1</span>)) &#123;</div><div class="line">            <span class="comment">//neighbors.push(this.nodes[y + 1][x]);</span></div><div class="line">            neighbors.push(gridMod.get(grid, x, y + <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (api.isWalkable(grid, x - <span class="number">1</span>, y)) &#123;</div><div class="line">            <span class="comment">//neighbors.push(this.nodes[y][x - 1]);</span></div><div class="line">            neighbors.push(gridMod.get(grid, x - <span class="number">1</span>, y));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (api.isWalkable(grid, x + <span class="number">1</span>, y)) &#123;</div><div class="line">            <span class="comment">//neighbors.push(this.nodes[y][x + 1]);</span></div><div class="line">            neighbors.push(gridMod.get(grid, x + <span class="number">1</span>, y));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> neighbors;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">    (<span class="keyword">this</span>[<span class="string">'gridMod'</span>] = &#123;&#125;))</div></pre></td></tr></table></figure>
<h3 id="3-3-The-draw-module"><a href="#3-3-The-draw-module" class="headerlink" title="3.3 - The draw module"></a>3.3 - The draw module</h3><p>So then because this is a canvas project I often have a stand alone file for a few draw methods. I did not do much when it comes to this file for the project though, I just wanted a draw background method, and of course a method to draw the current state of a grid.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> draw = &#123;&#125;;</div><div class="line"><span class="comment">// draw a background</span></div><div class="line">draw.background = <span class="function"><span class="keyword">function</span> (<span class="params">sm, ctx, canvas</span>) </span>&#123;</div><div class="line">    ctx.fillStyle = <span class="string">'black'</span>;</div><div class="line">    ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// draw the given grid object</span></div><div class="line">draw.grid = <span class="function"><span class="keyword">function</span> (<span class="params">grid, ctx, canvas</span>) </span>&#123;</div><div class="line">    grid.cells.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">cell</span>) </span>&#123;</div><div class="line">        ctx.fillStyle = cell.data.fillStyle || <span class="string">'white'</span>;</div><div class="line">        ctx.fillRect(cell.x, cell.y, grid.cellSize, grid.cellSize);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="3-4-The-main-javaScript-file"><a href="#3-4-The-main-javaScript-file" class="headerlink" title="3.4 - The main javaScript file"></a>3.4 - The main javaScript file</h3><p>Now I just need a little more javaScript code to test out that my grid module with a find path method is working okay. When it comes to my main javaScript file for this canvas example of path detection I started out by creating an main state machine object, that loosely follows one of the many standards that I have made for these sorts of things. When doing so I have a grid property of the state machine object, and as you would expect I am using the create method of my grid module to create a grid to use for this example.</p>
<p>I am then testing out the get path method of the grid module right away, and using the returned path to set the fill style color of cells.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sm = &#123;</div><div class="line">    <span class="attr">secs</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">fps</span>: <span class="number">30</span>,</div><div class="line">    <span class="attr">lt</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    <span class="attr">canvasObj</span>: utils.createCanvas(&#123;</div><div class="line">        <span class="attr">width</span>: <span class="number">640</span>,</div><div class="line">        <span class="attr">height</span>: <span class="number">480</span></div><div class="line">    &#125;),</div><div class="line">    <span class="attr">grid</span>: gridMod.create(&#123;</div><div class="line">        <span class="attr">xOffset</span>: <span class="number">32</span>,</div><div class="line">        <span class="attr">yOffset</span>: <span class="number">32</span></div><div class="line">    &#125;),</div><div class="line">    <span class="attr">currentState</span>: <span class="string">'game'</span>,</div><div class="line">    <span class="attr">states</span>: &#123;&#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(gridMod.chunk(sm.grid));</div><div class="line"><span class="built_in">console</span>.log(gridMod.get(sm.grid, <span class="number">2</span>, <span class="number">2</span>));</div><div class="line"><span class="built_in">console</span>.log(gridMod.getNeighbors(sm.grid, gridMod.get(sm.grid, <span class="number">0</span>, <span class="number">0</span>)));</div><div class="line"> </div><div class="line"><span class="comment">//var path = gridMod.getPath(sm.grid, 0, 0, 2, 0); // ???</span></div><div class="line"><span class="keyword">var</span> path = gridMod.getPath(sm.grid, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>);</div><div class="line"> </div><div class="line">path.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">pos</span>) </span>&#123;</div><div class="line">    <span class="comment">//console.log(pos);</span></div><div class="line">    <span class="keyword">var</span> cell = gridMod.get(sm.grid, pos[<span class="number">0</span>], pos[<span class="number">1</span>]);</div><div class="line">    cell.data.fillStyle = <span class="string">'lime'</span>;</div><div class="line">    <span class="built_in">console</span>.log(cell);</div><div class="line"> </div><div class="line">&#125;)</div><div class="line"> </div><div class="line"><span class="keyword">var</span> onSelected = <span class="function"><span class="keyword">function</span> (<span class="params">cell, grid, x, y</span>) </span>&#123;</div><div class="line">    cell.data.fillStyle = <span class="string">'red'</span>;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> onUnselected = <span class="function"><span class="keyword">function</span> (<span class="params">cell, grid, x, y</span>) </span>&#123;</div><div class="line">    cell.data.fillStyle = <span class="string">'white'</span>;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// game state</span></div><div class="line">sm.states.game = &#123;</div><div class="line">    <span class="attr">update</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm, secs</span>) </span>&#123;&#125;,</div><div class="line">    <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm, ctx, canvas</span>) </span>&#123;</div><div class="line">        draw.background(sm, ctx, canvas);</div><div class="line">        draw.grid(sm.grid, ctx, canvas);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">events</span>: &#123;</div><div class="line">        <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;</div><div class="line">            gridMod.selectedCheck(sm.grid, pos.x, pos.y, onSelected, onUnselected);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">pointerMove</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;&#125;,</div><div class="line">        <span class="attr">pointerEnd</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;&#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">utils.canvasPointerEvents(sm.canvasObj.canvas, sm, &#123;</div><div class="line">    <span class="attr">pointerStart</span>: <span class="function"><span class="keyword">function</span> (<span class="params">e, pos, sm</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> state = sm.states[sm.currentState];</div><div class="line">        <span class="keyword">var</span> handler = state.events[<span class="string">'pointerStart'</span>];</div><div class="line">        <span class="keyword">if</span> (handler) &#123;</div><div class="line">            handler.call(e, e, pos, sm);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line"><span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - sm.lt) / <span class="number">1000</span>,</div><div class="line">    state = sm.states[sm.currentState];</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span> (secs &gt;= <span class="number">1</span> / sm.fps) &#123;</div><div class="line">        state.update(sm, secs);</div><div class="line">        state.draw(sm, sm.canvasObj.ctx, sm.canvasObj.canvas);</div><div class="line">        sm.lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">loop();</div></pre></td></tr></table></figure>
<p>So then when this example is up and running I get a path of grid cells between that start and end cell locations of the grid. For the most path it would seem that the grid module works okay, but there are a few times where a weird path happens. My best guess as to what i could do to fix that would be to just try to get a better weight system that would be used to make choices as to what direction to go in. I could standard to do a little more testing, and I would like to work out some ore canvas examples that make use of this kind of system as a way to help make it a little more battle tested.</p>
<h2 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4 - Conclusion"></a>4 - Conclusion</h2><p>So that is it for now at least when it comes to path finding and javaScript in general. There is much more to write about when it comes to this topic though of course. I have got around to working out two examples thus far that will work in nodejs, as well as in client side javaScript when it comes to doing something with a canvas element which is great. However it would seem that the module might need a little more work when it comes to how the choices are made, it will take some weird paths with certain combinations it would seem. However when I started working on this I did not want to make something that will be flawless, I just wanted something that works okay at least and it would seem that is what I have thus far.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2019/08/27/js-path-find/" data-id="ckx9e2emv00xg3kv1cw456zbg" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2019/08/27/js-path-find/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/09/01/lodash_isempty/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          The lodash is empty object method for finding out if an object is empty or not
        
      </div>
    </a>
  
  
    <a href="/2019/08/21/canvas-example-space-shooter/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">A Canvas Example that is a basic Space Shooter game</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2019/08/27/js-path-find/index.html';
    this.page.identifier = '528';
    this.page.title = 'Path finding with javaScript';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 14.55px;">blog</a> <a href="/tags/canvas/" style="font-size: 19.09px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/express/" style="font-size: 16.36px;">express</a> <a href="/tags/games/" style="font-size: 16.82px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.09px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.27px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.18px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.09px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 17.73px;">phaser</a> <a href="/tags/python/" style="font-size: 15.45px;">python</a> <a href="/tags/statistics/" style="font-size: 13.64px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 18.64px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 15.91px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/10/js-javascript-example-turn-based-rpg/">Making a turn based RPG game javaScript project example</a>
          </li>
        
          <li>
            <a href="/2021/12/03/threejs-examples-menus/">Menus and crude state machine threejs example</a>
          </li>
        
          <li>
            <a href="/2021/11/26/linux-tar/">The Linux tar command for compressions files and folders</a>
          </li>
        
          <li>
            <a href="/2021/11/23/linux-tree/">The Linux tree command</a>
          </li>
        
          <li>
            <a href="/2021/11/19/linux-xxd/">The Linux xxd command for dumping hex to the standard output rather than text</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas-Examples</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2019/08/27/js-path-find/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>