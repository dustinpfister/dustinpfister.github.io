<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>An express text editor example | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2019/05/01/express-example-text-editor/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I want to write a few posts on express examples that are actual full working application examples, rather than just simple hello world type examples. There is of course the typical todo app that is of">
<meta property="og:type" content="article">
<meta property="og:title" content="An express text editor example">
<meta property="og:url" content="https://dustinpfister.github.io/2019/05/01/express-example-text-editor/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="I want to write a few posts on express examples that are actual full working application examples, rather than just simple hello world type examples. There is of course the typical todo app that is of">
<meta property="og:updated_time" content="2019-05-08T02:08:13.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="An express text editor example">
<meta name="twitter:description" content="I want to write a few posts on express examples that are actual full working application examples, rather than just simple hello world type examples. There is of course the typical todo app that is of">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-express-example-text-editor" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/01/express-example-text-editor/" class="article-date"> Published:
  <time datetime="2019-05-01T10:24:00.000Z" itemprop="datePublished">2019-05-01</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2019/05/01/express-example-text-editor/" class="article-date"> Modified:
  <time datetime="2019-05-08T02:08:13.000Z" itemprop="dateModified">2019-05-07</time>
</a>

    <span class="article-date">V1.21</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/express/">express</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      An express text editor example
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>I want to write a few posts on <a href="/2019/04/30/express-example/">express examples</a> that are actual full working application examples, rather than just simple hello world type examples. There is of course the typical todo app that is often the case, but I want to make a few more that go beyond that into other examples as well. As of late I have been transitioning from using windows to linux, and so far have been having a hard time finding a text editor that stacks up to notepad++ which I have grown accustomed to in windows. So why not make my own text editor on top of node.js, and express that I can take with me to any operating system that I can get node.js installed on? Sounds like a good idea to me compared to being dependent on a windows exclusive app, so I put together a quick basic <a href="https://expressjs.com/" target="_blank" rel="external">expressjs</a> powered text editor example.</p>
<a id="more"></a>
<h2 id="1-What-to-know-about-this-Express-Example-before-hand"><a href="#1-What-to-know-about-this-Express-Example-before-hand" class="headerlink" title="1 - What to know about this Express Example before hand"></a>1 - What to know about this Express Example before hand</h2><p>For the sake of this post I am thinking more in terms of an express example that is starting to look like an actual project of one sort or another rather than a more basic example. If you are new to express you might want to start with my getting started post on express, and also my main post on express as well. I also assume that you have loged a fair amount of time playing around with javaScript and node.js in general, I will not be getting into that or anything else that is outside the scope of this post.</p>
<h3 id="1-1-Setup"><a href="#1-1-Setup" class="headerlink" title="1.1 - Setup"></a>1.1 - Setup</h3><p>For this project I am just using express when it comes to node.js dependencies, and I am just using a vanilla js client system. In the root of the project folder I have a folder for <a href="/2018/06/15/express-middleware/">express middleware</a>, and a public folder for all assets the compose the client system. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ mkdir express-example-text-editor</div><div class="line">$ cd express-example-text-editor</div><div class="line">$ npm init</div><div class="line">$ npm install express@4.16.4 --save</div><div class="line">$ mkdir middleware</div><div class="line">$ mkdir public</div><div class="line">$ cd public</div><div class="line">$ mkdir html</div><div class="line">$ mkdir js</div></pre></td></tr></table></figure>
<h2 id="2-The-app-js-file"><a href="#2-The-app-js-file" class="headerlink" title="2 - The /app.js file"></a>2 - The /app.js file</h2><p>So in the main app.js file in the root of the project folder I am just using express to create an instance of an app object. I am also using the built in <a href="/2017/12/27/nodejs-paths/">path module</a> as well here. The <a href="/2019/04/18/express-set/">app.set</a> method is then used to set some application settings for port, the current working directory and so forth. I then use <a href="/2018/05/24/express-static/">express static</a> to host static assets in the public folder that will compose the client system, and I am also using the built in <a href="/2018/05/27/express-body-parser/">body parser</a> middleware to parse incoming json from the client system as well.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>),</div><div class="line">path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">app = express();</div><div class="line"> </div><div class="line">app.set(<span class="string">'dir'</span>, process.cwd());</div><div class="line">app.set(<span class="string">'fn'</span>, <span class="string">'newfile.txt'</span>);</div><div class="line"> </div><div class="line">app.set(<span class="string">'port'</span>, process.argv[<span class="number">2</span>] || process.env.PORT || <span class="number">8080</span>);</div><div class="line">app.set(<span class="string">'dir_mw'</span>, path.resolve(<span class="string">'./middleware'</span>));</div><div class="line">app.set(<span class="string">'encode'</span>, <span class="string">'utf8'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// hosting static assets for the client system</span></div><div class="line">app.use(<span class="string">'/js'</span>, express.static(<span class="string">'public/js'</span>));</div><div class="line">app.use(<span class="string">'/'</span>, express.static(<span class="string">'public/html'</span>));</div><div class="line"> </div><div class="line"><span class="comment">// body parser</span></div><div class="line">app.use(<span class="built_in">require</span>(<span class="string">'body-parser'</span>).json());</div><div class="line"> </div><div class="line"><span class="comment">// singe middleware that responds to post requests</span></div><div class="line">app.post(<span class="string">'/data'</span>,</div><div class="line">    [</div><div class="line">        <span class="comment">// check body</span></div><div class="line">        <span class="built_in">require</span>(path.join(app.get(<span class="string">'dir_mw'</span>), <span class="string">'check_body.js'</span>)),</div><div class="line">        <span class="comment">// actions</span></div><div class="line">        <span class="built_in">require</span>(path.join(app.get(<span class="string">'dir_mw'</span>), <span class="string">'action_open.js'</span>)),</div><div class="line">        <span class="built_in">require</span>(path.join(app.get(<span class="string">'dir_mw'</span>), <span class="string">'action_save.js'</span>)),</div><div class="line">        <span class="built_in">require</span>(path.join(app.get(<span class="string">'dir_mw'</span>), <span class="string">'action_list.js'</span>)),</div><div class="line">        <span class="comment">// unknown action</span></div><div class="line">        (req, res, next) =&gt; &#123;</div><div class="line">            res.reply.mess = <span class="string">'The action given is not known'</span>;</div><div class="line">            res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">        &#125;</div><div class="line">    ]);</div><div class="line"> </div><div class="line">app.listen(app.get(<span class="string">'port'</span>), () =&gt; <span class="built_in">console</span>.log(<span class="string">'example text editor is up on port: '</span> + app.get(<span class="string">'port'</span>)));</div></pre></td></tr></table></figure>
<p>I am then using a bunch of middleware methods that I have made and placed in my middleware folder. These preform all kinds of actions when it such as getting the current file, saving the current file, and listing the contents of the current directory.</p>
<h2 id="3-The-middleware-folder"><a href="#3-The-middleware-folder" class="headerlink" title="3 - The /middleware folder"></a>3 - The /middleware folder</h2><p>The middleware folder is where I offset much of the logic for getting the current file, saving the current file, and checking for a proper request body and so forth. By breaking things down into fine grain methods and files, it helps to keep things better structured.</p>
<h3 id="3-1-middleware-check-body-js"><a href="#3-1-middleware-check-body-js" class="headerlink" title="3.1 - /middleware/check_body.js"></a>3.1 - /middleware/check_body.js</h3><p>Here I have my body check middleware in this file I am just checking for the presence of a request body, and creating an object that will be a reply for all post requests made from the client system to the path that this middleware is mounted to. In the event that a body is not present a 400 status is sent.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// create reply object, and check for body</span></div><div class="line"><span class="built_in">module</span>.exports = [</div><div class="line"> </div><div class="line">    <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line"> </div><div class="line">        <span class="comment">// Create reply object</span></div><div class="line">        res.reply = &#123;</div><div class="line">            <span class="attr">success</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">mess</span>: <span class="string">'no body object populated.'</span>,</div><div class="line">        &#125;;</div><div class="line"> </div><div class="line">        <span class="comment">// check for body or next</span></div><div class="line">        <span class="keyword">if</span> (!req.body) &#123;</div><div class="line">            res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// sync server side fn and dir settings to any settings given by client</span></div><div class="line">            res.app.set(<span class="string">'fn'</span>, req.body.fn || res.app.get(<span class="string">'fn'</span>));</div><div class="line">            res.app.set(<span class="string">'dir'</span>, path.resolve(req.body.dir || res.app.get(<span class="string">'dir'</span>)));</div><div class="line">            res.reply.fn = res.app.get(<span class="string">'fn'</span>);</div><div class="line">            res.reply.dir = res.app.get(<span class="string">'dir'</span>);</div><div class="line">            <span class="comment">// next middleware</span></div><div class="line">            next();</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line"> </div><div class="line">    <span class="comment">// if no action</span></div><div class="line">    (req, res, next) =&gt; &#123;</div><div class="line">        <span class="comment">// If no action Action, or next</span></div><div class="line">        <span class="keyword">if</span> (!req.body.action) &#123;</div><div class="line">            res.reply.mess = <span class="string">'An action must be given'</span>;</div><div class="line">            res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            next();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>In the event that a request body is there, application settings will be updated here if values are given. In addition if not action property is given that will also send a 400 status as well. All post requests sent to the path should have an action property that will be used to know which action should be preformed.</p>
<h3 id="3-2-middleware-action-open-js"><a href="#3-2-middleware-action-open-js" class="headerlink" title="3.2 - /middleware/action_open.js"></a>3.2 - /middleware/action_open.js</h3><p>Here I have my open action middleware this is what will be used to open the current file, and send the data of that file to the client system. A 400 status will be sent in the event that any kind of error will happen in the process of doing so.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// if action : 'open'</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (req.body.action === <span class="string">'open'</span>) &#123;</div><div class="line">        <span class="comment">// try to open the current filename at the current dir</span></div><div class="line">        fs.readFile(path.join(res.app.get(<span class="string">'dir'</span>), res.app.get(<span class="string">'fn'</span>)), res.app.get(<span class="string">'encode'</span>), (e, data) =&gt; &#123;</div><div class="line">            <span class="keyword">if</span> (e) &#123;</div><div class="line">                res.reply.mess = e.message;</div><div class="line">                res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                res.reply.success = <span class="literal">true</span>;</div><div class="line">                res.reply.mess = <span class="string">'opened and sent file data'</span>;</div><div class="line">                res.reply.data = data;</div><div class="line">                res.status(<span class="number">200</span>).json(res.reply);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        next();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The error message will be sent as part of the standard reply object so if something goes wrong that information can be displayed in the client system.</p>
<h3 id="3-3-middleware-action-save-js"><a href="#3-3-middleware-action-save-js" class="headerlink" title="3.3 - /middleware/action_save.js"></a>3.3 - /middleware/action_save.js</h3><p>Here I have my save action middleware as the name suggests this is what will be used to save the current file with data that is sent from the client system via a post request body.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// if action : 'save'</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (req.body.action === <span class="string">'save'</span>) &#123;</div><div class="line">        <span class="comment">// if we have data</span></div><div class="line">        <span class="keyword">if</span> (req.body.data) &#123;</div><div class="line">            <span class="comment">// try to save the data</span></div><div class="line">            fs.writeFile(path.join(res.app.get(<span class="string">'dir'</span>), res.app.get(<span class="string">'fn'</span>)), req.body.data, (e) =&gt; &#123;</div><div class="line">                <span class="keyword">if</span> (e) &#123;</div><div class="line">                    res.reply.mess = e.message;</div><div class="line">                    res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    res.reply.success = <span class="literal">true</span>;</div><div class="line">                    res.reply.mess = <span class="string">'save file success'</span>;</div><div class="line">                    res.reply.data = req.body.data;</div><div class="line">                    res.status(<span class="number">200</span>).json(res.reply);</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// else we do not have data to save</span></div><div class="line">            res.reply.mess = <span class="string">'must have data to save'</span>;</div><div class="line">            res.status(<span class="number">400</span>).json(res.reply);</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        next();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Again 400 status will be sent for any error that might happen while saving the file, or if no data is given to save.</p>
<h3 id="3-4-middleware-action-list-js"><a href="#3-4-middleware-action-list-js" class="headerlink" title="3.4 - /middleware/action_list.js"></a>3.4 - /middleware/action_list.js</h3><p>Here I have my list middleware this is what I am using to create a list of the contents of the current directory. I am using the fs.readdir file system module method to read the contents of the current directory set in the application settings of the project. I am also using the fs.stat method to find out if an item in a directory is a file or another directory. This data is then sent to the client system that uses the data to implement a file system navigation feature of the text editor.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// if action : 'list' - to list files in current dir</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (req.body.action === <span class="string">'list'</span>) &#123;</div><div class="line"> </div><div class="line">        <span class="comment">// change dir</span></div><div class="line">        <span class="keyword">if</span> (req.body.cd) &#123;</div><div class="line">            res.app.set(<span class="string">'dir'</span>, path.join(res.app.get(<span class="string">'dir'</span>), req.body.cd));</div><div class="line">            res.reply.dir = res.app.get(<span class="string">'dir'</span>)</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        fs.readdir(path.resolve(res.app.get(<span class="string">'dir'</span>)), (e, files) =&gt; &#123;</div><div class="line"> </div><div class="line">            <span class="keyword">if</span> (e) &#123;</div><div class="line"> </div><div class="line">                res.reply.mess = e.message;</div><div class="line">                res.status(<span class="number">400</span>).json(res.reply);</div><div class="line"> </div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line"> </div><div class="line">                <span class="keyword">let</span> i = <span class="number">0</span>,</div><div class="line">                len = files.length,</div><div class="line"> </div><div class="line">                <span class="comment">// step stat</span></div><div class="line">                stepStat = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">                    i += <span class="number">1</span>;</div><div class="line">                    <span class="keyword">if</span> (i === len) &#123;</div><div class="line"> </div><div class="line">                        <span class="comment">// add back one</span></div><div class="line">                        files.unshift(&#123;</div><div class="line">                            <span class="attr">fn</span>: <span class="string">'..'</span>,</div><div class="line">                            <span class="attr">dir</span>: <span class="literal">true</span></div><div class="line">                        &#125;);</div><div class="line"> </div><div class="line">                        res.reply.success = <span class="literal">true</span>;</div><div class="line">                        res.reply.mess = <span class="string">'list sent'</span>;</div><div class="line">                        res.reply.data = files;</div><div class="line">                        res.status(<span class="number">200</span>).json(res.reply);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        readStat();</div><div class="line">                    &#125;</div><div class="line">                &#125;,</div><div class="line"> </div><div class="line">                <span class="comment">// next stat</span></div><div class="line">                readStat = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">                    fs.stat(path.join(res.app.get(<span class="string">'dir'</span>), files[i]), (e, stat) =&gt; &#123;</div><div class="line">                        <span class="keyword">if</span> (stat) &#123;</div><div class="line">                            files[i] = &#123;</div><div class="line">                                <span class="attr">fn</span>: files[i],</div><div class="line">                                <span class="attr">dir</span>: stat.isDirectory()</div><div class="line">                            &#125;;</div><div class="line">                        &#125; <span class="keyword">else</span> &#123;</div><div class="line">                            files[i] = &#123;</div><div class="line">                                <span class="attr">fn</span>: files[i]</div><div class="line">                            &#125;;</div><div class="line">                        &#125;</div><div class="line">                        stepStat();</div><div class="line">                    &#125;);</div><div class="line">                &#125;;</div><div class="line">                readStat();</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">        &#125;);</div><div class="line"> </div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line"> </div><div class="line">        <span class="comment">// else next action</span></div><div class="line">        next();</div><div class="line"> </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>That concludes the middleware that I am using, as well as all the back end code as well. Now for the public folder that contains all the front end code.</p>
<h2 id="4-The-public-folder"><a href="#4-The-public-folder" class="headerlink" title="4 - The /public folder"></a>4 - The /public folder</h2><p>The public folder contains html, css, and javaScript files. For this example there is nothing fancy going on in terms of the client system when it comes to the use of front end frameworks, as I did not want to pull to much attention away from express. </p>
<h3 id="4-1-public-html-index-html"><a href="#4-1-public-html-index-html" class="headerlink" title="4.1 - /public/html/index.html"></a>4.1 - /public/html/index.html</h3><p>Here I have just the one html file that I am using for this project. I am using a textarea element for the text as this project is just a plain old text editor, so I do not need to do anything fancy when it comes to styling text.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Express Example Text Editor<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"edit.css"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"list_files"</span> <span class="attr">class</span>=<span class="string">"list_files"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"editor"</span>&gt;</span></div><div class="line"> </div><div class="line">  <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"text_edit"</span> <span class="attr">rows</span>=<span class="string">"16"</span> <span class="attr">cols</span>=<span class="string">"64"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>dir : <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text_dir"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text_list"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"list"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>fn  : <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text_fn"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text_open"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"open"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text_save"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"save"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"text_emess"</span> <span class="attr">class</span>=<span class="string">"text_emess"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"text_mess"</span> <span class="attr">class</span>=<span class="string">"text_mess"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/get.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/menu.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/client.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="4-2-public-html-edit-css"><a href="#4-2-public-html-edit-css" class="headerlink" title="4.2 - /public/html/edit.css"></a>4.2 - /public/html/edit.css</h3><p>Some css is used to position elements and style message text.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">* &#123;</div><div class="line">    <span class="attribute">padding</span>:<span class="number">0px</span>;</div><div class="line">    <span class="attribute">margin</span>:<span class="number">0px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">div</span> &#123;</div><div class="line">    <span class="attribute">padding</span>:<span class="number">1%</span>;</div><div class="line">    <span class="attribute">position</span>:relative;</div><div class="line">    <span class="attribute">float</span>:left;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.list</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">20%</span>;</div><div class="line">    <span class="attribute">background</span>:grey;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.list_dirlink</span>&#123;</div><div class="line">    <span class="attribute">color</span>:red;</div><div class="line">&#125;</div><div class="line"><span class="selector-id">#list_files</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</div><div class="line">    <span class="attribute">height</span>:<span class="number">400px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.editor</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">50%</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.text_mess</span>&#123;<span class="attribute">color</span>:green;&#125;</div><div class="line"><span class="selector-class">.text_emess</span>&#123;<span class="attribute">color</span>:red; <span class="attribute">width</span>:auto;&#125;</div></pre></td></tr></table></figure>
<h3 id="4-3-public-js-get-js"><a href="#4-3-public-js-get-js" class="headerlink" title="4.3 - / public/js/get.js"></a>4.3 - / public/js/get.js</h3><p>Here I have a javaScript file that provides a function that both wraps document.getElementById, and can also be used to make post requests as well.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> get = <span class="function"><span class="keyword">function</span> (<span class="params">sOpt</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// if STRING get is a wrapper for document.getElementById</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> sOpt === <span class="string">'string'</span>) &#123;</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(sOpt);</div><div class="line"> </div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line"> </div><div class="line">        <span class="comment">// else an OBJECT is assumed and used to make http requests</span></div><div class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">        xhr.open(<span class="string">'POST'</span>, <span class="string">'/data'</span>, <span class="literal">true</span>);</div><div class="line"> </div><div class="line">        sOpt = sOpt || &#123;&#125;;</div><div class="line">        sOpt.payload = sOpt.payload || &#123;&#125;;</div><div class="line">        sOpt.action = sOpt.action || <span class="string">'open'</span>;</div><div class="line">        sOpt.onDone = sOpt.onDone || <span class="function"><span class="keyword">function</span> (<span class="params">res,resObj</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(resObj);</div><div class="line">        &#125;;</div><div class="line">        sOpt.onError = sOpt.onError || <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(e);</div><div class="line">        &#125;;</div><div class="line"> </div><div class="line">        <span class="comment">// what to do for ready state</span></div><div class="line">        xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.readyState === <span class="number">4</span>) &#123;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    <span class="keyword">var</span> resObj = <span class="built_in">JSON</span>.parse(<span class="keyword">this</span>.response);</div><div class="line">                    <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">200</span>) &#123;</div><div class="line">                        sOpt.onDone.call(<span class="keyword">this</span>, resObj.data, resObj);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        sOpt.onError.call(<span class="keyword">this</span>, resObj.mess, resObj);</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">                    sOpt.onError.call(<span class="keyword">this</span>, <span class="string">'JSON Parse Error in get.js'</span>, &#123;&#125;);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line"> </div><div class="line">        <span class="comment">// in this project all requests will be for JSON data</span></div><div class="line">        xhr.setRequestHeader(<span class="string">'Content-type'</span>, <span class="string">'application/json'</span>);</div><div class="line">        xhr.send(<span class="built_in">JSON</span>.stringify(sOpt.payload));</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="4-4-public-js-menu-js"><a href="#4-4-public-js-menu-js" class="headerlink" title="4.4 - / public/js/menu.js"></a>4.4 - / public/js/menu.js</h3><p>Here I have another module that I worked out that has to do with making all the various requests to the express middleware back ends that I put together.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Module to help work with the</span></div><div class="line"><span class="comment">// back end system for the editor</span></div><div class="line"><span class="keyword">var</span> Menu = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// set / clear messages</span></div><div class="line">    <span class="keyword">var</span> mess = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> el_mess = get(<span class="string">'text_mess'</span>),</div><div class="line">        el_eMess = get(<span class="string">'text_emess'</span>);</div><div class="line">        <span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span> (<span class="params">mess</span>) </span>&#123;</div><div class="line">            el_mess.innerHTML = mess;</div><div class="line">        &#125;;</div><div class="line">        func.eMess = <span class="function"><span class="keyword">function</span> (<span class="params">eMess</span>) </span>&#123;</div><div class="line">            el_eMess.innerHTML = eMess;</div><div class="line">        &#125;;</div><div class="line">        func.clear = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            el_mess.innerHTML = <span class="string">''</span>;</div><div class="line">            el_eMess.innerHTML = <span class="string">''</span>;</div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">return</span> func;</div><div class="line">    &#125;</div><div class="line">        ());</div><div class="line"> </div><div class="line">    <span class="comment">// set the dir and fn input elements values to</span></div><div class="line">    <span class="comment">// what is in the given reply object</span></div><div class="line">    <span class="keyword">var</span> setInputs = <span class="function"><span class="keyword">function</span> (<span class="params">reply</span>) </span>&#123;</div><div class="line">        get(<span class="string">'text_dir'</span>).value = reply.dir;</div><div class="line">        get(<span class="string">'text_fn'</span>).value = reply.fn;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// public api</span></div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line">    api.noop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">    api.done = <span class="function"><span class="keyword">function</span> (<span class="params">text</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(text)</div><div class="line">    &#125;;</div><div class="line">    api.error = <span class="function"><span class="keyword">function</span> (<span class="params">eMess</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(eMess);</div><div class="line">        mess.eMess(eMess);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="comment">// Open the file that is at the current</span></div><div class="line">    <span class="comment">// dir and fn app settings</span></div><div class="line">    api.Open = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        <span class="comment">// if null for dir or fn the default will</span></div><div class="line">        <span class="comment">// be whatever is set server side</span></div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        mess.clear();</div><div class="line">        get(&#123;</div><div class="line">            <span class="attr">payload</span>: &#123;</div><div class="line">                <span class="attr">action</span>: <span class="string">'open'</span>,</div><div class="line">                <span class="attr">dir</span>: opt.dir || <span class="literal">null</span>,</div><div class="line">                <span class="attr">fn</span>: opt.fn || <span class="literal">null</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onDone</span>: <span class="function"><span class="keyword">function</span> (<span class="params">text, resObj</span>) </span>&#123;</div><div class="line">                get(<span class="string">'text_edit'</span>).value = text;</div><div class="line">                <span class="comment">//get('text_fn').value = resObj.fn;</span></div><div class="line">                mess(resObj.mess);</div><div class="line">                setInputs(resObj);</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onError</span>: api.error</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    api.Save = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line"> </div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        mess.clear();</div><div class="line">        get(&#123;</div><div class="line">            <span class="attr">payload</span>: &#123;</div><div class="line">                <span class="attr">action</span>: <span class="string">'save'</span>,</div><div class="line">                <span class="attr">dir</span>: opt.dir || <span class="literal">null</span>,</div><div class="line">                <span class="attr">fn</span>: opt.fn || <span class="literal">null</span>,</div><div class="line">                <span class="attr">data</span>: get(<span class="string">'text_edit'</span>).value</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onDone</span>: <span class="function"><span class="keyword">function</span> (<span class="params">text, resObj</span>) </span>&#123;</div><div class="line">                get(<span class="string">'text_edit'</span>).value = text;</div><div class="line">                mess(resObj.mess);</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onError</span>: api.error</div><div class="line">        &#125;);</div><div class="line"> </div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> emptyList = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> list = get(<span class="string">'list_files'</span>).contentWindow.document.body;</div><div class="line">        <span class="keyword">while</span> (list.firstChild) &#123;</div><div class="line">            list.removeChild(list.firstChild);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    api.List = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        mess.clear();</div><div class="line">        get(&#123;</div><div class="line">            <span class="attr">payload</span>: &#123;</div><div class="line">                <span class="attr">action</span>: <span class="string">'list'</span>,</div><div class="line">                <span class="attr">dir</span>: opt.dir || <span class="literal">null</span>,</div><div class="line">                <span class="attr">cd</span>: opt.cd || <span class="literal">null</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onDone</span>: <span class="function"><span class="keyword">function</span> (<span class="params">files, resObj</span>) </span>&#123;</div><div class="line"> </div><div class="line">                emptyList();</div><div class="line"> </div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'files:'</span>);</div><div class="line"> </div><div class="line">                <span class="keyword">var</span> list = get(<span class="string">'list_files'</span>);</div><div class="line">                files.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">fStat</span>) </span>&#123;</div><div class="line">                    <span class="keyword">var</span> item = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">                    item.innerHTML = <span class="string">'&lt;span style=\"'</span> + (fStat.dir ? <span class="string">'color:red;'</span> : <span class="string">'color:green;'</span>) + <span class="string">'\"&gt;'</span> + fStat.fn + <span class="string">'&lt;\/span&gt;'</span>;</div><div class="line">                    item.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">                        <span class="comment">// open the file clicked</span></div><div class="line">                        <span class="keyword">if</span> (fStat.dir) &#123;</div><div class="line">                            Menu.List(&#123;</div><div class="line">                                <span class="attr">cd</span>: e.target.innerText</div><div class="line">                            &#125;);</div><div class="line"> </div><div class="line">                        &#125; <span class="keyword">else</span> &#123;</div><div class="line">                            api.Open(&#123;</div><div class="line">                                <span class="attr">fn</span>: e.target.innerText</div><div class="line">                            &#125;);</div><div class="line">                        &#125;</div><div class="line">                    &#125;)</div><div class="line">                    list.contentWindow.document.body.appendChild(item);</div><div class="line"> </div><div class="line">                &#125;);</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onError</span>: api.error</div><div class="line">        &#125;);</div><div class="line"> </div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> api;</div><div class="line"> </div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h3 id="4-5-public-js-client-js"><a href="#4-5-public-js-client-js" class="headerlink" title="4.5 - / public/js/client.js"></a>4.5 - / public/js/client.js</h3><p>An additional javaScript file that attaches some event handers, and makes the initial calls for certain methods in the menu module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// open the current file</span></div><div class="line">Menu.Open();</div><div class="line">Menu.List();</div><div class="line"> </div><div class="line">get(<span class="string">'text_open'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">    Menu.Open(&#123;</div><div class="line">        <span class="attr">fn</span>: get(<span class="string">'text_fn'</span>).value,</div><div class="line">        <span class="attr">dir</span>: get(<span class="string">'text_dir'</span>).value</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">get(<span class="string">'text_save'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">    Menu.Save(&#123;</div><div class="line">        <span class="attr">fn</span>: get(<span class="string">'text_fn'</span>).value</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">get(<span class="string">'text_list'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">    Menu.List(&#123;</div><div class="line">        <span class="attr">dir</span>: get(<span class="string">'text_dir'</span>).value</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2019/05/01/express-example-text-editor/" data-id="cjvh0yud90001lwv1cb8ag6c7" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2019/05/01/express-example-text-editor/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/express/">express</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/05/02/express-example-markdown-editor/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          An express markdown editor example
        
      </div>
    </a>
  
  
    <a href="/2019/04/30/express-example/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Express examples from very basic to not so basic</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2019/05/01/express-example-text-editor/index.html';
    this.page.identifier = '431';
    this.page.title = 'An express text editor example';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.11px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.53px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.68px;">angular</a> <a href="/tags/animation/" style="font-size: 12.63px;">animation</a> <a href="/tags/automation/" style="font-size: 12.63px;">automation</a> <a href="/tags/backbone/" style="font-size: 13.16px;">backbone</a> <a href="/tags/blog/" style="font-size: 15.26px;">blog</a> <a href="/tags/canvas/" style="font-size: 16.84px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.63px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 11.05px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.58px;">ejs</a> <a href="/tags/express/" style="font-size: 17.37px;">express</a> <a href="/tags/games/" style="font-size: 17.89px;">games</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 14.21px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.58px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.74px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.53px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.58px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 11.58px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.42px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.74px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.47px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.95px;">phaser</a> <a href="/tags/statistics/" style="font-size: 12.11px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 16.32px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 15.79px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/05/26/vuejs-lifecycle-before-create/">vue before create lifecycle hook</a>
          </li>
        
          <li>
            <a href="/2019/05/25/vuejs-lifecycle-mounted/">vue mounted lifecycle hook</a>
          </li>
        
          <li>
            <a href="/2019/05/24/vuejs-lifecycle-create/">vue created lifecycle hook</a>
          </li>
        
          <li>
            <a href="/2019/05/23/vuejs-next/">vue next tick global method and DOM updates</a>
          </li>
        
          <li>
            <a href="/2019/05/22/vuejs-if/">vue if conditional directive and other options</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2019/05/01/express-example-text-editor/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>