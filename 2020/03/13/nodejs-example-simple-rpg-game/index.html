<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>A simple nodejs powered RPG game | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I have been wanting to get around to making a simple terminal based RPG style game with nodejs, and write about it as one of several nodejs example type posts. So I finally got around to doing just th">
<meta property="og:type" content="article">
<meta property="og:title" content="A simple nodejs powered RPG game">
<meta property="og:url" content="https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="I have been wanting to get around to making a simple terminal based RPG style game with nodejs, and write about it as one of several nodejs example type posts. So I finally got around to doing just th">
<meta property="og:updated_time" content="2021-03-16T19:51:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A simple nodejs powered RPG game">
<meta name="twitter:description" content="I have been wanting to get around to making a simple terminal based RPG style game with nodejs, and write about it as one of several nodejs example type posts. So I finally got around to doing just th">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS-Examples</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas-Examples</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-nodejs-example-simple-rpg-game" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/13/nodejs-example-simple-rpg-game/" class="article-date"> Published:
  <time datetime="2020-03-13T18:07:00.000Z" itemprop="datePublished">2020-03-13</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2020/03/13/nodejs-example-simple-rpg-game/" class="article-date"> Modified:
  <time datetime="2021-03-16T19:51:10.000Z" itemprop="dateModified">2021-03-16</time>
</a>

    <span class="article-date">V1.24</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      A simple nodejs powered RPG game
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>I have been wanting to get around to making a simple terminal based <a href="https://en.wikipedia.org/wiki/Role-playing_video_game" target="_blank" rel="external">RPG style game</a> with nodejs, and write about it as one of several <a href="/2021/03/16/nodejs-example/">nodejs example</a> type posts. So I finally got around to doing just that. The basic idea that I had in mind was just a simple turn based terminal RPG game that uses <a href="/2019/09/19/nodejs-ansi-escape-codes/">ANSI escape codes</a> to draw the state of the game board. Nothing special in terms of item drops, enemy types, spells, and even leveling up as I want to keep this one pretty simple.</p>
<p>No name for this as of yet, I am horrible with names anyway, for not I will just call it simple RPG game. In time this example might server as a starting point for other more interesting projects, so I will want to try to keep everything neat and clean if I can.</p>
<a id="more"></a>
<h2 id="1-What-to-know-about-this-simple-RPG-nodejs-example-before-continuing"><a href="#1-What-to-know-about-this-simple-RPG-nodejs-example-before-continuing" class="headerlink" title="1 - What to know about this simple RPG nodejs example before continuing"></a>1 - What to know about this simple RPG nodejs example before continuing</h2><p>I am writing about the state of this nodejs example of a rpg game that I have worked out in a day or so. To understand what I am writing about I assume that you have some background with javaScript and node.js, if not you might have a hard time understanding some of this stuff.</p>
<p>If you are just interesting in playing the game you could clone it down from the repo on my git hub account and just call the main game.js file with nodejs in the command line.</p>
<h2 id="2-The-utility-library"><a href="#2-The-utility-library" class="headerlink" title="2 - The utility library"></a>2 - The utility library</h2><p>I will want to have a custom trailered utility library with a bunch of methods that I will be using in at least one if not more other modules. Something like lodash only with methods that I will be using just for this project alone. So with this kind of project I will want things like a distance formula, as well as just about any other kind of method that will help with typical tasks.</p>
<h3 id="2-1-The-distance-formula"><a href="#2-1-The-distance-formula" class="headerlink" title="2.1 - The distance formula"></a>2.1 - The distance formula</h3><p>So I know that I will want a distance formula for this project. So I start off my utility module by making sure I am exporting that one for starters.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// distance between two points</span></div><div class="line">exports.distance = <span class="function">(<span class="params">x1, y1, x2, y2</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(x1 - x2, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(y1 - y2, <span class="number">2</span>));</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-2-get-a-new-position-for-a-display-object-with-a-given-direction-number-0-3"><a href="#2-2-get-a-new-position-for-a-display-object-with-a-given-direction-number-0-3" class="headerlink" title="2.2 - get a new position for a display object with a given direction number (0-3)"></a>2.2 - get a new position for a display object with a given direction number (0-3)</h3><p>I also ended up working out a method that will return a new position for a display object given a direction number in the range of zero to three.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// return an x and y position that is the</span></div><div class="line"><span class="comment">// next step from the position in 'obj' based</span></div><div class="line"><span class="comment">// off the given 'dir' in 0 to 3 form</span></div><div class="line">exports.dirToPos = <span class="function">(<span class="params">obj, dir</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> r = <span class="built_in">Math</span>.PI * <span class="number">2</span> / <span class="number">4</span> * dir,</div><div class="line">    dx = <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.cos(r)),</div><div class="line">    dy = <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.sin(r));</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">x</span>: obj.x + dx,</div><div class="line">        <span class="attr">y</span>: obj.y + dy</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-3-Get-a-direction-number-0-3-from-a-display-object-to-another-display-object"><a href="#2-3-Get-a-direction-number-0-3-from-a-display-object-to-another-display-object" class="headerlink" title="2.3 - Get a direction number (0-3) from a display object to another display object"></a>2.3 - Get a direction number (0-3) from a display object to another display object</h3><p>I will want a method that can be used to find out what direction number a display object should move in oder to get to another display object. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// get a direction number (0 - 3) from one object to another</span></div><div class="line">exports.getDirFromObjToObj = <span class="function">(<span class="params">obj1, obj2</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> r = <span class="built_in">Math</span>.atan2(obj1.y - obj2.y, obj1.x - obj2.x) + <span class="built_in">Math</span>.PI,</div><div class="line">    per = r / (<span class="built_in">Math</span>.PI * <span class="number">2</span>),</div><div class="line">    dir = <span class="built_in">Math</span>.floor(<span class="number">4</span> * per) % <span class="number">4</span>;</div><div class="line">    <span class="keyword">return</span> dir;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-4-Set-bounds-for-a-display-object"><a href="#2-4-Set-bounds-for-a-display-object" class="headerlink" title="2.4 - Set bounds for a display object"></a>2.4 - Set bounds for a display object</h3><p>There is a utility method for setting the boundaries for a display object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// use the given 'map' object with a w and h prop</span></div><div class="line"><span class="comment">// to create an object with x and y props set to values</span></div><div class="line"><span class="comment">// that are in bounds for an 'obj' that might be out of bounds</span></div><div class="line">exports.setBounds = <span class="function">(<span class="params">state, obj</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> point = &#123;&#125;;</div><div class="line">    point.x = obj.x &gt; state.w ? state.w : obj.x;</div><div class="line">    point.y = obj.y &gt; state.h ? state.h : obj.y;</div><div class="line">    point.x = obj.x &lt; <span class="number">1</span> ? <span class="number">1</span> : point.x;</div><div class="line">    point.y = obj.y &lt; <span class="number">1</span> ? <span class="number">1</span> : point.y;</div><div class="line">    <span class="keyword">return</span> point;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-5-isOverPlayer-get-and-isOverNothing"><a href="#2-5-isOverPlayer-get-and-isOverNothing" class="headerlink" title="2.5 - isOverPlayer, get, and isOverNothing"></a>2.5 - isOverPlayer, get, and isOverNothing</h3><p>I then also have methods for getting any display object that might be at a location or nothing if the location is empty.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// is the given location over the player?</span></div><div class="line"><span class="keyword">let</span> isOverPlayer = exports.isOverPlayer = <span class="function">(<span class="params">state, x, y</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> x === state.player.x &amp;&amp; y === state.player.y;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// check if there is something at the given location</span></div><div class="line"><span class="comment">// if so return it</span></div><div class="line"><span class="keyword">let</span> get = exports.get = <span class="function">(<span class="params">state, x, y, mode</span>) =&gt;</span> &#123;</div><div class="line">    mode = mode || <span class="string">'any'</span>;</div><div class="line">    <span class="comment">// if player is at location return that</span></div><div class="line">    <span class="keyword">if</span> (isOverPlayer(state, x, y) &amp;&amp; (mode === <span class="string">'any'</span> || mode === <span class="string">'player'</span>)) &#123;</div><div class="line">        <span class="keyword">return</span> state.player;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// check enemies array</span></div><div class="line">    <span class="keyword">if</span> (mode === <span class="string">'any'</span> || mode === <span class="string">'enemies'</span>) &#123;</div><div class="line">        <span class="keyword">let</span> i = state.enemies.length;</div><div class="line">        <span class="keyword">while</span> (i--) &#123;</div><div class="line">            <span class="keyword">let</span> e = state.enemies[i];</div><div class="line">            <span class="keyword">if</span> (e.x === x &amp;&amp; e.y === y) &#123;</div><div class="line">                <span class="keyword">return</span> e;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// is the given location over nothing?</span></div><div class="line">exports.isOverNothing = <span class="function">(<span class="params">state, x, y</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> !get(state, x, y);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>If I take the time to continue to develop this nodejs example into a more complex game, this library will of course expand. Generally any kind of methods that will be used in more than one other library should be parked here.</p>
<h2 id="3-The-state-object-of-the-simple-rpg-canvas-example"><a href="#3-The-state-object-of-the-simple-rpg-canvas-example" class="headerlink" title="3 - The state object of the simple rpg canvas example"></a>3 - The state object of the simple rpg canvas example</h2><p>I am going to want to have some kind of state object for the game. This object will of course hold the current state of a player object along with other data for enemies, and the nature of the game board.</p>
<p>I will want methods that can be used to both load and save a state object as well as create a new one. The load state method should just return a new state object in the event of an error, or the loaded state object if all goes well.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),</div><div class="line">promisify = <span class="built_in">require</span>(<span class="string">'util'</span>).promisify,</div><div class="line">read = promisify(fs.readFile),</div><div class="line">write = promisify(fs.writeFile);</div><div class="line"> </div><div class="line"><span class="keyword">let</span> newState = exports.newState = <span class="function">(<span class="params">opt</span>) =&gt;</span> &#123;</div><div class="line">    opt = opt || &#123;&#125;;</div><div class="line">    opt.w = opt.w || <span class="number">31</span>;</div><div class="line">    opt.h = opt.h || <span class="number">11</span>;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">player</span>: &#123;</div><div class="line">            <span class="attr">x</span>: <span class="built_in">Math</span>.floor(opt.w / <span class="number">2</span>),</div><div class="line">            <span class="attr">y</span>: <span class="built_in">Math</span>.floor(opt.h / <span class="number">2</span>),</div><div class="line">            <span class="attr">oldX</span>: <span class="number">1</span>,</div><div class="line">            <span class="attr">oldY</span>: <span class="number">1</span>,</div><div class="line">            <span class="attr">attack</span>: <span class="number">1</span>,</div><div class="line">            <span class="attr">hp</span>: <span class="number">10</span>,</div><div class="line">            <span class="attr">hpMax</span>: <span class="number">100</span>,</div><div class="line">            <span class="attr">autoHeal</span>: <span class="number">1</span>,</div><div class="line">            <span class="attr">autoHealEvery</span>: <span class="number">3</span>,</div><div class="line">            <span class="attr">autoHealTicks</span>: <span class="number">0</span>,</div><div class="line">            <span class="attr">exp</span>: <span class="number">0</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">enemies</span>: [],</div><div class="line">        <span class="attr">lastSpawn</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">w</span>: opt.w,</div><div class="line">        <span class="attr">h</span>: opt.h</div><div class="line">    &#125;;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.loadState = <span class="function">(<span class="params">root, fileName</span>) =&gt;</span> &#123;</div><div class="line">    root = root || process.cwd();</div><div class="line">    fileName = fileName || <span class="string">'simple-rpg.json'</span>;</div><div class="line">    <span class="keyword">return</span> read(path.join(root, fileName), <span class="string">'utf8'</span>)</div><div class="line">    .then(<span class="function">(<span class="params">json</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">let</span> state = <span class="built_in">JSON</span>.parse(json);</div><div class="line">        <span class="keyword">return</span> state;</div><div class="line">    &#125;)</div><div class="line">    .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> newState();</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.saveState = <span class="function">(<span class="params">state, root, fileName</span>) =&gt;</span> &#123;</div><div class="line">    root = root || process.cwd();</div><div class="line">    fileName = fileName || <span class="string">'simple-rpg.json'</span>;</div><div class="line">    <span class="keyword">return</span> write(path.join(root, fileName), <span class="built_in">JSON</span>.stringify(state), <span class="string">'utf8'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="4-The-enemies-module"><a href="#4-The-enemies-module" class="headerlink" title="4 - The enemies module"></a>4 - The enemies module</h2><p>So in this game there will be enemy objects in the game board area. So I will want a module that can be used to spawn enemies into an array fro a spawn location in the game board. In addition there will need to be all kinds of other methods that can be used to create a primitive yet function AI.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> u = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>);</div><div class="line"> </div><div class="line"><span class="keyword">const</span> ENEMIES_MAX = <span class="number">6</span>,</div><div class="line">ENEMIES_SPAWN_MIN = <span class="number">5</span>,</div><div class="line">ENEMIES_ATTACK_RANGE = <span class="number">1</span>;</div><div class="line"> </div><div class="line"><span class="comment">// purge any dead enemies</span></div><div class="line">exports.purgeDead = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> i = state.enemies.length;</div><div class="line">    <span class="keyword">while</span> (i--) &#123;</div><div class="line">        <span class="keyword">let</span> e = state.enemies[i];</div><div class="line">        <span class="keyword">if</span> (e.hp &lt;= <span class="number">0</span>) &#123;</div><div class="line">            state.player.exp += <span class="number">1</span>;</div><div class="line">            state.enemies.splice(i, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.spawnEnemy = <span class="function">(<span class="params">state, x, y</span>) =&gt;</span> &#123;</div><div class="line">    x = x === <span class="literal">undefined</span> ? <span class="number">1</span> : x;</div><div class="line">    y = y === <span class="literal">undefined</span> ? <span class="built_in">Math</span>.floor(state.h / <span class="number">2</span>) : y;</div><div class="line">    <span class="keyword">if</span> (state.lastSpawn &gt;= ENEMIES_SPAWN_MIN) &#123;</div><div class="line">        <span class="keyword">if</span> (state.enemies.length &lt; ENEMIES_MAX &amp;&amp; !u.isOverPlayer(state, x, y)) &#123;</div><div class="line">            <span class="keyword">let</span> e = u.get(state, x, y, <span class="string">'enemies'</span>);</div><div class="line">            <span class="keyword">if</span> (!e) &#123;</div><div class="line">                state.enemies.push(&#123;</div><div class="line">                    <span class="attr">x</span>: x,</div><div class="line">                    <span class="attr">y</span>: y,</div><div class="line">                    <span class="attr">oldX</span>: x,</div><div class="line">                    <span class="attr">oldY</span>: y,</div><div class="line">                    <span class="attr">hp</span>: <span class="number">3</span>,</div><div class="line">                    <span class="attr">sight</span>: <span class="number">4</span>,</div><div class="line">                    <span class="attr">attack</span>: <span class="number">1</span></div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        state.lastSpawn = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    state.lastSpawn += <span class="number">1</span>;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> toPlayerPos = <span class="function">(<span class="params">state, e</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> dir = u.getDirFromObjToObj(e, state.player);</div><div class="line">    <span class="keyword">return</span> u.dirToPos(e, dir);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> toRandomPos = <span class="function">(<span class="params">state, e</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> u.dirToPos(e, <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">4</span>));</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.updateEnemies = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> i = state.enemies.length;</div><div class="line">    <span class="keyword">while</span> (i--) &#123;</div><div class="line">        <span class="keyword">let</span> e = state.enemies[i],</div><div class="line">        player = state.player,</div><div class="line">        d = u.distance(e.x, e.y, player.x, player.y),</div><div class="line">        pos = d &lt;= e.sight ? toPlayerPos(state, e) : toRandomPos(state, e);</div><div class="line">        <span class="keyword">if</span> (u.isOverNothing(state, pos.x, pos.y)) &#123;</div><div class="line">            e.oldX = e.x;</div><div class="line">            e.oldY = e.y;</div><div class="line">            e.x = pos.x;</div><div class="line">            e.y = pos.y;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// set bounds</span></div><div class="line">        e = <span class="built_in">Object</span>.assign(e, u.setBounds(state, e));</div><div class="line">        <span class="comment">// attack player</span></div><div class="line">        <span class="keyword">if</span> (d &lt;= ENEMIES_ATTACK_RANGE) &#123;</div><div class="line">            player.hp -= e.attack;</div><div class="line">            player.hp = player.hp &lt; <span class="number">0</span> ? <span class="number">0</span> : player.hp;</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="5-The-player-module"><a href="#5-The-player-module" class="headerlink" title="5 - The player module"></a>5 - The player module</h2><p>So because I have an enemies module it would make sense that I also have a player module as well.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> u = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>),</div><div class="line">enemies = <span class="built_in">require</span>(<span class="string">'./enemies.js'</span>);</div><div class="line"> </div><div class="line"><span class="keyword">let</span> moveOrAttack = <span class="function">(<span class="params">state, tempX, tempY</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">// move or attack enemy</span></div><div class="line">    <span class="keyword">let</span> e = u.get(state, tempX, tempY, <span class="string">'enemies'</span>),</div><div class="line">    player = state.player;</div><div class="line">    <span class="keyword">if</span> (!e) &#123;</div><div class="line">        player.oldX = player.x;</div><div class="line">        player.oldY = player.y;</div><div class="line">        player.x = tempX;</div><div class="line">        player.y = tempY;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        e.hp -= player.attack;</div><div class="line">        enemies.purgeDead(state);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// player bounds</span></div><div class="line">    player = <span class="built_in">Object</span>.assign(player, u.setBounds(state, player));</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> autoHeal = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> player = state.player;</div><div class="line">    <span class="comment">// player auto heal</span></div><div class="line">    <span class="keyword">if</span> (player.autoHeal) &#123;</div><div class="line">        player.autoHealTicks += <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (player.autoHealTicks &gt;= player.autoHealEvery) &#123;</div><div class="line">            player.hp += player.autoHeal;</div><div class="line">            player.hp = player.hp &gt; player.hpMax ? player.hpMax : player.hp;</div><div class="line">            player.autoHealTicks = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.update = <span class="function">(<span class="params">state, tempX, tempY</span>) =&gt;</span> &#123;</div><div class="line">    moveOrAttack(state, tempX, tempY);</div><div class="line">    autoHeal(state);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="6-The-input-handler-method"><a href="#6-The-input-handler-method" class="headerlink" title="6 - The input handler method"></a>6 - The input handler method</h2><p>I will need a way to process input from that standard input which will be the way that this game will be played. In the main game.js file there will be some code that will fire each time a key is pressed in the command line. Here I have my input.js file that returns one method that will be used in the event hander that will fire for key presses in the main game.js file that I will be getting to shortly.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> playerMod = <span class="built_in">require</span>(<span class="string">'./player.js'</span>),</div><div class="line">enemies = <span class="built_in">require</span>(<span class="string">'./enemies.js'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">state, input, opt</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> player = state.player,</div><div class="line">    tempX = player.x,</div><div class="line">    tempY = player.y;</div><div class="line">    <span class="keyword">if</span> (input === <span class="string">'d'</span>) &#123;</div><div class="line">        tempX += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (input === <span class="string">'a'</span>) &#123;</div><div class="line">        tempX -= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (input === <span class="string">'w'</span>) &#123;</div><div class="line">        tempY -= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (input === <span class="string">'s'</span>) &#123;</div><div class="line">        tempY += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (input === <span class="string">'x'</span>) &#123;</div><div class="line">        process.exit();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// update player, and enemies</span></div><div class="line">    playerMod.update(state, tempX, tempY);</div><div class="line">    enemies.spawnEnemy(state);</div><div class="line">    enemies.updateEnemies(state);</div><div class="line">    <span class="comment">// events</span></div><div class="line">    <span class="keyword">if</span> (player.hp === <span class="number">0</span>) &#123;</div><div class="line">        opt.onPlayerDead(state);</div><div class="line">    &#125;</div><div class="line">    opt.onTurnOver(state);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="7-The-draw-module"><a href="#7-The-draw-module" class="headerlink" title="7 - The draw module"></a>7 - The draw module</h2><p>Here I have the draw module that will be used to draw the current state of the state object to the command line using ANSI escape codes. There are two public methods, one of which will be called once during certain events to start all over, and then another that will be called to update that state rather than drawing the whole screen all over again. I have come to find that I need to do something like this so that there is not this screen flashing effect going on for each move.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> u = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>);</div><div class="line"> </div><div class="line"><span class="keyword">let</span> setCur = <span class="function">(<span class="params">x, y, out</span>) =&gt;</span> &#123;</div><div class="line">    x = x || <span class="number">0</span>;</div><div class="line">    y = y || <span class="number">0</span>;</div><div class="line">    out.write(<span class="string">'\u001b['</span> + y + <span class="string">';'</span> + x + <span class="string">'H'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> clearScreen = <span class="function">(<span class="params">out</span>) =&gt;</span> &#123;</div><div class="line">    out.write(<span class="string">'\u001b[2J'</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> colorsSet = <span class="function">(<span class="params">out</span>) =&gt;</span> &#123;</div><div class="line">    out.write(<span class="string">'\u001b[47m'</span>);</div><div class="line">    out.write(<span class="string">'\u001b[30m'</span>);</div><div class="line">&#125;;</div><div class="line"><span class="keyword">let</span> colorsDefault = <span class="function">(<span class="params">out</span>) =&gt;</span> &#123;</div><div class="line">    out.write(<span class="string">'\u001b[39m\u001b[49m'</span>);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> drawPlayerStats = <span class="function"><span class="keyword">function</span> (<span class="params">state, out</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> p = state.player,</div><div class="line">    text = <span class="string">'hp: '</span> + p.hp + <span class="string">'/'</span> + p.hpMax +</div><div class="line">        <span class="string">', exp: '</span> + p.exp;</div><div class="line">    setCur(<span class="number">1</span>, state.h + <span class="number">1</span>, out);</div><div class="line">    out.write(<span class="keyword">new</span> <span class="built_in">Array</span>(state.w).fill(<span class="string">' '</span>).join(<span class="string">''</span>));</div><div class="line">    setCur(<span class="number">1</span>, state.h + <span class="number">1</span>, out);</div><div class="line">    out.write(text);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> drawDotMap = <span class="function"><span class="keyword">function</span> (<span class="params">state, out</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> dotLine = <span class="keyword">new</span> <span class="built_in">Array</span>(state.w).fill(<span class="string">'.'</span>).join(<span class="string">''</span>) + <span class="string">'\n'</span>,</div><div class="line">    i = state.h;</div><div class="line">    <span class="keyword">while</span> (i--) &#123;</div><div class="line">        out.write(dotLine);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> drawPlayer = <span class="function"><span class="keyword">function</span> (<span class="params">state, out</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> pos = state.player;</div><div class="line">    setCur(pos.oldX, pos.oldY, out);</div><div class="line">    <span class="keyword">let</span> e2 = u.get(state, pos.oldX, pos.oldY, <span class="string">'enemies'</span>);</div><div class="line">    out.write(e2 ? <span class="string">'E'</span> : <span class="string">'.'</span>);</div><div class="line">    setCur(pos.x, pos.y, out);</div><div class="line">    out.write(<span class="string">'@'</span>);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> drawEnemies = <span class="function"><span class="keyword">function</span> (<span class="params">state, out</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> enemies = state.enemies,</div><div class="line">    i = enemies.length;</div><div class="line">    <span class="keyword">while</span> (i--) &#123;</div><div class="line">        <span class="keyword">let</span> e = enemies[i];</div><div class="line">        setCur(e.oldX, e.oldY, out);</div><div class="line">        <span class="keyword">let</span> e2 = u.get(state, e.oldX, e.oldY, <span class="string">'enemies'</span>);</div><div class="line">        out.write(e2 ? <span class="string">'E'</span> : <span class="string">'.'</span>);</div><div class="line">        setCur(e.x, e.y, out);</div><div class="line">        out.write(<span class="string">'E'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="keyword">let</span> updateScreen = exports.updateScreen = <span class="function">(<span class="params">state, out</span>) =&gt;</span> &#123;</div><div class="line">    out = out || process.stdout;</div><div class="line">    colorsSet(out);</div><div class="line">    <span class="comment">// draw enemies and player</span></div><div class="line">    drawEnemies(state, out);</div><div class="line">    drawPlayer(state, out);</div><div class="line">    drawPlayerStats(state, out);</div><div class="line">    <span class="comment">// set default colors and set cursor to the bottom</span></div><div class="line">    colorsDefault(out);</div><div class="line">    setCur(<span class="number">0</span>, state.h + <span class="number">2</span>, out);</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">exports.newScreen = <span class="function">(<span class="params">state, out</span>) =&gt;</span> &#123;</div><div class="line">    out = out || process.stdout;</div><div class="line">    <span class="comment">// draw a dot map for the whole render area</span></div><div class="line">    clearScreen(out);</div><div class="line">    setCur(<span class="number">1</span>, <span class="number">1</span>, out);</div><div class="line">    colorsSet(out);</div><div class="line">    drawDotMap(state, out);</div><div class="line">    <span class="comment">// first update</span></div><div class="line">    updateScreen(state, out);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="8-The-main-game-js-file-at-root"><a href="#8-The-main-game-js-file-at-root" class="headerlink" title="8 - The main game.js file at root"></a>8 - The main game.js file at root</h2><p>Now for the main game.js file that is called to get things started. Here I am suing my state module to load a game state file of there is one at the current working folder when the game starts. If not a new state and file is created.</p>
<p>The standard input is set to raw mode and I attach an event hander for the data event of the standard input via the process global. In the event hander for the data event I am using the input hander method in input.js that will handing the standard input, as well as fire some additional methods that i define here for when the player dies, and when a turn is over.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"> </div><div class="line"><span class="keyword">let</span> draw = <span class="built_in">require</span>(<span class="string">'./lib/draw.js'</span>),</div><div class="line">stateMod = <span class="built_in">require</span>(<span class="string">'./lib/state.js'</span>),</div><div class="line">inputHandler = <span class="built_in">require</span>(<span class="string">'./lib/input.js'</span>);</div><div class="line"> </div><div class="line">stateMod.loadState()</div><div class="line">.then(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">//set in raw mode and capture key strokes</span></div><div class="line">    process.stdin.setRawMode(<span class="literal">true</span>);</div><div class="line">    <span class="comment">// for each data event from the standard input</span></div><div class="line">    process.stdin.on(<span class="string">'data'</span>, (data) =&gt; &#123;</div><div class="line">        <span class="comment">// use the input handler</span></div><div class="line">        inputHandler(state, data.toString().trim(), &#123;</div><div class="line">            <span class="attr">onPlayerDead</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">                <span class="keyword">let</span> player = state.player;</div><div class="line">                <span class="keyword">if</span> (player.hp === <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">let</span> newState = stateMod.newState();</div><div class="line">                    state = <span class="built_in">Object</span>.assign(state, newState);</div><div class="line">                    draw.newScreen(state);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">onTurnOver</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</div><div class="line">                draw.updateScreen(state);</div><div class="line">                stateMod.saveState(state);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">    draw.newScreen(state);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="9-Conclusion"><a href="#9-Conclusion" class="headerlink" title="9 - Conclusion"></a>9 - Conclusion</h2><p>I had a general idea of what I wanted when I started working on this, and that is what this turned out to be. Of course there are all kinds of ideas that come to mind when it comes to continuing to work on this project, but I think that much of what that is should be a canvas game rather than a command line interface only type thing. However maybe it is not such a bad idea to keep working on this as a way to work out the core of what the logic is of a game itself.</p>
<p>Sense I wrote this post and project I have worked on a number of other simple nodejs examples, including one that is a more <a href="/2021/03/15/nodejs-example-simple-cli-interface/">basic starting point for a custom command line interface</a>. That post might prove to be a better read when it comes to learning how to get started from the ground up with something to this effect.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/" data-id="cl6gvo1e301i2r8v1h3j8p12t" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/03/16/js-line-break/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Add js line breaks to strings
        
      </div>
    </a>
  
  
    <a href="/2020/03/12/canvas-angle-shortest-direction/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Canvas angle get the shortest direction between two angles</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/index.html';
    this.page.identifier = '627';
    this.page.title = 'A simple nodejs powered RPG game';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.5px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.5px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.5px;">angular</a> <a href="/tags/animation/" style="font-size: 12px;">animation</a> <a href="/tags/automation/" style="font-size: 12px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.5px;">backbone</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.5px;">canvas</a> <a href="/tags/corejs/" style="font-size: 13px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 11px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.5px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.5px;">express</a> <a href="/tags/games/" style="font-size: 17px;">games</a> <a href="/tags/git/" style="font-size: 13px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 12px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.5px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.5px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.5px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.5px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.5px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.5px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.5px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.5px;">python</a> <a href="/tags/statistics/" style="font-size: 14px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/05/threejs-examples-camera-kit/">Camera Kit module threejs example</a>
          </li>
        
          <li>
            <a href="/2022/07/29/threejs-examples-aplerp/">An advanced Lerping module threejs example</a>
          </li>
        
          <li>
            <a href="/2022/07/22/threejs-capsule-geometry/">Capsule geometry in threejs</a>
          </li>
        
          <li>
            <a href="/2022/07/15/threejs-examples-object-grid-wrap-land/">THREEJS Looping land animation using the Object grid wrap module</a>
          </li>
        
          <li>
            <a href="/2022/07/08/threejs-examples-weird-face-one/">Weird face one threejs example</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS-Examples</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas-Examples</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2020/03/13/nodejs-example-simple-rpg-game/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>