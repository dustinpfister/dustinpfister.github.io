<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>Monster Smash canvas game example | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I will be making at least a few more canvas examples this summer, some of which I might continue developing if some people show interest in them. Last week I started working on one of many game protot">
<meta property="og:type" content="article">
<meta property="og:title" content="Monster Smash canvas game example">
<meta property="og:url" content="https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="I will be making at least a few more canvas examples this summer, some of which I might continue developing if some people show interest in them. Last week I started working on one of many game protot">
<meta property="og:updated_time" content="2021-02-19T17:07:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Monster Smash canvas game example">
<meta name="twitter:description" content="I will be making at least a few more canvas examples this summer, some of which I might continue developing if some people show interest in them. Last week I started working on one of many game protot">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas-Examples</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-canvas-example-grid-game-monster-smash" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/17/canvas-example-grid-game-monster-smash/" class="article-date"> Published:
  <time datetime="2020-08-17T15:21:00.000Z" itemprop="datePublished">2020-08-17</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2020/08/17/canvas-example-grid-game-monster-smash/" class="article-date"> Modified:
  <time datetime="2021-02-19T17:07:39.000Z" itemprop="dateModified">2021-02-19</time>
</a>

    <span class="article-date">V1.11</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/canvas/">canvas</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Monster Smash canvas game example
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>I will be making at least a few more <a href="/2020/03/23/canvas-example/">canvas examples</a> this summer, some of which I might continue developing if some people show interest in them. Last week I started working on one of many game prototype ideas that I am currently just calling Monster Smash. The general idea is not clear, aside from just some very vague concepts that have to do with just moving a player object inside a grid, and have enemies come to the location. I am thinking somewhat in terms of a kind or RPG style game like <a href="https://en.wikipedia.org/wiki/Dragon_Quest_%28video_game%29" target="_blank" rel="external">Dragon Warrior</a>, the early <a href="https://en.wikipedia.org/wiki/Pok%C3%A9mon_Red_and_Blue" target="_blank" rel="external">Pokemon games</a>, or some like of <a href="https://en.wikipedia.org/wiki/Roguelike" target="_blank" rel="external">Roguelike</a> game, but I am not so sure yet. That is okay though I can ways fork off of what I work out here as long as I get the very basic idea of what I want working.</p>
<p>I would like to have at least one canvas example that is just a nice little RPG style game where you move a player object around and battle enemies and level up. Nothing to ground breaking or exciting, just a nice little RPG like that of dragon warrior maybe.</p>
<a id="more"></a>
<p><div id="canvas-app"></div></p>
<script src="/js/canvas-examples/grid-game-monster-smash/0.2.0/pkg.js"></script>

<h2 id="1-The-utility-library"><a href="#1-The-utility-library" class="headerlink" title="1 - The utility library"></a>1 - The utility library</h2><p>To start things off I have a basic utility library for this canvas example. Here I have a distance formula, a method to get an angle to a point, and a method to help with getting a point relative to a canvas element rather than the window object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UTILS</span></div><div class="line"><span class="keyword">var</span> utils = &#123;&#125;;</div><div class="line"><span class="comment">// the distance formula</span></div><div class="line">utils.distance = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, x2, y2</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(x1 - x2, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(y1 - y2, <span class="number">2</span>));</div><div class="line">&#125;;</div><div class="line"><span class="comment">// get angle from one point to another</span></div><div class="line">utils.angleToPoint = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, x2, y2, scale</span>) </span>&#123;</div><div class="line">    scale = scale === <span class="literal">undefined</span> ? <span class="built_in">Math</span>.PI * <span class="number">2</span> : scale;</div><div class="line">    <span class="keyword">var</span> aTan = <span class="built_in">Math</span>.atan2(y1 - y2, x1 - x2);</div><div class="line">    <span class="keyword">return</span> (aTan + <span class="built_in">Math</span>.PI) / (<span class="built_in">Math</span>.PI * <span class="number">2</span>) * scale;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// get a point relative to a canvas element rather than window</span></div><div class="line">utils.getCanvasRelative = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> canvas = e.target,</div><div class="line">    bx = canvas.getBoundingClientRect();</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">x</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientX : e.clientX) - bx.left,</div><div class="line">        <span class="attr">y</span>: (e.changedTouches ? e.changedTouches[<span class="number">0</span>].clientY : e.clientY) - bx.top,</div><div class="line">        <span class="attr">bx</span>: bx</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="2-The-map-module"><a href="#2-The-map-module" class="headerlink" title="2 - The map module"></a>2 - The map module</h2><p>So then I have a module that will be used for creating a map object for this canvas example. The idea that I had in mind for this project is to have an array of map objects, bit I figure that everything that has to d with creating an mutating a collection of maps should be independent of a module that is used to do so with just one map object. So for now as of this writing the map module for this example is fairly simple and striped down, with just a hand full of usual methods for such a module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mapMod = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> createCells = <span class="function"><span class="keyword">function</span> (<span class="params">map</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cells = [];</div><div class="line">        <span class="keyword">var</span> len = map.w * map.h,</div><div class="line">        i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">            cells.push(&#123;</div><div class="line">                <span class="attr">i</span>: i,</div><div class="line">                <span class="attr">x</span>: i % map.w,</div><div class="line">                <span class="attr">y</span>: <span class="built_in">Math</span>.floor(i / map.w),</div><div class="line">                <span class="attr">unit</span>: <span class="literal">false</span> <span class="comment">// reference to current unit here or false if empty</span></div><div class="line">            &#125;);</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> cells;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// return a cell at the given position, or false for out of bounds values</span></div><div class="line">    api.get = <span class="function"><span class="keyword">function</span> (<span class="params">map, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt;= map.w || y &gt;= map.h) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> map.cells[y * map.w + x];</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get a cell in the current map by way of</span></div><div class="line">    <span class="comment">// a canvas relative x and y pixel pos</span></div><div class="line">    api.getCellByPointer = <span class="function"><span class="keyword">function</span> (<span class="params">map, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cx = <span class="built_in">Math</span>.floor((x - map.margin.x) / map.cellSize),</div><div class="line">        cy = <span class="built_in">Math</span>.floor((y - map.margin.y) / map.cellSize);</div><div class="line">        <span class="keyword">return</span> api.get(map, cx, cy)</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    api.create = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">var</span> map = &#123;</div><div class="line">            <span class="attr">w</span>: opt.w || <span class="number">9</span>,</div><div class="line">            <span class="attr">h</span>: opt.h || <span class="number">7</span>,</div><div class="line">            <span class="attr">cellSize</span>: <span class="number">32</span>,</div><div class="line">            <span class="attr">spawnEnabled</span>: opt.spawnEnabled || <span class="literal">false</span>,</div><div class="line">            <span class="attr">spawnLimit</span>: opt.spawnLimit || <span class="number">2</span>,</div><div class="line">            <span class="attr">spawnCells</span>: opt.spawnCells || [<span class="number">0</span>], <span class="comment">// cell index values where enemies can spawn</span></div><div class="line">            margin: &#123;</div><div class="line">                <span class="attr">x</span>: <span class="number">5</span>,</div><div class="line">                <span class="attr">y</span>: <span class="number">5</span></div><div class="line">            &#125;,</div><div class="line">            <span class="attr">cells</span>: []</div><div class="line">        &#125;;</div><div class="line">        map.cells = createCells(map);</div><div class="line">        <span class="keyword">return</span> map;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> api;</div><div class="line"> </div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="3-The-game-module"><a href="#3-The-game-module" class="headerlink" title="3 - The game module"></a>3 - The game module</h2><p>I will want to have a module that will act as a way to create a main state object for a game instance. In many of my canvas examples this kind of object is also the main object that will constitute a model for the whole of the state of the application, however in other projects, including this one, there is yet another object to which the game object is a part of.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gameMod = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// create a base unit object</span></div><div class="line">    <span class="keyword">var</span> createBaseUnit = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">HP</span>: <span class="number">100</span>,</div><div class="line">            <span class="attr">maxHP</span>: <span class="number">100</span>,</div><div class="line">            <span class="attr">weaponIndex</span>: <span class="number">0</span>,</div><div class="line">            <span class="attr">sheetIndex</span>: <span class="number">0</span>,</div><div class="line">            <span class="attr">currentCell</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">active</span>: <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// create an enemy Unit Object</span></div><div class="line">    <span class="keyword">var</span> createEnemyUnit = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> enemy = createBaseUnit();</div><div class="line">        enemy.sheetIndex = <span class="number">1</span>;</div><div class="line">        enemy.sight = <span class="number">3</span>; <span class="comment">// sight radius in cells</span></div><div class="line">        <span class="keyword">return</span> enemy;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// create a player unit</span></div><div class="line">    <span class="keyword">var</span> createPlayerUnit = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> player = createBaseUnit();</div><div class="line">        player.sheetIndex = <span class="number">0</span>; <span class="comment">// player sheet</span></div><div class="line">        <span class="keyword">return</span> player;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// create enemy pool</span></div><div class="line">    <span class="keyword">var</span> createEnemyUnitPool = <span class="function"><span class="keyword">function</span> (<span class="params">size</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> pool = [];</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; size) &#123;</div><div class="line">            pool.push(createEnemyUnit());</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pool;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> getActiveCount = <span class="function"><span class="keyword">function</span> (<span class="params">game, pool</span>) </span>&#123;</div><div class="line">        pool = pool || game.enemyPool;</div><div class="line">        <span class="keyword">return</span> pool.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">acc, obj</span>) </span>&#123;</div><div class="line">            acc = <span class="keyword">typeof</span> acc === <span class="string">'object'</span> ? !!acc.active : acc;</div><div class="line">            <span class="keyword">return</span> acc + !!obj.active;</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> spawnEnemy = <span class="function"><span class="keyword">function</span> (<span class="params">game</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> map = getCurrentMap(game),</div><div class="line">        e,</div><div class="line">        spawnCell = map.cells[map.spawnCells[<span class="number">0</span>]], <span class="comment">// just index 0 for now</span></div><div class="line">        activeCount;</div><div class="line">        <span class="keyword">if</span> (map.spawnEnabled) &#123;</div><div class="line">            activeCount = getActiveCount(game, game.enemyPool);</div><div class="line">            <span class="keyword">if</span> (activeCount &lt; map.spawnLimit &amp;&amp; spawnCell.unit === <span class="literal">false</span>) &#123;</div><div class="line">                e = getNextInactive(game, game.enemyPool);</div><div class="line">                <span class="keyword">if</span> (e) &#123;</div><div class="line">                    placeUnit(game, e, spawnCell.x, spawnCell.y);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get next inactive</span></div><div class="line">    <span class="keyword">var</span> getNextInactive = <span class="function"><span class="keyword">function</span> (<span class="params">game, pool</span>) </span>&#123;</div><div class="line">        pool = pool || game.enemyPool;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>,</div><div class="line">        len = pool.length;</div><div class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">            <span class="keyword">if</span> (!pool[i].active) &#123;</div><div class="line">                <span class="keyword">return</span> pool[i];</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// get the current map</span></div><div class="line">    <span class="keyword">var</span> getCurrentMap = <span class="function"><span class="keyword">function</span> (<span class="params">game</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> game.maps[game.mapIndex];</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// place a unit at a current map location</span></div><div class="line">    <span class="keyword">var</span> placeUnit = <span class="function"><span class="keyword">function</span> (<span class="params">game, unit, x, y</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> map = getCurrentMap(game);</div><div class="line">        <span class="keyword">var</span> newCell = mapMod.get(map, x, y);</div><div class="line">        <span class="keyword">if</span> (!unit) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (newCell) &#123;</div><div class="line">            <span class="comment">// clear old position if any</span></div><div class="line">            <span class="keyword">if</span> (unit.currentCell) &#123;</div><div class="line">                map.cells[unit.currentCell.i].unit = <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// make sure the unit is active</span></div><div class="line">            unit.active = <span class="literal">true</span>;</div><div class="line">            <span class="comment">// update to new location</span></div><div class="line">            unit.currentCell = newCell; <span class="comment">// unit ref to cell</span></div><div class="line">            map.cells[unit.currentCell.i].unit = unit; <span class="comment">// map ref to unit</span></div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// remove a unit from any map location it may be at</span></div><div class="line">    <span class="comment">// this will not destroy the object if it is part of a pool, or reference elsewhere</span></div><div class="line">    <span class="keyword">var</span> removeUnit = <span class="function"><span class="keyword">function</span> (<span class="params">game, unit</span>) </span>&#123;</div><div class="line">        unit.active = <span class="literal">false</span>;</div><div class="line">        getCurrentMap(game).cells[unit.currentCell.i].unit = <span class="literal">false</span>;</div><div class="line">        unit.currentCell = <span class="literal">false</span>;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// start game helper</span></div><div class="line">    <span class="keyword">var</span> setupGame = <span class="function"><span class="keyword">function</span> (<span class="params">game</span>) </span>&#123;</div><div class="line">        game.mapIndex = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> map = getCurrentMap(game);</div><div class="line">        placeUnit(game, game.player, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">        placeUnit(game, getNextInactive(game), <span class="number">5</span>, <span class="number">5</span>);</div><div class="line">        placeUnit(game, getNextInactive(game), <span class="number">2</span>, <span class="number">5</span>);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> moveEnemies = <span class="function"><span class="keyword">function</span> (<span class="params">game</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>,</div><div class="line">        cell,</div><div class="line">        radian,</div><div class="line">        map = getCurrentMap(game),</div><div class="line">        e,</div><div class="line">        cx,</div><div class="line">        cy,</div><div class="line">        p = game.player,</div><div class="line">        len = game.enemyPool.length;</div><div class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">            e = game.enemyPool[i];</div><div class="line">            <span class="keyword">if</span> (e.active) &#123;</div><div class="line">                cell = e.currentCell;</div><div class="line">                <span class="keyword">if</span> (utils.distance(cell.x, cell.y, p.currentCell.x, p.currentCell.y) &lt;= e.sight) &#123;</div><div class="line">                    radian = utils.angleToPoint(cell.x, cell.y, p.currentCell.x, p.currentCell.y);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    radian = <span class="built_in">Math</span>.PI * <span class="number">2</span> * <span class="built_in">Math</span>.random();</div><div class="line">                &#125;</div><div class="line">                cx = <span class="built_in">Math</span>.round(cell.x + <span class="built_in">Math</span>.cos(radian));</div><div class="line">                cy = <span class="built_in">Math</span>.round(cell.y + <span class="built_in">Math</span>.sin(radian));</div><div class="line">                <span class="comment">// get location before moving to it</span></div><div class="line">                <span class="keyword">var</span> newCell = mapMod.get(map, cx, cy);</div><div class="line">                <span class="comment">// if no unit just move there</span></div><div class="line">                <span class="keyword">if</span> (!newCell.unit) &#123;</div><div class="line">                    placeUnit(game, e, cx, cy);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            i += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> api = &#123;&#125;;</div><div class="line">    <span class="comment">// create a new game state</span></div><div class="line">    api.create = <span class="function"><span class="keyword">function</span> (<span class="params">opt</span>) </span>&#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">var</span> game = &#123;</div><div class="line">            <span class="attr">mode</span>: <span class="string">'map'</span>,</div><div class="line">            <span class="attr">maps</span>: [],</div><div class="line">            <span class="attr">mapIndex</span>: <span class="number">0</span>,</div><div class="line">            <span class="attr">targetCell</span>: <span class="literal">false</span>, <span class="comment">// a reference to the current target cell to move to, or false</span></div><div class="line">            player: createPlayerUnit(),</div><div class="line">            <span class="attr">kills</span>: <span class="number">0</span>,</div><div class="line">            <span class="attr">enemyPool</span>: createEnemyUnitPool(<span class="number">5</span>)</div><div class="line">        &#125;;</div><div class="line">        game.maps.push(mapMod.create(&#123;</div><div class="line">                <span class="attr">spawnEnabled</span>: <span class="literal">true</span></div><div class="line">            &#125;));</div><div class="line">        setupGame(game);</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> game;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// update a game state object</span></div><div class="line">    api.update = <span class="function"><span class="keyword">function</span> (<span class="params">game, secs</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cell,</div><div class="line">        map = getCurrentMap(game),</div><div class="line">        radian,</div><div class="line">        target;</div><div class="line"> </div><div class="line">        <span class="comment">// move player</span></div><div class="line">        <span class="keyword">if</span> (target = game.targetCell) &#123;</div><div class="line">            cell = game.player.currentCell;</div><div class="line">            <span class="keyword">if</span> (target != cell) &#123;</div><div class="line">                radian = utils.angleToPoint(cell.x, cell.y, target.x, target.y);</div><div class="line">                <span class="keyword">var</span> cx = <span class="built_in">Math</span>.round(cell.x + <span class="built_in">Math</span>.cos(radian)),</div><div class="line">                cy = <span class="built_in">Math</span>.round(cell.y + <span class="built_in">Math</span>.sin(radian));</div><div class="line">                <span class="comment">// get location before moving to it</span></div><div class="line">                <span class="keyword">var</span> newCell = mapMod.get(map, cx, cy);</div><div class="line">                <span class="comment">// if no unit just move there</span></div><div class="line">                <span class="keyword">if</span> (!newCell.unit) &#123;</div><div class="line">                    placeUnit(game, game.player, cx, cy);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="comment">// else there is an enemy there</span></div><div class="line">                    <span class="keyword">var</span> e = newCell.unit;</div><div class="line"> </div><div class="line">                    <span class="comment">// just step a kill count for now</span></div><div class="line">                    e.active = <span class="literal">false</span>;</div><div class="line">                    removeUnit(game, e);</div><div class="line">                    game.kills += <span class="number">1</span>;</div><div class="line">                    placeUnit(game, game.player, cx, cy);</div><div class="line">                &#125;</div><div class="line">                game.targetCell = <span class="literal">false</span>;</div><div class="line">                <span class="comment">// move active enemies</span></div><div class="line">                moveEnemies(game);</div><div class="line">                <span class="comment">// enemies might spawn per turn</span></div><div class="line">                spawnEnemy(game);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="comment">// return the public api</span></div><div class="line">    <span class="keyword">return</span> api;</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="4-The-draw-module-for-rendering-to-canvas"><a href="#4-The-draw-module-for-rendering-to-canvas" class="headerlink" title="4 - The draw module for rendering to canvas"></a>4 - The draw module for rendering to canvas</h2><p>So yes this is a canvas example, and as such I am going to want at least a little javaScript code that will be used to render to a canvas element. In very simple projects I might have this code dumped together with everything else, but for projects that are starting to get a little complex, or will get there at some point in the future it becomes important to pull this code out of a main.js file and into itâ€™s own module for the sake of readability of code.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> draw = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> unitColors = [<span class="string">'blue'</span>, <span class="string">'red'</span>];</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="comment">// draw background</span></div><div class="line">        back: <span class="function"><span class="keyword">function</span> (<span class="params">sm</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> canvas = sm.canvas,</div><div class="line">            ctx = sm.ctx;</div><div class="line">            ctx.fillStyle = <span class="string">'black'</span>;</div><div class="line">            ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</div><div class="line">        &#125;,</div><div class="line"> </div><div class="line">        <span class="comment">// draw a map</span></div><div class="line">        map: <span class="function"><span class="keyword">function</span> (<span class="params">sm</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> canvas = sm.canvas,</div><div class="line">            ctx = sm.ctx,</div><div class="line">            map = sm.game.maps[sm.game.mapIndex];</div><div class="line">            <span class="keyword">var</span> cs = map.cellSize,</div><div class="line">            i = <span class="number">0</span>,</div><div class="line">            x,</div><div class="line">            y,</div><div class="line">            len = map.cells.length,</div><div class="line">            cell;</div><div class="line">            <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">                cell = map.cells[i];</div><div class="line">                x = map.margin.x + cell.x * cs;</div><div class="line">                y = map.margin.y + cell.y * cs;</div><div class="line">                <span class="comment">// draw base cell</span></div><div class="line">                ctx.fillStyle = <span class="string">'green'</span>;</div><div class="line">                ctx.beginPath();</div><div class="line">                ctx.rect(x, y, <span class="number">32</span>, <span class="number">32</span>);</div><div class="line">                ctx.fill();</div><div class="line">                ctx.stroke();</div><div class="line">                <span class="comment">// if we have a unit</span></div><div class="line">                <span class="keyword">if</span> (cell.unit) &#123;</div><div class="line">                    <span class="keyword">if</span> (cell.unit.active) &#123;</div><div class="line">                        ctx.fillStyle = unitColors[cell.unit.sheetIndex];</div><div class="line">                        ctx.beginPath();</div><div class="line">                        ctx.rect(x, y, <span class="number">32</span>, <span class="number">32</span>);</div><div class="line">                        ctx.fill();</div><div class="line">                        ctx.stroke();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                i += <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line"> </div><div class="line">        <span class="attr">info</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> ctx = sm.ctx,</div><div class="line">            canvas = sm.canvas;</div><div class="line">            ctx.fillStyle = <span class="string">'white'</span>;</div><div class="line">            ctx.font = <span class="string">'10px courier'</span>;</div><div class="line">            ctx.textBaseline = <span class="string">'top'</span>;</div><div class="line">            <span class="keyword">var</span> pos = sm.input.pos;</div><div class="line">            ctx.fillText(<span class="string">'pointerDown: '</span> + sm.input.pointerDown + <span class="string">' pos: '</span> + pos.x + <span class="string">','</span> + pos.y, <span class="number">5</span>, <span class="number">5</span>);</div><div class="line">            ctx.fillText(<span class="string">'kills: '</span> + sm.game.kills, <span class="number">5</span>, <span class="number">15</span>);</div><div class="line">            ctx.fillText(<span class="string">'v'</span> + sm.ver, <span class="number">1</span>, canvas.height - <span class="number">11</span>);</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<h2 id="5-Main-js-the-start-of-a-state-machine-and-index-html"><a href="#5-Main-js-the-start-of-a-state-machine-and-index-html" class="headerlink" title="5 - Main.js, the start of a state machine, and index.html"></a>5 - Main.js, the start of a state machine, and index.html</h2><p>I have code that serves as a general application wide utility library, a map system, a game module, and a way to render to a canvas element. Now I just need a little additional code that will make use of all of this, and also provide any additional functionality.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>),</div><div class="line">    ctx = canvas.getContext(<span class="string">'2d'</span>),</div><div class="line">    container = <span class="built_in">document</span>.getElementById(<span class="string">'canvas-app'</span>) || <span class="built_in">document</span>.body;</div><div class="line">    container.appendChild(canvas);</div><div class="line">    canvas.width = <span class="number">320</span>;</div><div class="line">    canvas.height = <span class="number">240</span>;</div><div class="line">    ctx.translate(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> sm = &#123;</div><div class="line">        <span class="attr">ver</span>: <span class="string">'0.2.0'</span>,</div><div class="line">        <span class="attr">game</span>: gameMod.create(),</div><div class="line">        <span class="attr">canvas</span>: canvas,</div><div class="line">        <span class="attr">ctx</span>: ctx,</div><div class="line">        <span class="attr">input</span>: &#123;</div><div class="line">            <span class="attr">pointerDown</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">pos</span>: &#123;</div><div class="line">                <span class="attr">x</span>: <span class="number">0</span>,</div><div class="line">                <span class="attr">y</span>: <span class="number">0</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> pointerHanders = &#123;</div><div class="line">        <span class="attr">start</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm, e</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> pos = sm.input.pos;</div><div class="line">            sm.input.pointerDown = <span class="literal">true</span>;</div><div class="line"> </div><div class="line">            <span class="keyword">var</span> cell = mapMod.getCellByPointer(sm.game.maps[sm.game.mapIndex], pos.x, pos.y);</div><div class="line"> </div><div class="line">            <span class="keyword">if</span> (cell) &#123;</div><div class="line">                sm.game.targetCell = cell;</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">        &#125;,</div><div class="line">        <span class="attr">move</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm, e</span>) </span>&#123;&#125;,</div><div class="line">        <span class="attr">end</span>: <span class="function"><span class="keyword">function</span> (<span class="params">sm, e</span>) </span>&#123;</div><div class="line">            sm.input.pointerDown = <span class="literal">false</span>;</div><div class="line">            loop();</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> createPointerHandler = <span class="function"><span class="keyword">function</span> (<span class="params">sm, type</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            sm.input.pos = utils.getCanvasRelative(e);</div><div class="line">            pointerHanders[type](sm, e);</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    canvas.addEventListener(<span class="string">'mousedown'</span>, createPointerHandler(sm, <span class="string">'start'</span>));</div><div class="line">    canvas.addEventListener(<span class="string">'mousemove'</span>, createPointerHandler(sm, <span class="string">'move'</span>));</div><div class="line">    canvas.addEventListener(<span class="string">'mouseup'</span>, createPointerHandler(sm, <span class="string">'end'</span>));</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> loop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">//requestAnimationFrame(loop);</span></div><div class="line"> </div><div class="line">        gameMod.update(sm.game);</div><div class="line"> </div><div class="line">        draw.back(sm);</div><div class="line">        draw.map(sm);</div><div class="line">        draw.info(sm);</div><div class="line">    &#125;;</div><div class="line"> </div><div class="line">    loop();</div><div class="line"> </div><div class="line">&#125;</div><div class="line">    ());</div></pre></td></tr></table></figure>
<p>Here I have the html that will link to all the external javaScript code in order.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>canvas example monster smash<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"canvas-app"</span> <span class="attr">style</span>=<span class="string">"width:320px;height:240px;margin-left:auto;margin-right:auto;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/utils.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/map.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/game.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/draw.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6 - Conclusion"></a>6 - Conclusion</h2><p>So far this game is working more or less like what it is that I had in mind. I do have the current state of my todo lost when it comes to additional features with this one though. I would like for there to be more than one map that the player can move to, and there are additional states that i would like to add. As of this writing the player just kills enemies when the player object comes in contact with an enemy object, so obviously there is more work to do when it comes to turning this one into something that people might actually like to play.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/" data-id="ckx9e2czf00813kv1qb4emiah" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/08/26/js-javascript-example-skill-point-system/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Skill Point system
        
      </div>
    </a>
  
  
    <a href="/2020/08/11/js-javascript-example-grid-game-unit-movement/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">grid game unit movement javaScript example</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/index.html';
    this.page.identifier = '695';
    this.page.title = 'Monster Smash canvas game example';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 14.55px;">blog</a> <a href="/tags/canvas/" style="font-size: 19.09px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/express/" style="font-size: 16.36px;">express</a> <a href="/tags/games/" style="font-size: 16.82px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.09px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.27px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.18px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.09px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 17.73px;">phaser</a> <a href="/tags/python/" style="font-size: 15.45px;">python</a> <a href="/tags/statistics/" style="font-size: 13.64px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 18.64px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 15.91px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/10/js-javascript-example-turn-based-rpg/">Making a turn based RPG game javaScript project example</a>
          </li>
        
          <li>
            <a href="/2021/12/03/threejs-examples-menus/">Menus and crude state machine threejs example</a>
          </li>
        
          <li>
            <a href="/2021/11/26/linux-tar/">The Linux tar command for compressions files and folders</a>
          </li>
        
          <li>
            <a href="/2021/11/23/linux-tree/">The Linux tree command</a>
          </li>
        
          <li>
            <a href="/2021/11/19/linux-xxd/">The Linux xxd command for dumping hex to the standard output rather than text</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas-Examples</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2020/08/17/canvas-example-grid-game-monster-smash/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>