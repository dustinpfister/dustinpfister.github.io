/*
   canvas-example-clock-basic
   Copyright 2020 by Dustin Pfister
   https://raw.githubusercontent.com/dustinpfister/canvas-examples/master/LICENSE
 
   https://github.com/dustinpfister/canvas-examples
*/
var utils={};utils.createCanvas=function(opt){opt=opt||{};opt.container=opt.container||document.getElementById("canvas-app")||document.body;opt.canvas=document.createElement("canvas");opt.ctx=opt.canvas.getContext("2d");opt.canvas.className="canvas_example";opt.canvas.width=opt.width===undefined?320:opt.width;opt.canvas.height=opt.height===undefined?240:opt.height;opt.ctx.translate(.5,.5);opt.canvas.onselectstart=function(){return false};opt.container.appendChild(opt.canvas);return opt};var clockMod=function(){var pad=function(a){return String("00"+a).slice(-2)};var getTimeText=function(clock){return pad(clock.now.getHours())+" : "+pad(clock.now.getMinutes())+" : "+pad(clock.now.getSeconds())};var getDayStart=function(clock){return new Date(clock.now.getFullYear(),clock.now.getMonth(),clock.now.getDate(),0,0,0,0)};return{create:function(date){var clock={ver:"0.2.0"};clock.now=date||new Date(0);clock.timeText=getTimeText(clock);var dayStart=getDayStart(clock);clock.dayPer=(clock.now-dayStart)/864e5;clock.secPer=clock.now.getMilliseconds()/1e3;clock.minPer=clock.now.getSeconds()/60;clock.hourPer=clock.now.getMinutes()/60;clock.AMPMPer=clock.now.getHours()%12/12;return clock}}}();var draw={};draw.clear=function(canvas,ctx){ctx.clearRect(0,0,canvas.width,canvas.height)};draw.clockText=function(canvas,ctx,clock){ctx.lineWidth=1;ctx.fillStyle="white";ctx.strokeStyle="black";ctx.font="40px arial";ctx.textBaseline="middle";ctx.textAlign="center";var text=Math.floor(clock.dayPer*100)+"%";ctx.fillText(text,canvas.width/2,canvas.height/2-20);ctx.strokeText(text,canvas.width/2,canvas.height/2-20);ctx.font="20px arial";ctx.fillText(clock.timeText,canvas.width/2,canvas.height/2+20);ctx.strokeText(clock.timeText,canvas.width/2,canvas.height/2+20)};draw.mark=function(canvas,ctx,i,style,lineWidth){var radian=Math.PI*2/12*i,cx=canvas.width/2,cy=canvas.height/2;ctx.save();ctx.translate(cx,cy);ctx.rotate(radian);ctx.beginPath();ctx.moveTo((canvas.height-50)/3,0);ctx.lineTo((canvas.height-50)/2,0);ctx.strokeStyle=style;ctx.lineWidth=lineWidth;ctx.stroke();ctx.restore()};draw.hourMarks=function(canvas,ctx,clock){var i=0,len=12,radian;while(i<len){draw.mark(canvas,ctx,i,"white",4);draw.mark(canvas,ctx,i,"black",2);i+=1}};draw.hands=function(canvas,ctx,clock){ctx.strokeStyle="rgba(0,0,0,0.5)";"secPer,minPer,hourPer,AMPMPer".split(",").forEach(function(perName,i){var r=Math.PI*2*clock[perName]-Math.PI/2,radius=(canvas.height-50-100*(i/4))/2,cx=canvas.width/2,cy=canvas.height/2;ctx.lineWidth=3;ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(cx+Math.cos(r)*radius,cy+Math.sin(r)*radius);ctx.stroke()})};draw.info=function(ctx,canvas,clock){ctx.fillStyle="grey";ctx.textBaseline="top";ctx.font="10px courier";ctx.textAlign="left";ctx.fillText("v"+clock.ver,10,10)};draw.clockDayCircle=function(canvas,ctx,clock){var r=Math.PI*2*clock.dayPer;ctx.lineWidth=7;ctx.strokeStyle="grey";ctx.beginPath();ctx.arc(canvas.width/2,canvas.height/2,(canvas.height-50)/2,0,Math.PI*2);ctx.stroke();ctx.strokeStyle="red";ctx.beginPath();ctx.arc(canvas.width/2,canvas.height/2,(canvas.height-50)/2,0,r);ctx.stroke()};var canvasObj=utils.createCanvas(),canvas=canvasObj.canvas,ctx=canvasObj.ctx;var loop=function(){requestAnimationFrame(loop);var clock=clockMod.create(new Date);draw.clear(canvas,ctx);draw.hourMarks(canvas,ctx,clock);draw.hands(canvas,ctx,clock);draw.clockDayCircle(canvas,ctx,clock);draw.clockText(canvas,ctx,clock);draw.info(ctx,canvas,clock)};loop();
