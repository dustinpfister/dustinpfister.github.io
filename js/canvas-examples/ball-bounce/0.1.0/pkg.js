/*
   canvas-example-ball-bounce
   Copyright 2020 by Dustin Pfister
   https://raw.githubusercontent.com/dustinpfister/canvas-examples/master/LICENSE
 
   https://github.com/dustinpfister/canvas-examples
*/
var utils={};utils.createCanvas=function(opt){opt=opt||{};opt.container=opt.container||document.getElementById("canvas-app")||document.body;opt.canvas=document.createElement("canvas");opt.ctx=opt.canvas.getContext("2d");opt.canvas.className="canvas_example";opt.canvas.width=opt.width===undefined?320:opt.width;opt.canvas.height=opt.height===undefined?240:opt.height;opt.ctx.translate(.5,.5);opt.canvas.onselectstart=function(){return false};opt.container.appendChild(opt.canvas);return opt};var b={};b.createBallObject=function(opt){var ball={};opt=opt||{};ball.x=opt.x===undefined?0:opt.x;ball.y=opt.y===undefined?0:opt.y;ball.r=opt.r===undefined?5:opt.r;ball.h=opt.h===undefined?0:opt.h;ball.d=opt.d===undefined?0:opt.d;return ball};b.createBallCollection=function(opt){var noop=function(ball,i){ball.x=ball.r+ball.r*3*i;ball.y=ball.r},i,ball,balls;opt=opt||{};opt.r=opt.r===undefined?5:opt.r;opt.h=opt.h===undefined?5:opt.h;opt.count=opt.count===undefined?4:opt.count;opt.forBall=opt.forBall===undefined?noop:opt.forBall;i=0;balls=[];while(i<opt.count){ball=b.createBallObject({r:opt.r,h:opt.h,d:opt.d});opt.forBall(ball,i,opt);balls.push(ball);i+=1}return{ver:"0.1.0",balls:balls}};b.moveBallObject=function(ball,canvas){canvas=canvas||{width:320,height:240};ball.x+=Math.cos(ball.h)*ball.d;ball.y+=Math.sin(ball.h)*ball.d;if(ball.y>=canvas.height-ball.r){ball.y=canvas.height-ball.r;ball.h=ball.h*-1}if(ball.y<=ball.r){ball.y=ball.r;ball.h=ball.h*-1}if(ball.x>=canvas.width-ball.r){ball.x=canvas.width-ball.r;ball.h=(ball.h+Math.PI)*-1}if(ball.x<=ball.r){ball.x=ball.r;ball.h=(ball.h+Math.PI)*-1}};var draw={};draw.ballObject=function(ctx,ball){var x,y;ctx.fillStyle="lime";ctx.strokeStyle="white";ctx.lineWidth=3;ctx.beginPath();ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);ctx.fill();ctx.stroke();ctx.beginPath();ctx.moveTo(ball.x,ball.y);x=Math.cos(ball.h)*ball.r*2+ball.x;y=Math.sin(ball.h)*ball.r*2+ball.y;ctx.lineTo(x,y);ctx.stroke()};draw.ballCollection=function(ctx,canvas,ballCollection){ballCollection.balls.forEach(function(ball){draw.ballObject(ctx,ball)});ctx.fillStyle="white";ctx.textBaseline="top";ctx.font="10px courier";ctx.fillText("v"+ballCollection.ver,10,canvas.height-15)};var canvasObj=utils.createCanvas();var canvas=canvasObj.canvas;var ctx=canvasObj.ctx;var ballCollection=b.createBallCollection({count:4,r:20,d:1,forBall:function(ball,i,opt){var space=3.5;ball.x=canvas.width/2-ball.r*space*opt.count/2+ball.r*(space/2)+ball.r*i*space;ball.y=canvas.height/2;ball.h=Math.PI*2/opt.count*i+Math.PI*.25}});var loop=function(){var i;requestAnimationFrame(loop);ctx.fillStyle="black";ctx.fillRect(0,0,canvas.width,canvas.height);draw.ballCollection(ctx,canvas,ballCollection);i=0;while(i<ballCollection.balls.length){b.moveBallObject(ballCollection.balls[i],canvas);i+=1}};loop();
