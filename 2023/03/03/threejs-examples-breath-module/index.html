<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>A Breath Module threejs project example | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I made a javaScript module that can be used as a core tool in the process of making a number of video projects that are controlled breathing exercises. The core idea of these kinds of videos is to hav">
<meta property="og:type" content="article">
<meta property="og:title" content="A Breath Module threejs project example">
<meta property="og:url" content="https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="I made a javaScript module that can be used as a core tool in the process of making a number of video projects that are controlled breathing exercises. The core idea of these kinds of videos is to hav">
<meta property="og:updated_time" content="2023-04-11T15:04:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Breath Module threejs project example">
<meta name="twitter:description" content="I made a javaScript module that can be used as a core tool in the process of making a number of video projects that are controlled breathing exercises. The core idea of these kinds of videos is to hav">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image, as well as the link to my youtube -->
        <a href="https://www.youtube.com/user/javaweaver"><div class="selfimage"></div></a>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas</a>
        
          <a class="main-nav-link" href="https://www.youtube.com/user/javaweaver">Youtube</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-threejs-examples-breath-module" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/03/03/threejs-examples-breath-module/" class="article-date"> Published:
  <time datetime="2023-03-03T13:45:00.000Z" itemprop="datePublished">2023-03-03</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2023/03/03/threejs-examples-breath-module/" class="article-date"> Modified:
  <time datetime="2023-04-11T15:04:52.000Z" itemprop="dateModified">2023-04-11</time>
</a>

    <span class="article-date">V1.16</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/three-js/">three.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      A Breath Module threejs project example
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>I made a javaScript module that can be used as a core tool in the process of making a number of video projects that are controlled breathing exercises. The core idea of these kinds of videos is to have a number of objects update in such a way that they are in sycn with a rate at which people watching the video are to breathe. The goal of watching these kinds of videos is to change what is often called <a href="https://en.wikipedia.org/wiki/Heart_rate_variability" target="_blank" rel="external">Heart Rate Variability</a> in a way that will help reduce blood pressure, anxiety, depression and thus allow for greater preformance with work, play, or anyting that one would like to focus on for that matter. A good example of the kind of videos that I would like to make using this can be <a href="https://www.youtube.com/watch?v=_o-ERqoTAhA" target="_blank" rel="external">found on the youtube channel mind drip</a>. This channel also has a <a href="https://www.youtube.com/watch?v=zUyuUoU7lAQ" target="_blank" rel="external">nice video that explains what HRV is about</a> for people that are new to what this is.</p>
<p>So there is a lot of little details that come up when making a javaScript module to update things in an over all scene object. There is for example how many breaths per minute, how many minutes, and also other details about each breath cycle. Details for each breath cycle are things like what is the ratio of time for each opening rest, breathe in, high rest, and breathe out part of a total breath cycle. There are also a lot of things that come to mind when it comes to having an expression for the alpha values that will be used to position objects, and also update just about everything else in an over all scene object. However that would be about it when it comes to the core set of features that I would want working with this project. That is to just have some decent logic worked out to update alpha values as the other features outside of that will change from one project to the next.</p>
<a id="more"></a>
<iframe class="youtube_video" src="https://www.youtube.com/embed/wyAkD9c64SU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<h2 id="The-breath-module-example-and-what-to-know-first"><a href="#The-breath-module-example-and-what-to-know-first" class="headerlink" title="The breath module example and what to know first"></a>The breath module example and what to know first</h2><p>This is a blog post on a javaScript IIFE form module <a href="/2021/02/19/threejs-examples/">threejs project example</a>, and several demos of the module, that work on top of threejs in a front end javaScript environment. It should go without saying but I have to say it in each of these posts, this is not a <a href="/2018/04/04/threejs-getting-started/">post for people that are new to threejs</a> let alone javaScript in general. I assume that you have at least a fair amount of experience with the skills that are required before hand to get something of values from reading this. Still in any case I do use these opening sections to write about a few things that you might want to read up more on regardless of experience.</p>
<h3 id="Study-More-on-HRV-Breathing"><a href="#Study-More-on-HRV-Breathing" class="headerlink" title="Study More on HRV Breathing"></a>Study More on HRV Breathing</h3><p>In this blog post I am writing about a javaScript module, and additional code that is demos that work on top of this module. If you want to learn more about HRV there this is a Ted Talk video with a <a href="https://uk.linkedin.com/in/dralanwatkins?trk=public_post_feed-actor-name" target="_blank" rel="external">Dr Alan Watkins</a> that I watched that really helped me to get started with this kind of exercise.</p>
<iframe class="youtube_video" src="https://www.youtube.com/embed/q06YIWCR2Js" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<p>If you do not want to watch this whole video as well as <a href="https://www.youtube.com/watch?v=Q_fFattg8N0&amp;t" target="_blank" rel="external">part 2</a> after that the general idea is this: The current state of Physiology can lead to poor Emotions, which can lead to toxic thoughts, that are then detramentail to performance. By way of HRV breathing exercise Physiology can change which can then cause everything else up the ladder to also change into a more desirable state that can help improve performance.</p>
<h3 id="Source-code-is-up-on-Github"><a href="#Source-code-is-up-on-Github" class="headerlink" title="Source code is up on Github"></a>Source code is up on Github</h3><p>I have the current source code for this module and the demos up on my <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/forpost/threejs-examples-breath-module" target="_blank" rel="external">test threejs repository</a> on Github. This is also where I place the source code examples that show up in all my <a href="/categories/three-js/">other blog posts on threejs</a> as well.</p>
<h3 id="Version-numbers-matter-IIFE-and-JSM"><a href="#Version-numbers-matter-IIFE-and-JSM" class="headerlink" title="Version numbers matter, IIFE and JSM"></a>Version numbers matter, IIFE and JSM</h3><p>As of this writing I still follow the old <a href="/2020/02/04/js-iife/">IIFE pattern</a> for making javaScript modules which is in line with the use of three.min.js over that of three.module.js. However at some point in the not to distance future I will have to start wiring new modules and updating old ones in the JSM format.</p>
<p>When I first wrote this blog post and made the first version of this module I was using <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/demos/r146/README.md" target="_blank" rel="external">r146 of threejs and thus follow that style rules I set for that revision</a>. The plan with new posts and editing older posts is to stick with this well into this coming year, but still the days with this kind of style are very much coming to an end. The three.min.js files that I have been using are very much on the chopping block it would seem, so at some point I am going to need to start including JSM versions of my module for people that want to use bleeding edge revisions of threejs.</p>
<p>In any case always be mindful of what revision of threejs that you are using when trying to get code examples such as the ones I am writing about here to work on your end. Code breaking changes are made to threejs all the time so it often is best to stick with the revisions that I am using with these examples. Also I have found that it is a good idea to be aware of what kind of GPU you are using on your system and what the support is for OpenGL and therefor WebGl features. I like working on Raspberry PI OS and thus also have to deal with the limitations of the VideoCore VI GPU of the Raspberry PI 4. In <a href="https://github.com/dustinpfister/test_threejs/blob/master/views/demos/r150/README.md" target="_blank" rel="external">r150 of the library</a> the WebGLRenderer has totally crashed and burned which cased me to start plaing future <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/demos/r149/README.md" target="_blank" rel="external">code style rules with r149</a>. Simply put in general version numbers very much matter with this stuff, and not just with threejs alone.</p>
<h2 id="1-Reduction-of-Complexity-but-added-better-hooks-and-alphas-in-R1"><a href="#1-Reduction-of-Complexity-but-added-better-hooks-and-alphas-in-R1" class="headerlink" title="1 - Reduction of Complexity, but added better hooks and alphas in R1"></a>1 - Reduction of Complexity, but added better hooks and alphas in R1</h2><p>After using this module for a few video projects thus far I have found that I should remove the groups of objects that are updated using curves. It is not that I do not like what I worked out with that, it is just that I think that the main focus of this module should just be to update alpha values over time. What I then do with these alpha values will change up from one project to the next so having something baked into the module itself adds unnecessary complexity. </p>
<p>So for R1 of breath.js everything that has to do with this curve group that was in R0 has been removed. New options have been added that allow for doing everything in a single update hook if I want, and there are a few alpha values to work with in this hook function. For now there is just a before hook that is called before the current breath part hook, but I called it that rather than update as I may add an after hook in future revisions.</p>
<h3 id="1-a-The-breath-js-module-R1"><a href="#1-a-The-breath-js-module-R1" class="headerlink" title="1.a - The breath.js module ( R1 )"></a>1.a - The breath.js module ( R1 )</h3><p>The Public API of R1 of breath.js still just has a a create and update method. The create method still returns an instance of THREE.Group as this is still a refactoring of what I started with in R0 and have not at this point decided to reduce the return value to a plain old regular javaScript object. In future revisions I might add a few more public methods that maybe have to do with debugging things, or knowing what the current state is of a video. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// breath.js - r1 - from threejs-examples-breath-module</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">api</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> BREATH_KEYS = <span class="string">'restLow,breathIn,restHigh,breathOut'</span>.split(<span class="string">','</span>);</div><div class="line">    <span class="keyword">const</span> BREATH_DISP_NAMES = <span class="string">'rest low, breath in, rest high, breath out'</span>.split(<span class="string">','</span>);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// DEFAULTS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> DEFAULT_BREATH_PARTS = &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">5</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">const</span> DEFAULT_HOOKS = &#123;</div><div class="line">        <span class="attr">restLow</span> : <span class="function">(<span class="params">group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;&#125;,</div><div class="line">        <span class="attr">restHigh</span> : <span class="function">(<span class="params">group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;&#125;,</div><div class="line">        <span class="attr">breathIn</span> : <span class="function">(<span class="params">group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;&#125;,</div><div class="line">        <span class="attr">breathOut</span> : <span class="function">(<span class="params">group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;&#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// get the sum of a breath parts object</span></div><div class="line">    <span class="keyword">const</span> getBreathPartsSum = <span class="function">(<span class="params">breathParts</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.keys( breathParts ).reduce( <span class="function">(<span class="params"> acc, key </span>) =&gt;</span> &#123; <span class="keyword">return</span> acc + breathParts[key]; &#125;, <span class="number">0</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get the alpha value targets for each breath part</span></div><div class="line">    <span class="keyword">const</span> getBreathAlphaTargets = <span class="function">(<span class="params">breathParts</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> BREATH_KEYS.reduce(<span class="function">(<span class="params">acc, key, i, arr</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">let</span> a = breathParts[ key ];</div><div class="line">            <span class="keyword">if</span>(i &gt; <span class="number">0</span>)&#123;</div><div class="line">                a += acc[i - <span class="number">1</span>]</div><div class="line">            &#125;</div><div class="line">            acc.push( a );</div><div class="line">            <span class="keyword">return</span> acc;</div><div class="line">        &#125;, []).map(<span class="function">(<span class="params">n</span>)=&gt;</span>&#123;</div><div class="line">            <span class="keyword">return</span> n / getBreathPartsSum(breathParts);</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a breath parts string for display</span></div><div class="line">    <span class="keyword">const</span> getBreathPartsString = <span class="function">(<span class="params">group</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.keys(gud.breathParts).reduce( <span class="function">(<span class="params">acc, key, i</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">const</span> n = gud.breathParts[key];</div><div class="line">            <span class="keyword">const</span> a = n / gud.breathPartsSum;</div><div class="line">            <span class="keyword">const</span> s = gud.secsPerBreathCycle * a;</div><div class="line">            acc += s.toFixed(<span class="number">2</span>) + <span class="string">'s '</span> + BREATH_DISP_NAMES[i] + (i === <span class="number">3</span> ? <span class="string">''</span> : <span class="string">', '</span>);</div><div class="line">            <span class="keyword">return</span> acc;</div><div class="line">        &#125;, <span class="string">''</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">const</span> secsToTimeStr = <span class="function">(<span class="params">totalSecs</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> minutes = <span class="built_in">Math</span>.floor( totalSecs / <span class="number">60</span> );</div><div class="line">        <span class="keyword">const</span> secs = <span class="built_in">Math</span>.floor(totalSecs % <span class="number">60</span>);</div><div class="line">        <span class="keyword">return</span> <span class="built_in">String</span>(minutes).padStart(<span class="number">2</span>, <span class="string">'0'</span>) + <span class="string">':'</span> + <span class="built_in">String</span>(secs).padStart(<span class="number">2</span>, <span class="string">'0'</span>)</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// PUBLIC API</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// main update method</span></div><div class="line">    api.update = <span class="function">(<span class="params">group, a_fullvid</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        gud.a_fullvid = a_fullvid;</div><div class="line">        gud.sec = gud.totalBreathSecs * gud.a_fullvid;</div><div class="line">        gud.timeString = secsToTimeStr(gud.sec);</div><div class="line">        gud.a_breath = (gud.sec % <span class="number">60</span> / <span class="number">60</span>) * gud.breathsPerMinute % <span class="number">1</span>;</div><div class="line">        gud.rest = <span class="literal">true</span>;</div><div class="line">        gud.breath = <span class="literal">false</span>;</div><div class="line">        gud.low = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">let</span> ki = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(ki &lt; BREATH_KEYS.length)&#123;</div><div class="line">            <span class="keyword">if</span>(gud.a_breath &lt; gud.breathAlphaTargts[ki])&#123;</div><div class="line">                gud.a_base = ki &gt; <span class="number">0</span> ? gud.breathAlphaTargts[ki - <span class="number">1</span>] : <span class="number">0</span>;</div><div class="line">                gud.a_breathPart = (gud.a_breath - gud.a_base) / (gud.breathAlphaTargts[ki] - gud.a_base);</div><div class="line">                gud.currentBreathKey = BREATH_KEYS[ki]</div><div class="line">                <span class="keyword">if</span>( gud.currentBreathKey === <span class="string">'restLow'</span>)&#123;</div><div class="line">                    gud.a_breath_state = <span class="number">0</span>;</div><div class="line">                    gud.low = <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>( gud.currentBreathKey === <span class="string">'restHigh'</span>)&#123;</div><div class="line">                    gud.a_breath_state = <span class="number">1</span>;</div><div class="line">                    gud.low = <span class="literal">false</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>( gud.currentBreathKey === <span class="string">'breathIn'</span>)&#123;</div><div class="line">                    gud.a_breath_state = <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * gud.a_breathPart);</div><div class="line">                    gud.rest = <span class="literal">false</span>;</div><div class="line">                    gud.breath = <span class="literal">true</span>;</div><div class="line">                    gud.low = <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>( gud.currentBreathKey === <span class="string">'breathOut'</span>)&#123;</div><div class="line">                    gud.a_breath_state = <span class="number">1</span> - <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * gud.a_breathPart);</div><div class="line">                    gud.rest = <span class="literal">false</span>;</div><div class="line">                    gud.breath = <span class="literal">true</span>;</div><div class="line">                    gud.low = <span class="literal">false</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// call before hook</span></div><div class="line">                gud.before(group, gud.a_breath, gud.a_breath_state, gud.a_fullvid, gud.a_breathPart, gud.currentBreathKey, gud);</div><div class="line">                <span class="comment">// call the current breath hook</span></div><div class="line">                <span class="keyword">const</span> hook = gud.hooks[ gud.currentBreathKey ];</div><div class="line">                hook(group, gud.a_breathPart, gud.a_fullvid, gud);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            ki += <span class="number">1</span>;;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// main create method</span></div><div class="line">    api.create = <span class="function">(<span class="params">opt</span>) =&gt;</span> &#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">const</span> group = <span class="keyword">new</span> THREE.Group();</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        gud.totalBreathSecs = opt.totalBreathSecs === <span class="literal">undefined</span> ? <span class="number">300</span> : opt.totalBreathSecs;</div><div class="line">        gud.breathsPerMinute = opt.breathsPerMinute === <span class="literal">undefined</span> ? <span class="number">5</span> : opt.breathsPerMinute;</div><div class="line">        gud.breathParts = opt.breathParts || DEFAULT_BREATH_PARTS;</div><div class="line">        gud.breathAlphaTargts = getBreathAlphaTargets(gud.breathParts);</div><div class="line">        gud.before = opt.before || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        gud.hooks = <span class="built_in">Object</span>.assign(&#123;&#125;, DEFAULT_HOOKS , opt.hooks );</div><div class="line">        gud.id = opt.id || <span class="string">'1'</span>;</div><div class="line">        gud.sec = <span class="number">0</span>;</div><div class="line">        <span class="comment">// set in api.update</span></div><div class="line">        gud.currentBreathKey = <span class="string">''</span>;</div><div class="line">        gud.a_fullvid = <span class="number">0</span>;</div><div class="line">        gud.a_base = <span class="number">0</span>;</div><div class="line">        gud.a_breathPart = <span class="number">0</span>;  <span class="comment">// alpha value of the current breath part</span></div><div class="line">        gud.a_breath = <span class="number">0</span>;</div><div class="line">        gud.a_breath_state = <span class="number">0</span>;</div><div class="line">        <span class="comment">// booleans that can be used in hooks</span></div><div class="line">        gud.rest = <span class="literal">false</span>;</div><div class="line">        gud.breath = <span class="literal">false</span>;</div><div class="line">        gud.low = <span class="literal">false</span>;</div><div class="line">        <span class="comment">// display values</span></div><div class="line">        gud.breathPartsSum = getBreathPartsSum(gud.breathParts);</div><div class="line">        gud.secsPerBreathCycle = <span class="number">60</span> / gud.breathsPerMinute;</div><div class="line">        gud.breathPartsString = getBreathPartsString(group);</div><div class="line">        gud.totalTimeString = secsToTimeStr(gud.totalBreathSecs);</div><div class="line">        gud.timeString = secsToTimeStr(gud.sec);</div><div class="line">        <span class="comment">// update and return</span></div><div class="line">        api.update(group, <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> group;</div><div class="line">    &#125;;</div><div class="line">&#125;(<span class="keyword">this</span>[<span class="string">'BreathMod'</span>] = &#123;&#125; ));</div></pre></td></tr></table></figure>
<h3 id="1-1-update-hooks-demo"><a href="#1-1-update-hooks-demo" class="headerlink" title="1.1 - update hooks demo"></a>1.1 - update hooks demo</h3><p>I thus far have just one demo of R1 of the breath module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add( <span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>) );</div><div class="line"><span class="keyword">const</span> geo = <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">1</span>, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"><span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshNormalMaterial();</div><div class="line"><span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh( geo, material);</div><div class="line">mesh1.position.z = <span class="number">-4</span>;</div><div class="line">scene.add(mesh1);</div><div class="line"><span class="keyword">const</span> mesh2 = <span class="keyword">new</span> THREE.Mesh( geo, material);</div><div class="line">mesh2.position.z = <span class="number">-2</span>;</div><div class="line">scene.add(mesh2);</div><div class="line"><span class="keyword">const</span> mesh3 = <span class="keyword">new</span> THREE.Mesh( geo, material);</div><div class="line">mesh3.position.z = <span class="number">0</span>;</div><div class="line">scene.add(mesh3);</div><div class="line"><span class="keyword">const</span> mesh4 = <span class="keyword">new</span> THREE.Mesh( geo, material);</div><div class="line">mesh4.position.z = <span class="number">2</span>;</div><div class="line">scene.add(mesh4);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// BREATH GROUP - creating with default settings</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> BREATH_SECS = <span class="number">60</span>;</div><div class="line"><span class="keyword">const</span> group = BreathMod.create(&#123;</div><div class="line">    <span class="attr">totalBreathSecs</span>: BREATH_SECS,</div><div class="line">    <span class="attr">breathsPerMinute</span>: <span class="number">6</span>,</div><div class="line">    <span class="attr">breathParts</span>: &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">7</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">3</span>&#125;,</div><div class="line">    <span class="attr">before</span>: <span class="function">(<span class="params">group, a_breath, a_state, a_fullvid, a_breath_part, breathPart, gud</span>) =&gt;</span> &#123;</div><div class="line">        mesh1.position.x = <span class="number">-5</span> + <span class="number">10</span> * a_breath;</div><div class="line">        mesh2.position.x = <span class="number">-5</span> + <span class="number">10</span> * a_state;</div><div class="line">        mesh3.position.x = <span class="number">-5</span> + <span class="number">10</span> * a_fullvid;</div><div class="line">        mesh4.position.x = <span class="number">-5</span> + <span class="number">10</span> * a_breath_part;</div><div class="line">        scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">        <span class="keyword">if</span>(gud.breath)&#123;</div><div class="line">            scene.background = <span class="keyword">new</span> THREE.Color(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">scene.add(group);</div><div class="line"><span class="keyword">const</span> gud = group.userData;</div><div class="line"><span class="built_in">console</span>.log(gud.secsPerBreathCycle)</div><div class="line"><span class="built_in">console</span>.log(gud.breathPartsString);</div><div class="line"><span class="built_in">console</span>.log(gud.totalTimeString);</div><div class="line"><span class="built_in">console</span>.log(gud.timeString);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> FPS_UPDATE = <span class="number">30</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">FRAME_MAX = <span class="number">30</span> * BREATH_SECS;</div><div class="line"><span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">frame = <span class="number">0</span>,</div><div class="line">lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="comment">// update</span></div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = frame / frameMax;</div><div class="line">    <span class="keyword">const</span> a_breathPart = a1;</div><div class="line">    <span class="keyword">const</span> a_breath = <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart);</div><div class="line">    BreathMod.update(group, a_breath);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// loop</span></div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render</span></div><div class="line">        update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        frame += FPS_MOVEMENT * secs;</div><div class="line">        frame %= FRAME_MAX;</div><div class="line">        lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div></pre></td></tr></table></figure>
<h2 id="2-The-First-version-of-the-breath-module-and-some-demos"><a href="#2-The-First-version-of-the-breath-module-and-some-demos" class="headerlink" title="2 - The First version of the breath module, and some demos"></a>2 - The First version of the breath module, and some demos</h2><p>There is then covering the state of the breath module itself, and then also getting into a few demos as a way to test drive what I have thus far. With that said there are two general public methods of interest one of which is used to create an <a href="/2018/05/16/threejs-grouping-mesh-objects/">instance of THREE.Group</a>, with a whole bunch of useful data attached to the <a href="/2021/02/16/threejs-userdata/">user data object</a> of this group which is very much there for these kinds of projects. The other public method if interest is used to update the state of these values.</p>
<p>This far the module seems to work okay with what I have in mid thus far, and as of now the current panes for future revisions have to do with reducing complexity actually rather than adding features.</p>
<h3 id="2-a-Breath-js-R0"><a href="#2-a-Breath-js-R0" class="headerlink" title="2.a - Breath.js R0"></a>2.a - Breath.js R0</h3><p>The current state of the source code of the module is broken down into three general parts thus far. One part is for defaults and constant values for versions things over the body of the source code. ANother part has to do with private helper functions that are used as tools for the final part which is the pubic API of the module.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// breath.js - r0 - from threejs-examples-breath-module</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">api</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> BREATH_KEYS = <span class="string">'restLow,breathIn,restHigh,breathOut'</span>.split(<span class="string">','</span>);</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// DEFAULTS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="keyword">const</span> DEFAULT_BREATH_PARTS = &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">5</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">5</span>&#125;;</div><div class="line">    <span class="keyword">const</span> DEFAULT_CURVE_UPDATE = <span class="function">(<span class="params">curve, alpha, v_c1, v_c2, v_start, v_end, gud, group</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> e1 = <span class="keyword">new</span> THREE.Euler();</div><div class="line">        e1.z = <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">90</span> * alpha;</div><div class="line">        v_c1.copy( v_start.clone().lerp(v_end, <span class="number">0.25</span>).applyEuler(e1).multiplyScalar(<span class="number">1</span> + <span class="number">0.5</span> * alpha) );</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">const</span> DEFAULT_MESH_UPDATE = <span class="function">(<span class="params">mesh, curve, alpha, index, count, group</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> a_meshpos = (index + <span class="number">1</span>) / count;</div><div class="line">        mesh.position.copy( curve.getPoint(a_meshpos * alpha) );</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">const</span> DEFAULT_HOOKS = &#123;</div><div class="line">        <span class="attr">restLow</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">0</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">restHigh</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">1</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">breathIn</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart));</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">breathOut</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">1</span> - <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart));</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// HELPERS</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// update curve control points and mesh object values</span></div><div class="line">    <span class="keyword">const</span> updateGroup = <span class="function">(<span class="params">group, alpha</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        <span class="keyword">let</span> index_curve = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(index_curve &lt; gud.curveCount)&#123;</div><div class="line">            <span class="keyword">const</span> curve = gud.curvePath.curves[index_curve];</div><div class="line">            <span class="keyword">const</span> v_start = curve.v0, v_c1 = curve.v1, v_c2 = curve.v2, v_end = curve.v3;</div><div class="line">            gud.curveUpdate(curve, alpha, v_c1, v_c2, v_start, v_end, gud, group);</div><div class="line">            <span class="keyword">let</span> index_mesh = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span>(index_mesh &lt; gud.meshPerCurve)&#123;</div><div class="line">                <span class="keyword">const</span> name = getMeshName(gud, index_curve, index_mesh);</div><div class="line">                <span class="keyword">const</span> mesh = group.getObjectByName(name);</div><div class="line">                gud.meshUpdate(mesh, curve, alpha, index_mesh, gud.meshPerCurve, group, group.userData);</div><div class="line">                index_mesh += <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            index_curve += <span class="number">1</span>;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get a mesh object name to be used when creating and getting mesh objects in breath group</span></div><div class="line">    <span class="keyword">const</span> getMeshName = <span class="function">(<span class="params">gud, index_curve, index_mesh</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">'breath_id'</span> + gud.id + <span class="string">'_curve'</span> + index_curve + <span class="string">'_mesh'</span> + index_mesh;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get the sum of a breath parts object</span></div><div class="line">    <span class="keyword">const</span> getBreathPartsSum = <span class="function">(<span class="params">breathParts</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.keys( breathParts ).reduce( <span class="function">(<span class="params"> acc, key </span>) =&gt;</span> &#123; <span class="keyword">return</span> acc + breathParts[key]; &#125;, <span class="number">0</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// get the alpha value targets for each breath part</span></div><div class="line">    <span class="keyword">const</span> getBreathAlphaTargets = <span class="function">(<span class="params">breathParts</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> BREATH_KEYS.reduce(<span class="function">(<span class="params">acc, key, i, arr</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">let</span> a = breathParts[ key ];</div><div class="line">            <span class="keyword">if</span>(i &gt; <span class="number">0</span>)&#123;</div><div class="line">                a += acc[i - <span class="number">1</span>]</div><div class="line">            &#125;</div><div class="line">            acc.push( a );</div><div class="line">            <span class="keyword">return</span> acc;</div><div class="line">        &#125;, []).map(<span class="function">(<span class="params">n</span>)=&gt;</span>&#123;</div><div class="line">            <span class="keyword">return</span> n / getBreathPartsSum(breathParts);</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// PUBLIC API</span></div><div class="line">    <span class="comment">//-------- ----------</span></div><div class="line">    <span class="comment">// main update method</span></div><div class="line">    api.update = <span class="function">(<span class="params">group, a_fullvid</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        gud.a_fullvid = a_fullvid;</div><div class="line">        <span class="keyword">const</span> sec = gud.totalBreathSecs * gud.a_fullvid;</div><div class="line">        <span class="keyword">const</span> a1 = (sec % <span class="number">60</span> / <span class="number">60</span>) * gud.breathsPerMinute % <span class="number">1</span>;</div><div class="line">        <span class="keyword">let</span> ki = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(ki &lt; BREATH_KEYS.length)&#123;</div><div class="line">            <span class="keyword">if</span>(a1 &lt; gud.breathAlphaTargts[ki])&#123;</div><div class="line">                gud.a_base = ki &gt; <span class="number">0</span> ? gud.breathAlphaTargts[ki - <span class="number">1</span>] : <span class="number">0</span>;</div><div class="line">                gud.a_breathPart = (a1 - gud.a_base) / (gud.breathAlphaTargts[ki] - gud.a_base);</div><div class="line">                gud.currentBreathKey = BREATH_KEYS[ki];</div><div class="line">                <span class="keyword">const</span> hook = gud.hooks[ gud.currentBreathKey ] || DEFAULT_HOOKS[ gud.currentBreathKey ];</div><div class="line">                hook(updateGroup, group, gud.a_breathPart, gud.a_fullvid, group.userData);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            ki += <span class="number">1</span>;;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// main create method</span></div><div class="line">    api.create = <span class="function">(<span class="params">opt</span>) =&gt;</span> &#123;</div><div class="line">        opt = opt || &#123;&#125;;</div><div class="line">        <span class="keyword">const</span> group = <span class="keyword">new</span> THREE.Group();</div><div class="line">        <span class="keyword">const</span> gud = group.userData;</div><div class="line">        gud.radiusMin = opt.radiusMin === <span class="literal">undefined</span> ? <span class="number">0.50</span> : opt.radiusMin;</div><div class="line">        gud.radiusMax = opt.radiusMax === <span class="literal">undefined</span> ? <span class="number">2.80</span> : opt.radiusMax;</div><div class="line">        gud.curveCount = opt.curveCount === <span class="literal">undefined</span> ? <span class="number">10</span> : opt.curveCount;</div><div class="line">        gud.meshPerCurve = opt.meshPerCurve === <span class="literal">undefined</span> ? <span class="number">10</span> : opt.meshPerCurve;</div><div class="line">        gud.geometry = opt.geometry || <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.1</span>, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line">        gud.material = opt.material || <span class="keyword">new</span> THREE.MeshPhongMaterial();</div><div class="line">        gud.curveUpdate = opt.curveUpdate || DEFAULT_CURVE_UPDATE;</div><div class="line">        gud.meshUpdate = opt.meshUpdate || DEFAULT_MESH_UPDATE;</div><div class="line">        gud.totalBreathSecs = opt.totalBreathSecs === <span class="literal">undefined</span> ? <span class="number">300</span> : opt.totalBreathSecs;</div><div class="line">        gud.breathsPerMinute = opt.breathsPerMinute === <span class="literal">undefined</span> ? <span class="number">5</span> : opt.breathsPerMinute;</div><div class="line">        gud.breathParts = opt.breathParts || DEFAULT_BREATH_PARTS;</div><div class="line">        gud.breathAlphaTargts = getBreathAlphaTargets(gud.breathParts);</div><div class="line">        gud.curvePath = <span class="keyword">new</span> THREE.CurvePath();</div><div class="line">        gud.hooks = opt.hooks || &#123;&#125;;</div><div class="line">        gud.id = opt.id || <span class="string">'1'</span>;</div><div class="line">        <span class="comment">// set in api.update</span></div><div class="line">        gud.currentBreathKey = <span class="string">''</span>;</div><div class="line">        gud.a_fullvid = <span class="number">0</span>;</div><div class="line">        gud.a_base = <span class="number">0</span>;</div><div class="line">        gud.a_breathPart = <span class="number">0</span>;</div><div class="line">        <span class="keyword">let</span> index_curve = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(index_curve &lt; gud.curveCount)&#123;</div><div class="line">            <span class="keyword">const</span> a_curve_index = index_curve / gud.curveCount;</div><div class="line">            <span class="comment">// add current curve</span></div><div class="line">            <span class="keyword">const</span> e = <span class="keyword">new</span> THREE.Euler();</div><div class="line">            e.z = <span class="built_in">Math</span>.PI * <span class="number">2</span> * a_curve_index;</div><div class="line">            <span class="keyword">const</span> v_start = <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            <span class="keyword">const</span> v_end = <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            v_start.applyEuler(e).multiplyScalar(gud.radiusMin);</div><div class="line">            v_end.applyEuler(e).multiplyScalar(gud.radiusMax);</div><div class="line">            <span class="keyword">const</span> v_c1 = v_start.clone().lerp(v_end, <span class="number">0.25</span>);</div><div class="line">            <span class="keyword">const</span> v_c2 = v_start.clone().lerp(v_end, <span class="number">0.75</span>);</div><div class="line">            <span class="keyword">const</span> curve = <span class="keyword">new</span> THREE.CubicBezierCurve3(v_start.clone(), v_c1, v_c2, v_end);</div><div class="line">            gud.curvePath.add(curve);</div><div class="line">            <span class="comment">// add mesh objects for each curve</span></div><div class="line">            <span class="keyword">let</span> index_mesh = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span>(index_mesh &lt; gud.meshPerCurve)&#123;</div><div class="line">                <span class="keyword">const</span> mesh = <span class="keyword">new</span> THREE.Mesh(gud.geometry, gud.material.clone());</div><div class="line">                mesh.material.transparent = <span class="literal">true</span>;</div><div class="line">                mesh.name = getMeshName(gud, index_curve, index_mesh);</div><div class="line">                group.add(mesh);</div><div class="line">                index_mesh += <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            index_curve += <span class="number">1</span>;</div><div class="line">        &#125;;</div><div class="line">        api.update(group, <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> group;</div><div class="line">    &#125;;</div><div class="line">&#125;(<span class="keyword">this</span>[<span class="string">'BreathMod'</span>] = &#123;&#125; ));</div></pre></td></tr></table></figure>
<h3 id="2-1-Using-the-default-options"><a href="#2-1-Using-the-default-options" class="headerlink" title="2.1 - Using the default options"></a>2.1 - Using the default options</h3><p>I will want to start out with a demo of the module that is a kind of hello world type getting started type demo. Nothing fancy just creating an instance of the group that is returned when calling the breath modules create public method. Also with that said I can make sure that i get an expected result when calling the create method with no options at all that will of course result in a breath module with everything set to the hard coded default settings for thing.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// LIGHT</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">1</span>);</div><div class="line">dl.position.set(<span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>)</div><div class="line">scene.add(dl);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// BREATH GROUP - creating with default settings</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> group = BreathMod.create();</div><div class="line">scene.add(group);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> FPS_UPDATE = <span class="number">20</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">FRAME_MAX = <span class="number">30</span> * <span class="number">300</span>;</div><div class="line"><span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">frame = <span class="number">0</span>,</div><div class="line">lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="comment">// update</span></div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = frame / frameMax;</div><div class="line">    <span class="keyword">const</span> a_breathPart = a1;</div><div class="line">    <span class="keyword">const</span> a_breath = <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart);</div><div class="line">    BreathMod.update(group, a_breath);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// loop</span></div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render</span></div><div class="line">        update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        frame += FPS_MOVEMENT * secs;</div><div class="line">        frame %= FRAME_MAX;</div><div class="line">        lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div></pre></td></tr></table></figure>
<h3 id="2-2-Custom-options-for-curve-and-mesh-updates"><a href="#2-2-Custom-options-for-curve-and-mesh-updates" class="headerlink" title="2.2 - Custom options for curve and mesh updates"></a>2.2 - Custom options for curve and mesh updates</h3><p>So it looks like this are working just fine with the default settings so now it is time to have a demo with some custom options for update the group of mesh objects.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// LIGHT</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">1</span>);</div><div class="line">dl.position.set(<span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>)</div><div class="line">scene.add(dl);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// BREATH GROUP</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> group = BreathMod.create(&#123;</div><div class="line">    <span class="attr">curveCount</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">meshPerCurve</span>: <span class="number">16</span>,</div><div class="line">    <span class="attr">radiusMin</span>: <span class="number">0.5</span>, <span class="attr">radiusMax</span>: <span class="number">8</span>,</div><div class="line">    <span class="attr">breathsPerMinute</span>: <span class="number">5</span>,</div><div class="line">    <span class="attr">breathParts</span>: &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">4</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">4</span>&#125;,</div><div class="line">    <span class="attr">curveUpdate</span>: <span class="function">(<span class="params">curve, alpha, v_c1, v_c2, v_start, v_end, gud, group</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> e1 = <span class="keyword">new</span> THREE.Euler();</div><div class="line">        e1.z = <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">60</span> * alpha;</div><div class="line">        <span class="keyword">const</span> e2 = <span class="keyword">new</span> THREE.Euler();</div><div class="line">        e2.z = <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">-60</span> * alpha;</div><div class="line">        v_c1.copy( v_start.clone().lerp(v_end, <span class="number">0.25</span>).applyEuler(e1) );</div><div class="line">        v_c2.copy( v_start.clone().lerp(v_end, <span class="number">0.75</span>).applyEuler(e2) );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">meshUpdate</span>: <span class="function">(<span class="params">mesh, curve, alpha, index, count, group</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// position</span></div><div class="line">        <span class="keyword">const</span> a_meshpos = (index + <span class="number">1</span>) / count;</div><div class="line">        mesh.position.copy( curve.getPoint(a_meshpos * alpha) );</div><div class="line">        <span class="comment">// opacity</span></div><div class="line">        <span class="keyword">const</span> a_meshopacity = (<span class="number">1</span> - a_meshpos) * <span class="number">0.50</span> + <span class="number">0.50</span> * alpha;</div><div class="line">        mesh.material.opacity = a_meshopacity;</div><div class="line">        <span class="comment">// scale</span></div><div class="line">        <span class="keyword">const</span> s = <span class="number">0.25</span> + <span class="number">2.25</span> * a_meshpos * <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * alpha);</div><div class="line">        mesh.scale.set( s, s, s );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">material</span>: <span class="keyword">new</span> THREE.MeshPhongMaterial(&#123;</div><div class="line">        <span class="attr">color</span>: <span class="number">0x00ffff</span>,</div><div class="line">        <span class="attr">emissive</span>: <span class="number">0xffffff</span>,</div><div class="line">        <span class="attr">emissiveIntensity</span>: <span class="number">0.1</span></div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line">scene.add(group);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> FPS_UPDATE = <span class="number">20</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">FRAME_MAX = <span class="number">30</span> * <span class="number">300</span>;</div><div class="line"><span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">frame = <span class="number">0</span>,</div><div class="line">lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="comment">// update</span></div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = frame / frameMax;</div><div class="line">    <span class="keyword">const</span> a_breathPart = a1;</div><div class="line">    <span class="keyword">const</span> a_breath = <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart);</div><div class="line">    BreathMod.update(group, a_breath);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// loop</span></div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render</span></div><div class="line">        update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        frame += FPS_MOVEMENT * secs;</div><div class="line">        frame %= FRAME_MAX;</div><div class="line">        lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div></pre></td></tr></table></figure>
<h3 id="2-3-The-hooks-option"><a href="#2-3-The-hooks-option" class="headerlink" title="2.3 - The hooks option"></a>2.3 - The hooks option</h3><p>I also have a hooks feature that is a way to define custom logic for each part of a breath cycle.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// LIGHT</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> dl = <span class="keyword">new</span> THREE.DirectionalLight(<span class="number">0xffffff</span>, <span class="number">1</span>);</div><div class="line">dl.position.set(<span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>)</div><div class="line">scene.add(dl);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// GEOMETRIES / MATERIALS</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> geometry_center = <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">1.0</span>, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"><span class="keyword">const</span> geometry_orbs = <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">0.1</span>, <span class="number">16</span>, <span class="number">16</span>);</div><div class="line"><span class="keyword">const</span> material_center = <span class="keyword">new</span> THREE.MeshPhongMaterial(&#123;</div><div class="line">    <span class="attr">color</span>: <span class="number">0x00ffff</span>,</div><div class="line">    <span class="attr">emissive</span>: <span class="number">0xffffff</span>,</div><div class="line">    <span class="attr">emissiveIntensity</span>: <span class="number">0.1</span></div><div class="line">&#125;);</div><div class="line"><span class="keyword">const</span> material_orbs = <span class="keyword">new</span> THREE.MeshPhongMaterial(&#123;</div><div class="line">    <span class="attr">color</span>: <span class="number">0x00ffff</span>,</div><div class="line">    <span class="attr">emissive</span>: <span class="number">0xffffff</span>,</div><div class="line">    <span class="attr">emissiveIntensity</span>: <span class="number">0.1</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// MESH</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(geometry_center, material_center);</div><div class="line">scene.add(mesh1);</div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="comment">// BREATH GROUP</span></div><div class="line"><span class="comment">//-------- ----------</span></div><div class="line"><span class="keyword">const</span> group = BreathMod.create(&#123;</div><div class="line">    <span class="attr">geometry</span>: geometry_orbs,</div><div class="line">    <span class="attr">material</span>: material_orbs,</div><div class="line">    <span class="attr">breathsPerMinute</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">breathParts</span>: &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">3</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">3</span>&#125;,</div><div class="line">    <span class="attr">curveCount</span>: <span class="number">16</span>,</div><div class="line">    <span class="attr">meshPerCurve</span>: <span class="number">6</span>,</div><div class="line">    <span class="attr">radiusMin</span>: <span class="number">1.1</span>, <span class="attr">radiusMax</span>: <span class="number">2.9</span>,</div><div class="line">    <span class="attr">breathsPerMinute</span>: <span class="number">5</span>,</div><div class="line">    <span class="attr">breathParts</span>: &#123;<span class="attr">restLow</span>: <span class="number">1</span>, <span class="attr">breathIn</span>: <span class="number">4</span>, <span class="attr">restHigh</span>: <span class="number">1</span>, <span class="attr">breathOut</span>: <span class="number">4</span>&#125;,</div><div class="line">    <span class="attr">curveUpdate</span>: <span class="function">(<span class="params">curve, alpha, v_c1, v_c2, v_start, v_end, gud, group</span>) =&gt;</span> &#123;</div><div class="line">        v_c1.copy( v_start.clone().lerp(v_end, <span class="number">0.25</span>) );</div><div class="line">        v_c2.copy( v_start.clone().lerp(v_end, <span class="number">0.75</span>) );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">meshUpdate</span>: <span class="function">(<span class="params">mesh, curve, alpha, index, count, group, gud</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> a_meshpos = (index + <span class="number">1</span>) / count;</div><div class="line">        mesh.position.copy( curve.getPoint(a_meshpos * alpha) );</div><div class="line">        mesh.material.color = <span class="keyword">new</span> THREE.Color(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">        <span class="keyword">const</span> a1 = gud.a_breathPart;</div><div class="line">        <span class="keyword">if</span>(gud.currentBreathKey === <span class="string">'restLow'</span>)&#123;</div><div class="line">            mesh.material.color = <span class="keyword">new</span> THREE.Color(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(gud.currentBreathKey === <span class="string">'restHigh'</span>)&#123;</div><div class="line">            mesh.material.color = <span class="keyword">new</span> THREE.Color(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(gud.currentBreathKey === <span class="string">'breathIn'</span>)&#123;</div><div class="line">            mesh.material.color = <span class="keyword">new</span> THREE.Color(a1, <span class="number">1</span> - a1, <span class="number">1</span> - a1);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(gud.currentBreathKey === <span class="string">'breathOut'</span>)&#123;</div><div class="line">            mesh.material.color = <span class="keyword">new</span> THREE.Color(<span class="number">1</span> - a1, a1, a1);</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">hooks</span> : &#123;</div><div class="line">        <span class="attr">restLow</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">0.05</span> * a_breathPart);</div><div class="line">            group.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">2</span> * a_breathPart;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">restHigh</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">1</span> - <span class="number">0.05</span> * a_breathPart);</div><div class="line">            group.rotation.y = <span class="built_in">Math</span>.PI * <span class="number">2</span> * a_breathPart * <span class="number">-1</span>;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">breathIn</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">0.05</span> + <span class="number">0.95</span> * <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart) );</div><div class="line">            group.rotation.y = <span class="number">0</span>;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">breathOut</span> : <span class="function">(<span class="params">updateGroup, group, a_breathPart, a_fullvid, gud</span>) =&gt;</span> &#123;</div><div class="line">            updateGroup(group, <span class="number">0.95</span> - <span class="number">0.95</span> * <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart) );</div><div class="line">            group.rotation.y = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">scene.add(group);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> FPS_UPDATE = <span class="number">30</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">FRAME_MAX = <span class="number">30</span> * <span class="number">300</span>;</div><div class="line"><span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">frame = <span class="number">0</span>,</div><div class="line">lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="comment">// update</span></div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = frame / frameMax;</div><div class="line">    <span class="keyword">const</span> a_breathPart = a1;</div><div class="line">    <span class="keyword">const</span> a_breath = <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * <span class="number">0.5</span> * a_breathPart);</div><div class="line">    BreathMod.update(group, a_breath);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// loop</span></div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render</span></div><div class="line">        update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        frame += FPS_MOVEMENT * secs;</div><div class="line">        frame %= FRAME_MAX;</div><div class="line">        lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div></pre></td></tr></table></figure>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So far so good with this project, and I am sure that I will be making at least a few video projects using this module. In time I am sure I will have a better idea of what needs to change with respect to future revisions of this module. Thus far I am thinking that much of that might have to do with removing features rather than adding them actually. AT least that is what I did with R1 of the example at least as there is much that I think should not be baked into the module itself. The main thing here is to just have a module that will update alpha values that I then in turn used for one or more additional things in an over all scene that will change from one project to the next.</p>
<p>As wih R1 I think that I now have an okay system at least for this work of thing, and now any additional changes will have to do with things that might come up if I use this a great deal more.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/" data-id="clhgco0ik028kpwv1qvpwzazc" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/three-js/">three.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/03/10/threejs-examples-camera-planes/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Camera Planes module threejs example
        
      </div>
    </a>
  
  
    <a href="/2023/02/23/threejs-points/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Points in threejs</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/index.html';
    this.page.identifier = '1030';
    this.page.title = 'A Breath Module threejs project example';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 15.45px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.64px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13.64px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.82px;">express</a> <a href="/tags/games/" style="font-size: 17.27px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.55px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.73px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.64px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.55px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.91px;">python</a> <a href="/tags/statistics/" style="font-size: 14.09px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19.09px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16.36px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/05/threejs-examples-timeline/">Timeline module threejs example</a>
          </li>
        
          <li>
            <a href="/2023/04/28/electronjs-example-game-mrsun/">Idle Game Electronjs project example - MrSun Idle prototype</a>
          </li>
        
          <li>
            <a href="/2023/04/14/threejs-quaternion-slerp/">Quaternion slerp method</a>
          </li>
        
          <li>
            <a href="/2023/04/07/threejs-quaternion-setfromunitvectors/">Quaternion set from unit vectors method in threejs</a>
          </li>
        
          <li>
            <a href="/2023/03/31/threejs-quaternion-premultiply/">Quaternion premultiply method in threejs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas</a>
  
    <a href="https://www.youtube.com/user/javaweaver" class="mobile-nav-link">Youtube</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2023/03/03/threejs-examples-breath-module/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>