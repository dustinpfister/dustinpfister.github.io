<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>Quaternion premultiply method in threejs | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The premultiply method of the quaternion class in threejs comes in handy when I find myself in a situation in which I need to preform not one but two rotations. Say that I have a sphere and I want to">
<meta property="og:type" content="article">
<meta property="og:title" content="Quaternion premultiply method in threejs">
<meta property="og:url" content="https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="The premultiply method of the quaternion class in threejs comes in handy when I find myself in a situation in which I need to preform not one but two rotations. Say that I have a sphere and I want to">
<meta property="og:updated_time" content="2023-04-01T15:37:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Quaternion premultiply method in threejs">
<meta name="twitter:description" content="The premultiply method of the quaternion class in threejs comes in handy when I find myself in a situation in which I need to preform not one but two rotations. Say that I have a sphere and I want to">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XLNG6JRW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8XLNG6JRW');
</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image, as well as the link to my youtube -->
        <a href="https://www.youtube.com/user/javaweaver"><div class="selfimage"></div></a>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2021/02/19/threejs-examples/">ThreeJS</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas</a>
        
          <a class="main-nav-link" href="https://www.youtube.com/user/javaweaver">Youtube</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-threejs-quaternion-premultiply" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/03/31/threejs-quaternion-premultiply/" class="article-date"> Published:
  <time datetime="2023-03-31T10:38:00.000Z" itemprop="datePublished">2023-03-31</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2023/03/31/threejs-quaternion-premultiply/" class="article-date"> Modified:
  <time datetime="2023-04-01T15:37:25.000Z" itemprop="dateModified">2023-04-01</time>
</a>

    <span class="article-date">V1.1</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/three-js/">three.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Quaternion premultiply method in threejs
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>The <a href="https://threejs.org/docs/#api/en/math/Quaternion.premultiply" target="_blank" rel="external">premultiply method of the quaternion class in threejs</a> comes in handy when I find myself in a situation in which I need to preform not one but two rotations. Say that I have a sphere and I want to rotate the sphere on an axis that is say 45 degrees so that the top and bottom of the sphere geometry is aligned with the sphere, and on top of that I want to rotate the sphere on this axis. So in a way I actually have two axis vectors and two angles. One set of axis and angle is aligned with the geometry to begin with, and the other is to adjust the geometry to an additional orientation that I want. In this post then I will be going over a number of code examples that make use of this method as this is a major part of working with quaternion objects for setting the orientation of objects.</p>
<a id="more"></a>
<iframe class="youtube_video" src="https://www.youtube.com/embed/nDjy-Mx-uUc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<h2 id="The-premultiply-quaternion-method-and-what-to-know-first"><a href="#The-premultiply-quaternion-method-and-what-to-know-first" class="headerlink" title="The premultiply quaternion method and what to know first"></a>The premultiply quaternion method and what to know first</h2><p>This is a blog post on the premultiply method os the quaternion class in the javaScript library known as threejs. This is then not a post for people that are new to the quaternion class in general, threejs as a whole, or any underlying skills that are needed before even getting into that. I will do my best to try to keep these examples fairly simple, but it might still be best to start out with a <a href="/2018/04/04/threejs-getting-started/">getting started with threejs type post</a> if you are new to the library. Regardless of kill level or experience there might still be a few things you might want to refresh on first as well, so I will take a moment to write about a few of those things in this section.</p>
<h3 id="Start-out-with-Object3d-lookAt-if-you-are-new-to-rotations"><a href="#Start-out-with-Object3d-lookAt-if-you-are-new-to-rotations" class="headerlink" title="Start out with Object3d.lookAt if you are new to rotations"></a>Start out with Object3d.lookAt if you are new to rotations</h3><p>If you have zero experience when it comes to rotations of objects in threejs, it might be best to start out with using the <a href="/2021/05/13/threejs-object3d-lookat/">object3d look at method</a>. This is a very easy to use tool for setting rotation, and also in many cases it will work just fine when it comes to setting the orientation of an object. I think it is best to always start out with the most basic tool, and only bother getting into complex solutions such as quaternion objects when I find myself in a situation in which I have to.</p>
<h3 id="There-is-also-Object3d-rotation-and-the-Euler-class"><a href="#There-is-also-Object3d-rotation-and-the-Euler-class" class="headerlink" title="There is also Object3d.rotation and the Euler class"></a>There is also Object3d.rotation and the Euler class</h3><p>If the look at method is not cutting it there is then looking into the <a href="/2022/04/08/threejs-object3d-rotation/">rotation property of the object3d class</a>, and with that the <a href="/2021/04/28/threejs-euler/">Euler class</a> that is the value of the rotation property. Euler angles are must easier to work with that quaternions, but in some situations they might prove to be an oversimplification of the situation which would lead one to get into quaternion objects.</p>
<h3 id="There-is-my-main-blog-post-on-quaternion-objects"><a href="#There-is-my-main-blog-post-on-quaternion-objects" class="headerlink" title="There is my main blog post on quaternion objects"></a>There is my main blog post on quaternion objects</h3><p>There is checking out my <a href="/2023/03/24/threejs-quaternion/">main blog post on quaternion objects</a> to get a general overview of the quaternion class as a whole. There are a whole lot of other methods in the class as well of course, so this post would be better for starting out with quaternion in threejs. The post is also just simply the post that has received the most time and attention with this subject as well, and it might be a while until I get around to editing this post.</p>
<h3 id="Source-code-examples-are-up-on-Github"><a href="#Source-code-examples-are-up-on-Github" class="headerlink" title="Source code examples are up on Github."></a>Source code examples are up on Github.</h3><p>The <a href="https://github.com/dustinpfister/test_threejs/tree/master/views/forpost/threejs-quaternion-premultiply" target="_blank" rel="external">source code examples that I am writing about in this post</a>, as well as the examples for <a href="/categories/three-js/">my many other posts on threejs</a>, can be found in my test threejs repository on Github. It might be best to clone down that repo and start the server as a way to get things up and ruining on your end as well. I do try my best to keep these examples copy and paste friendly, but there are a lot or reasons why that will not always work out, it part because threejs moves so fast in terms of development.</p>
<h3 id="Version-Numbers-matter"><a href="#Version-Numbers-matter" class="headerlink" title="Version Numbers matter"></a>Version Numbers matter</h3><p>When I first wrote this post I was using r146 of threejs and the examples here where working just fine on my end with that revision number. However code breaking changes are made to the library all the time.</p>
<h2 id="1-Basic-examples-of-the-premultiply-method-in-the-quaternion-class"><a href="#1-Basic-examples-of-the-premultiply-method-in-the-quaternion-class" class="headerlink" title="1 - Basic examples of the premultiply method in the quaternion class"></a>1 - Basic examples of the premultiply method in the quaternion class</h2><p>For this section I will be starting off with a few basic examples of the premultiply method of the quaternion class in threejs. I will be doing what I can to stay clear of doing anything to complex then, and for the most part these will be examples that focus mainly on just the premultiply alone. However I will still of course need to make use of many other threejs features of the quaternion class such as the set from axis angle method, as well as various other threejs features outside of the class.</p>
<h3 id="1-1-Basic-example-of-premultipy"><a href="#1-1-Basic-example-of-premultipy" class="headerlink" title="1.1 - Basic example of premultipy"></a>1.1 - Basic example of premultipy</h3><p>The general idea here is that I have not one, but two quaternion objects when it comes to a very basic getting started example at least. I can then use the copy method of the quaternion class to copy one quaternion object to the quaternion object of an object3d class based object such as a mesh object to set the first rotation. Then I can call the premultiply method and pass the next quaternion object as well to get the final rotation that I want.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>));</div><div class="line"><span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123;<span class="attr">wireframe</span>: <span class="literal">true</span>, <span class="attr">wireframeLinewidth</span>: <span class="number">2</span> &#125;);</div><div class="line"><span class="keyword">const</span> mesh = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">    <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">2</span>, <span class="number">20</span>, <span class="number">20</span>),</div><div class="line">    material);</div><div class="line">scene.add(mesh);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ROTATE WITH QUATERNIONS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> axis1 = <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> axis2 = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> q1 = <span class="keyword">new</span> THREE.Quaternion().setFromAxisAngle(axis1, <span class="built_in">Math</span>.PI * <span class="number">0.25</span>);</div><div class="line"><span class="keyword">const</span> q2 = <span class="keyword">new</span> THREE.Quaternion().setFromAxisAngle(axis2, <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">5</span>);</div><div class="line">mesh.quaternion.copy(q2).premultiply(q1);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// RENDER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">renderer.render(scene, camera);</div></pre></td></tr></table></figure>
<p>I could also just directly call the set from axis angle method off of the quaternion of the mesh object, and then just have one stand along quaternion object. In any case the deal here is to think in terms of what needs to happen in the form of two or more rotations to get to the desired end result.</p>
<h3 id="1-2-The-order-of-the-rotations-does-very-much-matter"><a href="#1-2-The-order-of-the-rotations-does-very-much-matter" class="headerlink" title="1.2 - The order of the rotations does very much matter"></a>1.2 - The order of the rotations does very much matter</h3><p>The order of the rotations does very much matter when using the premultiply method. If I have two quaternion objects, one of which I use for the copy method, and another for a premultiply method call after, the order in which the objects are passed will result in two differing orientations depending on which one I use first. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>));</div><div class="line"><span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123;<span class="attr">wireframe</span>: <span class="literal">true</span>, <span class="attr">wireframeLinewidth</span>: <span class="number">3</span> &#125;);</div><div class="line"><span class="keyword">const</span> geometry = <span class="keyword">new</span> THREE.CylinderGeometry(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line">geometry.rotateX(<span class="built_in">Math</span>.PI * <span class="number">1.5</span>)</div><div class="line"><span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh( geometry, material);</div><div class="line"><span class="keyword">const</span> mesh2 = mesh1.clone();</div><div class="line">scene.add(mesh1);</div><div class="line">scene.add(mesh2);</div><div class="line">mesh1.position.set(<span class="number">-2</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">mesh2.position.set(<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ROTATE WITH QUATERNIONS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> axis1 = <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> axis2 = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> q1 = <span class="keyword">new</span> THREE.Quaternion().setFromAxisAngle(axis1, <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">45</span>);</div><div class="line"><span class="keyword">const</span> q2 = <span class="keyword">new</span> THREE.Quaternion().setFromAxisAngle(axis2, <span class="built_in">Math</span>.PI / <span class="number">180</span> * <span class="number">180</span>);</div><div class="line"><span class="comment">// THE ORDER DOES VERY MUCH MATTER AS THIS WILL</span></div><div class="line"><span class="comment">// RESULT IN TWO DIFFERING ORIENTATIONS</span></div><div class="line">mesh1.quaternion.copy(q2).premultiply(q1);</div><div class="line">mesh2.quaternion.copy(q1).premultiply(q2);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// RENDER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">renderer.render(scene, camera);</div></pre></td></tr></table></figure>
<p>In some cases I might want to do things in one order, but then in other cases I might want to do the other. There is making use of other quaternion methods such as the clone and slerp method to create another set of qunaterions that can be impacted by an alpha value to switch between the two. However getting into that is a more advanced topic that I will be getting into later in this post with one of my animation loop examples.</p>
<h3 id="1-3-It-is-possible-to-preform-many-rotations-by-calling-premultiply-over-and-over-again"><a href="#1-3-It-is-possible-to-preform-many-rotations-by-calling-premultiply-over-and-over-again" class="headerlink" title="1.3 - It is possible to preform many rotations by calling premultiply over and over again"></a>1.3 - It is possible to preform many rotations by calling premultiply over and over again</h3><p>For this example I am preforming a whole bunch of rotations one after another. Well maybe not that many just three for started but the general idea is there. I can preform as many rotations as I need over and over again to get an object to face any direction that I want or need which is great.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add(<span class="keyword">new</span> THREE.GridHelper(<span class="number">10</span>, <span class="number">10</span>));</div><div class="line"><span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123;<span class="attr">wireframe</span>: <span class="literal">true</span>, <span class="attr">wireframeLinewidth</span>: <span class="number">1</span> &#125;);</div><div class="line"><span class="keyword">const</span> geometry = <span class="keyword">new</span> THREE.CylinderGeometry(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line"><span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh( geometry, material);</div><div class="line">scene.add(mesh1);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ROTATE WITH QUATERNIONS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> axis = <span class="keyword">new</span> THREE.Vector3();</div><div class="line"><span class="keyword">const</span> q = <span class="keyword">new</span> THREE.Quaternion();</div><div class="line">[</div><div class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">90</span>],  <span class="comment">// x,y,z,degree to be used to set axis and angle</span></div><div class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">112</span>], <span class="comment">// can add as many of these as I want</span></div><div class="line">    [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>, <span class="number">63</span>]</div><div class="line">].forEach( <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</div><div class="line">    axis.set(data[<span class="number">0</span>], data[<span class="number">1</span>], data[<span class="number">2</span>]).normalize();</div><div class="line">    q.setFromAxisAngle(axis, <span class="built_in">Math</span>.PI / <span class="number">180</span> * data[<span class="number">3</span>]);</div><div class="line">    mesh1.quaternion.premultiply(q);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// RENDER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">renderer.render(scene, camera);</div></pre></td></tr></table></figure>
<h2 id="2-Animation-examples"><a href="#2-Animation-examples" class="headerlink" title="2 - Animation examples"></a>2 - Animation examples</h2><p>For this section I will be going over at least a few if not more animation examples that will help to really gain a sense of what the deal is with the premultiply method. The main focus with these examples should be on how the premultiply method can be used to preform not one but many rotations on an object. However I am also doing a whole lot more here when it comes to other things that come up when making these kinds of examples. There is making examples where I am thinking in terms of making a video in which case they do not have to respond to user input, however there is also making examples that do respond to user input as well. At this time I am combining both of these kinds of examples together into one section.</p>
<h3 id="2-1-Rotate-sphere-on-axis-with-premutiply-and-slerp"><a href="#2-1-Rotate-sphere-on-axis-with-premutiply-and-slerp" class="headerlink" title="2.1 - Rotate sphere on axis, with premutiply and slerp"></a>2.1 - Rotate sphere on axis, with premutiply and slerp</h3><p>For this animation loop example I wanted to have a nice little project that really helps me get a good feel for what the premultilly method is all about. While I am at it also gain a better  sense of what the slerp method can do also. You see there is of course the order in which I use the quaternion objects, so it would be nice to slerp between these two so I can switch back and forth between these two different orders. As such I can switch between having the sphere rotate on an axis, and rotating around the axis.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">scene.background = <span class="literal">null</span>;</div><div class="line">renderer.setClearColor(<span class="number">0x000000</span>, <span class="number">0</span>)</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line"><span class="keyword">const</span> canvas_2d = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</div><div class="line"><span class="keyword">const</span> ctx = canvas_2d.getContext(<span class="string">'2d'</span>);</div><div class="line">canvas_2d.width = <span class="number">640</span>;</div><div class="line">canvas_2d.height = <span class="number">480</span>;</div><div class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body;</div><div class="line">container.appendChild(canvas_2d);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// QUATERION</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> axis1 = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> axis2 = <span class="keyword">new</span> THREE.Vector3(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> q1 = <span class="keyword">new</span> THREE.Quaternion();</div><div class="line"><span class="keyword">const</span> q2 = q1.clone();</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add( <span class="keyword">new</span> THREE.GridHelper( <span class="number">10</span>,<span class="number">10</span> ) );</div><div class="line"><span class="keyword">const</span> mesh1 = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">    <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">1.25</span>, <span class="number">16</span>, <span class="number">16</span>),</div><div class="line">    <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123; <span class="attr">wireframe</span>: <span class="literal">true</span>&#125;));</div><div class="line">scene.add(mesh1);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// CONTROLS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">let</span> controls = <span class="literal">null</span>;</div><div class="line"><span class="keyword">if</span>(THREE.OrbitControls)&#123;</div><div class="line">    controls = <span class="keyword">new</span> THREE.OrbitControls(camera, canvas_2d);</div><div class="line">&#125;</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ALPHA CONTROLS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> ac = &#123;</div><div class="line">    <span class="attr">x</span>: <span class="number">420</span>, <span class="attr">y</span>:<span class="number">20</span>,</div><div class="line">    <span class="attr">h</span>: <span class="number">125</span>, <span class="attr">w</span>: <span class="number">200</span>,</div><div class="line">    <span class="attr">items</span>: &#123;&#125;</div><div class="line">&#125;;</div><div class="line">ac.items.angel = &#123; <span class="attr">desc</span>: <span class="string">'Axis Angle'</span>, <span class="attr">a</span>: <span class="number">0.5</span> &#125;;</div><div class="line">ac.items.speed = &#123; <span class="attr">desc</span>: <span class="string">'Rotaiton Speed'</span>, <span class="attr">a</span>: <span class="number">0.5</span> &#125;;</div><div class="line">ac.items.slerp = &#123; <span class="attr">desc</span>: <span class="string">'Slerp'</span>, <span class="attr">a</span>: <span class="number">0</span> &#125;;</div><div class="line">ac.itemCount = <span class="built_in">Object</span>.keys(ac.items).length;</div><div class="line"><span class="comment">// for each item method</span></div><div class="line">ac.forEachItem = <span class="function">(<span class="params">forItem</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(ac.items);</div><div class="line">    keys.forEach( <span class="function">(<span class="params">key, i, arr</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> item = ac.items[key];</div><div class="line">        forItem(item, i, arr);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// get an item by index</span></div><div class="line">ac.getItem = <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(ac.items);</div><div class="line">    <span class="keyword">return</span> ac.items[keys[i]];</div><div class="line">&#125;;</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>);</div><div class="line">camera.lookAt(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> sm = &#123;</div><div class="line">   <span class="attr">pointer</span>: <span class="keyword">new</span> THREE.Vector2(),</div><div class="line">   <span class="attr">uidown</span>: <span class="literal">false</span>,</div><div class="line">   <span class="attr">pointerdown</span>: <span class="literal">false</span>,</div><div class="line">   <span class="attr">FPS_UPDATE</span>: <span class="number">20</span>,     <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">   FPS_MOVEMENT: <span class="number">30</span>,  <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">   FRAME_MAX: <span class="number">900</span>,</div><div class="line">   <span class="attr">secs</span>: <span class="number">0</span>,</div><div class="line">   <span class="attr">frame_frac</span>: <span class="number">0</span>,    <span class="comment">// 30.888 / 450</span></div><div class="line">   frame: <span class="number">0</span>,         <span class="comment">// 30 / 450</span></div><div class="line">   tick: <span class="number">0</span>,           <span class="comment">//  1 / 450 ( about 1 FPS then )</span></div><div class="line">   now: <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">   <span class="attr">lt</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">sm</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = sm.frame / sm.FRAME_MAX;</div><div class="line">    <span class="keyword">const</span> a2 = a1 * (<span class="number">8</span> * ac.items.speed.a) % <span class="number">1</span>;</div><div class="line">    <span class="keyword">const</span> angle1 = <span class="built_in">Math</span>.PI * <span class="number">2</span> * a2;</div><div class="line">    <span class="keyword">const</span> angle2 = <span class="built_in">Math</span>.PI * <span class="number">0.5</span> * ac.items.angel.a</div><div class="line">    q1.setFromAxisAngle(axis1, angle1);</div><div class="line">    q2.setFromAxisAngle(axis2, angle2);</div><div class="line">    <span class="keyword">const</span> q3 = q1.clone().slerp(q2, ac.items.slerp.a);</div><div class="line">    <span class="keyword">const</span> q4 = q2.clone().slerp(q1, ac.items.slerp.a);</div><div class="line">    mesh1.quaternion.copy(q3).premultiply(q4)</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> render2d = <span class="function">(<span class="params">sm</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">// background</span></div><div class="line">    ctx.fillStyle = <span class="string">'rgba(0,0,0,1)'</span>;</div><div class="line">    ctx.fillRect(<span class="number">0</span>,<span class="number">0</span>, canvas_2d.width, canvas_2d.height);</div><div class="line">    <span class="comment">// draw webGl renderer dom element</span></div><div class="line">    ctx.drawImage(renderer.domElement, <span class="number">0</span>, <span class="number">0</span>, canvas_2d.width, canvas_2d.height);</div><div class="line">    <span class="comment">// debug info</span></div><div class="line">    ctx.fillStyle = <span class="string">'rgba(0,0,0,0.4)'</span>;</div><div class="line">    ctx.fillRect(<span class="number">0</span>,<span class="number">0</span>, canvas_2d.width, canvas_2d.height);</div><div class="line">    ctx.fillStyle = <span class="string">'white'</span>;</div><div class="line">    ctx.textBaseline = <span class="string">'top'</span>;</div><div class="line">    ctx.textAlign = <span class="string">'left'</span></div><div class="line">    ctx.font = <span class="string">'10px monospace'</span>;</div><div class="line">    ctx.fillText(<span class="string">'tick              : '</span> + sm.tick, <span class="number">5</span>, <span class="number">5</span>)</div><div class="line">    ctx.fillText(<span class="string">'frame_frac        : '</span> + sm.frame_frac.toFixed(<span class="number">3</span>), <span class="number">5</span>, <span class="number">20</span>);</div><div class="line">    ctx.fillText(<span class="string">'frame / FRAME_MAX : '</span> + sm.frame + <span class="string">'/'</span> + sm.FRAME_MAX, <span class="number">5</span>, <span class="number">35</span>);</div><div class="line">    ctx.fillText(<span class="string">'pointer : '</span> + sm.pointer.x.toFixed(<span class="number">2</span>) + <span class="string">','</span> + sm.pointer.y.toFixed(<span class="number">2</span>), <span class="number">5</span>, <span class="number">50</span>);</div><div class="line">    <span class="comment">// alpha controls</span></div><div class="line">    ctx.fillStyle = <span class="string">'gray'</span>;</div><div class="line">    ctx.fillRect(ac.x, ac.y, ac.w, ac.h);</div><div class="line">    ac.forEachItem( <span class="function">(<span class="params">item, i, arr</span>) =&gt;</span> &#123;</div><div class="line">        ctx.fillStyle = <span class="string">'cyan'</span>;</div><div class="line">        ctx.strokeStyle = <span class="string">'#8a8a8a'</span>;</div><div class="line">        <span class="keyword">const</span> h = ac.h / arr.length;</div><div class="line">        ctx.beginPath();</div><div class="line">        ctx.rect(ac.x, ac.y + h * i, ac.w * item.a, h);</div><div class="line">        ctx.fill();</div><div class="line">        ctx.stroke();</div><div class="line">        ctx.fillStyle = <span class="string">'black'</span>;</div><div class="line">        ctx.textAlign = <span class="string">'center'</span>;</div><div class="line">        ctx.textBaseline = <span class="string">'middle'</span>;</div><div class="line">        ctx.font = <span class="built_in">Math</span>.floor(h / <span class="number">4</span>) + <span class="string">'px arial'</span></div><div class="line">        ctx.fillText(item.desc, ac.x + ac.w / <span class="number">2</span>, ac.y + h / <span class="number">2</span> + h * i);</div><div class="line">    &#125; );</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    sm.now = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    sm.secs = (sm.now - sm.lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(sm.secs &gt; <span class="number">1</span> / sm.FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render to 3d canvas, and then render to 2d canvas</span></div><div class="line">        update(sm);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        render2d(sm);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        sm.frame_frac += sm.FPS_MOVEMENT * sm.secs;</div><div class="line">        sm.frame_frac %= sm.FRAME_MAX;</div><div class="line">        sm.frame = <span class="built_in">Math</span>.floor(sm.frame_frac);</div><div class="line">        sm.tick = (sm.tick += <span class="number">1</span>) % sm.FRAME_MAX;</div><div class="line">        sm.lt = sm.now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// EVENTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> boundingBox = <span class="function"><span class="keyword">function</span> (<span class="params">x1, y1, w1, h1, x2, y2, w2, h2</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> !(</div><div class="line">        (y1 + h1) &lt; y2 ||</div><div class="line">        y1 &gt; (y2 + h2) ||</div><div class="line">        (x1 + w1) &lt; x2 ||</div><div class="line">        x1 &gt; (x2 + w2));</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> pointerEventCommon = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> el = e.target;</div><div class="line">    <span class="keyword">const</span> bx = el.getBoundingClientRect();</div><div class="line">    <span class="comment">// update pointer</span></div><div class="line">    sm.pointer.x = e.clientX - bx.left;</div><div class="line">    sm.pointer.y = e.clientY - bx.top;</div><div class="line">&#125;;</div><div class="line">canvas_2d.addEventListener(<span class="string">'pointerdown'</span>, (e) =&gt; &#123;</div><div class="line">    sm.pointerdown = <span class="literal">true</span>;</div><div class="line">    sm.uidown = <span class="literal">false</span>;</div><div class="line">    pointerEventCommon(e);</div><div class="line">    <span class="keyword">if</span>( boundingBox(sm.pointer.x, sm.pointer.y, <span class="number">1</span>, <span class="number">1</span>, ac.x, ac.y, ac.w, ac.h) &amp;&amp; sm.pointerdown)&#123;</div><div class="line">        sm.uidown = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">let</span> a_y = (sm.pointer.y - ac.y) / ac.h;</div><div class="line">        a_y = THREE.MathUtils.clamp(a_y, <span class="number">0</span>, <span class="number">0.99</span>);</div><div class="line">        a_x = (sm.pointer.x - ac.x) / ac.w;</div><div class="line">        a_x = THREE.MathUtils.clamp(a_x, <span class="number">0</span>, <span class="number">0.99</span>);</div><div class="line">        sm.i_item = <span class="built_in">Math</span>.floor(ac.itemCount * a_y);</div><div class="line">        ac.getItem(sm.i_item).a = a_x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(THREE.OrbitControls)&#123;</div><div class="line">        controls.enabled = !sm.uidown;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">canvas_2d.addEventListener(<span class="string">'pointermove'</span>, (e) =&gt; &#123;</div><div class="line">    pointerEventCommon(e);</div><div class="line">    <span class="keyword">if</span>(sm.uidown)&#123;</div><div class="line">        <span class="keyword">let</span> a_x = (sm.pointer.x - ac.x) / ac.w;</div><div class="line">        a_x = THREE.MathUtils.clamp(a_x, <span class="number">0</span>, <span class="number">0.99</span>);</div><div class="line">        ac.getItem(sm.i_item).a = a_x;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">canvas_2d.addEventListener(<span class="string">'pointerup'</span>, (e) =&gt; &#123;</div><div class="line">    sm.pointerdown = <span class="literal">false</span>;</div><div class="line">    sm.uidown = <span class="literal">false</span>;</div><div class="line">    pointerEventCommon(e);</div><div class="line">    <span class="keyword">if</span>(THREE.OrbitControls)&#123;</div><div class="line">        controls.enabled = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="2-2-Animation-loop-of-three-spheres"><a href="#2-2-Animation-loop-of-three-spheres" class="headerlink" title="2.2 - Animation loop of three spheres"></a>2.2 - Animation loop of three spheres</h3><p>For this animation loop example I wanted to make something that involves three sphere objects two of which are of a single state of a quaternion object, while the final one is the result of a premultiply call involving the other two.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SCENE, CAMERA, RENDERER</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> scene = <span class="keyword">new</span> THREE.Scene();</div><div class="line"><span class="keyword">const</span> camera = <span class="keyword">new</span> THREE.PerspectiveCamera(<span class="number">50</span>, <span class="number">32</span> / <span class="number">24</span>, <span class="number">0.1</span>, <span class="number">1000</span>);</div><div class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> THREE.WebGL1Renderer();</div><div class="line">renderer.setSize(<span class="number">640</span>, <span class="number">480</span>, <span class="literal">false</span>);</div><div class="line">(<span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>) || <span class="built_in">document</span>.body).appendChild(renderer.domElement);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// HELPERS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> makeMesh = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshNormalMaterial(&#123;<span class="attr">wireframe</span>: <span class="literal">true</span>, <span class="attr">wireframeLinewidth</span>: <span class="number">2</span> &#125;);</div><div class="line">    <span class="keyword">const</span> mesh_parent = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.SphereGeometry(<span class="number">1</span>, <span class="number">12</span>, <span class="number">12</span>),</div><div class="line">        material);</div><div class="line">    <span class="keyword">const</span> mesh_child = <span class="keyword">new</span> THREE.Mesh(</div><div class="line">        <span class="keyword">new</span> THREE.CylinderGeometry(<span class="number">0</span>, <span class="number">0.25</span>, <span class="number">0.5</span>, <span class="number">8</span>, <span class="number">8</span>),</div><div class="line">        material);</div><div class="line">    mesh_child.position.y = <span class="number">1.25</span>;</div><div class="line">    mesh_parent.add(mesh_child);</div><div class="line">    <span class="keyword">return</span> mesh_parent;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// OBJECTS</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">scene.add( <span class="keyword">new</span> THREE.GridHelper( <span class="number">10</span>,<span class="number">10</span> ) );</div><div class="line"><span class="keyword">const</span> mesh1 = makeMesh();</div><div class="line">mesh1.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">-2.5</span>);</div><div class="line">scene.add(mesh1);</div><div class="line"><span class="keyword">const</span> mesh2 = makeMesh();</div><div class="line">mesh2.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">2.5</span>);</div><div class="line">scene.add(mesh2);</div><div class="line"><span class="keyword">const</span> mesh3 = makeMesh();</div><div class="line">mesh3.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">scene.add(mesh3);</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// SETTING ROTATION WITH QUATERNION</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="keyword">const</span> q = <span class="keyword">new</span> THREE.Quaternion();</div><div class="line"><span class="keyword">const</span> q1 = q.clone();</div><div class="line"><span class="keyword">const</span> q2 = q.clone();</div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line"><span class="comment">// ANIMATION LOOP</span></div><div class="line"><span class="comment">// ---------- ----------</span></div><div class="line">camera.position.set( <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span> );</div><div class="line">camera.lookAt(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"><span class="keyword">const</span> FPS_UPDATE = <span class="number">20</span>, <span class="comment">// fps rate to update ( low fps for low CPU use, but choppy video )</span></div><div class="line">FPS_MOVEMENT = <span class="number">30</span>;     <span class="comment">// fps rate to move object by that is independent of frame update rate</span></div><div class="line">FRAME_MAX = <span class="number">900</span>;</div><div class="line"><span class="keyword">let</span> secs = <span class="number">0</span>,</div><div class="line">frame = <span class="number">0</span>,</div><div class="line">lt = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="comment">// update</span></div><div class="line"><span class="keyword">const</span> axis1 = <span class="keyword">new</span> THREE.Vector3( <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> );</div><div class="line"><span class="keyword">const</span> e1 = <span class="keyword">new</span> THREE.Euler();</div><div class="line"><span class="keyword">const</span> axis2 = <span class="keyword">new</span> THREE.Vector3( <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> );</div><div class="line"><span class="keyword">const</span> update = <span class="function"><span class="keyword">function</span>(<span class="params">frame, frameMax</span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> a1 = frame / frameMax;</div><div class="line">    <span class="keyword">const</span> a2 = a1 * <span class="number">1</span> % <span class="number">1</span>;</div><div class="line">    <span class="keyword">const</span> a3 = a1 * (<span class="number">16</span> * <span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI * a1) ) % <span class="number">1</span>;</div><div class="line">    <span class="keyword">const</span> radian1 = <span class="built_in">Math</span>.PI * <span class="number">2</span> * a2;</div><div class="line">    e1.x = <span class="built_in">Math</span>.cos(radian1);</div><div class="line">    e1.y = <span class="number">0</span>;</div><div class="line">    e1.z = <span class="built_in">Math</span>.sin(radian1);</div><div class="line">    axis1.set( <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span> ).applyEuler(e1);</div><div class="line">    <span class="keyword">const</span> deg1 = <span class="number">90</span>;</div><div class="line">    <span class="keyword">const</span> deg2 = <span class="number">360</span> * a3;</div><div class="line">    <span class="comment">// set q1 and q2 using setFromAxisAngle method</span></div><div class="line">    q1.setFromAxisAngle( axis1.normalize(), THREE.MathUtils.degToRad(deg1) );</div><div class="line">    q2.setFromAxisAngle( axis2.normalize(), THREE.MathUtils.degToRad(deg2) );</div><div class="line">    <span class="comment">// update mesh object local rotations with quaternion objects</span></div><div class="line">    <span class="comment">// where mesh1 and mesh 2 are just the current state of q1 and q2</span></div><div class="line">    <span class="comment">// and the rotation of mesh3 is q1 premultiplyed by q2</span></div><div class="line">    mesh1.quaternion.copy(q1);</div><div class="line">    mesh2.quaternion.copy(q2);</div><div class="line">    mesh3.quaternion.copy(q1).premultiply(q2);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// loop</span></div><div class="line"><span class="keyword">const</span> loop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">    secs = (now - lt) / <span class="number">1000</span>;</div><div class="line">    requestAnimationFrame(loop);</div><div class="line">    <span class="keyword">if</span>(secs &gt; <span class="number">1</span> / FPS_UPDATE)&#123;</div><div class="line">        <span class="comment">// update, render</span></div><div class="line">        update( <span class="built_in">Math</span>.floor(frame), FRAME_MAX);</div><div class="line">        renderer.render(scene, camera);</div><div class="line">        <span class="comment">// step frame</span></div><div class="line">        frame += FPS_MOVEMENT * secs;</div><div class="line">        frame %= FRAME_MAX;</div><div class="line">        lt = now;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">loop();</div></pre></td></tr></table></figure>
<h2 id="3-Conclusion"><a href="#3-Conclusion" class="headerlink" title="3 - Conclusion"></a>3 - Conclusion</h2><p>The premultiply method is one or the core set of quaternion methods that I will want to work with in order to use these kinds of objects to set orientation of object3d class based objects in threejs. There is knowing how to set the state of just one of these quaternion objects first and foremost though and for that there is the set from axis angle method. There is also knowing how to just directly mutate the public values of one of these objects but doing that is not as easy as what one might be used to with Euler objects. Anyway once one knows how to set the orientation of one quaternion object, there is doing so with another, and then using both of those to set an orientation of yet another and one way to do so is with premultiply.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/" data-id="cliqa08fj02ddbwv1udgx4vw2" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/three-js/">three.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/04/07/threejs-quaternion-setfromunitvectors/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Quaternion set from unit vectors method in threejs
        
      </div>
    </a>
  
  
    <a href="/2023/03/24/threejs-quaternion/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Quaternion rotation objects in threejs</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/index.html';
    this.page.identifier = '1034';
    this.page.title = 'Quaternion premultiply method in threejs';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electronjs/">electronjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/electronjs/">electronjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 15.45px;">blog</a> <a href="/tags/canvas/" style="font-size: 18.64px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/electronjs/" style="font-size: 13.64px;">electronjs</a> <a href="/tags/express/" style="font-size: 16.82px;">express</a> <a href="/tags/games/" style="font-size: 17.27px;">games</a> <a href="/tags/git/" style="font-size: 13.64px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.55px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.73px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.64px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.55px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.18px;">phaser</a> <a href="/tags/python/" style="font-size: 15.91px;">python</a> <a href="/tags/statistics/" style="font-size: 14.09px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 19.09px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 16.36px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/23/threejs-lathe-geometry/">Lathe Geometry in threejs</a>
          </li>
        
          <li>
            <a href="/2023/06/09/threejs-vector2/">The Vector2 class for 2D curves, mouse pointers, ect</a>
          </li>
        
          <li>
            <a href="/2023/06/08/linux-dd/">Linux dd command and files</a>
          </li>
        
          <li>
            <a href="/2023/06/06/linux-sysbench/">Linux sysbench command for benchmarking a file system</a>
          </li>
        
          <li>
            <a href="/2023/06/02/threejs-tube-geometry/">Tube Geometry in threejs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2021/02/19/threejs-examples/" class="mobile-nav-link">ThreeJS</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas</a>
  
    <a href="https://www.youtube.com/user/javaweaver" class="mobile-nav-link">Youtube</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2023/03/31/threejs-quaternion-premultiply/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>