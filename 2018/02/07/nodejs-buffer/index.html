<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- disqus image-->
  <meta property="og:image" content="https://dustinpfister.github.io/css/images/banner.jpg">
  
  <title>Buffers in node.js | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2018/02/07/nodejs-buffer/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="When node.js was first developed there where no typed arrays such as Uint8Array to help work with binary data. As such Buffer was introduced to help work with binary data in a node.js environment. Buf">
<meta property="og:type" content="article">
<meta property="og:title" content="Buffers in node.js">
<meta property="og:url" content="https://dustinpfister.github.io/2018/02/07/nodejs-buffer/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="When node.js was first developed there where no typed arrays such as Uint8Array to help work with binary data. As such Buffer was introduced to help work with binary data in a node.js environment. Buf">
<meta property="og:updated_time" content="2021-03-19T17:57:29.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Buffers in node.js">
<meta name="twitter:description" content="When node.js was first developed there where no typed arrays such as Uint8Array to help work with binary data. As such Buffer was introduced to help work with binary data in a node.js environment. Buf">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/2020/03/23/canvas-example/">Canvas-Examples</a>
        
          <a class="main-nav-link" href="https://github.com/dustinpfister">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-nodejs-buffer" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/07/nodejs-buffer/" class="article-date"> Published:
  <time datetime="2018-02-08T03:23:00.000Z" itemprop="datePublished">2018-02-07</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2018/02/07/nodejs-buffer/" class="article-date"> Modified:
  <time datetime="2021-03-19T17:57:29.000Z" itemprop="dateModified">2021-03-19</time>
</a>

    <span class="article-date">V1.24</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Buffers in node.js
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>When <a href="https://nodejs.org/en/" target="_blank" rel="external">node.js</a> was first developed there where no typed arrays such as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" target="_blank" rel="external">Uint8Array</a> to help work with binary data. As such <a href="https://nodejs.org/dist/latest-v8.x/docs/api/buffer.html" target="_blank" rel="external">Buffer</a> was introduced to help work with binary data in a node.js environment. Buffers are something that I run into when working with streams, ether file io streams, or from http requests. In any case Buffers are helpful when doing anything that involves working with raw binary data. So lets take a look at some examples of buffers in node.js.</p>
<a id="more"></a>
<h2 id="1-nodejs-buffer-global-and-what-to-know-before-continuing"><a href="#1-nodejs-buffer-global-and-what-to-know-before-continuing" class="headerlink" title="1 - nodejs buffer global and what to know before continuing"></a>1 - nodejs buffer global and what to know before continuing</h2><p>THis is a post on using buffers in nodejs to work with binary data in a node.js environment. There is a lot to know about when working with buffers, such as how to create them in the first place, and how it has changed compared to older versions of node.js. Anyway I hope that you have at least some background with node.js, and javaSciprt in general, as I will not be coving the basics of those topics here.</p>
<p>In this post I was using nodejs 8.x LTS which at the time of this writing is still supported, but it coming to the end of its support cycle. If you are using an older or newer version of nodejs what is written here may not be applicable.</p>
<h2 id="2-New-buffers-more-than-one-way-to-do-it"><a href="#2-New-buffers-more-than-one-way-to-do-it" class="headerlink" title="2 - New buffers more than one way to do it"></a>2 - New buffers more than one way to do it</h2><p>So lets start out with some very basic examples of buffers that have to do with just creating a new buffer. There is a <a href="/2019/06/17/nodejs-buffer-new/">post that I wrote on this very topic of creating new buffers</a>, but in this section I will be going over a few example here. There is more than one way to make them, and in both safe, and unsafe ways as well. There is also the old way of making them that you might only bother with if you are still using a real old version of node.js for some reason. So lets get started with some buffer hello world examples of making a new buffer instance in nodejs.</p>
<h3 id="2-1-The-old-way-of-doing-it-do-not-do-it-unless-for-some-reason-you-have-to"><a href="#2-1-The-old-way-of-doing-it-do-not-do-it-unless-for-some-reason-you-have-to" class="headerlink" title="2.1 - The old way of doing it (do not do it unless for some reason you have to)"></a>2.1 - The old way of doing it (do not do it unless for some reason you have to)</h3><p>So the old way of making a buffer was to use the Nodejs Buffer global like that of any old jaavScript constructor method. In other words like that of the Date constructor that is used with the new keyword to create a new instance of Date. I call Buffer with the new keyword, and pass whatever it is that I want placed in a buffer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buff = <span class="keyword">new</span> Buffer(<span class="string">'this is how it once was'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 74 68 69 73 20 69 73 20 68 6f 77 20 69 74 20 6f 6e 63 65 20 77 61 73&gt;</span></div></pre></td></tr></table></figure>
<p>This should not be used any more unless for some reason you are using a real old version of node.js that does not support the newer ways to make a buffer, in which case I guess you have to. This way of creating a new buffer still shows up a lot with code examples on the open web, but it does open up some security concerns, and it has been deprecated when it comes to more modern versions of nodejs. I will not be getting into this in detail in this post as I have done so in <a href="/2019/06/17/nodejs-buffer-new/">another post</a> on creating a new buffer with the new keyword, you can check that out if you want to.</p>
<h3 id="2-2-Using-Buffer-from-to-create-a-new-buffer"><a href="#2-2-Using-Buffer-from-to-create-a-new-buffer" class="headerlink" title="2.2 - Using Buffer.from to create a new buffer."></a>2.2 - Using Buffer.from to create a new buffer.</h3><p>As of late (node 8.x+) it is advised to not use the Buffer constructor directly, in fact doing so is depreciated, instead when dealing with buffers the various methods of Buffer are what should be used in order to work with buffers. For example the buffer from method works great for quickly creating a new buffer with an initial value that is derived from a string.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> buff = Buffer.from(<span class="string">'hello buffer!'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 68 65 6c 6c 6f 20 62 75 66 66 65 72 21&gt;</span></div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff.toString());</div><div class="line"><span class="comment">// 'hello buffer!'</span></div></pre></td></tr></table></figure>
<p>So then <a href="/2019/07/19/nodejs-buffer-from/">Buffer.from</a> is one such method and in most cases however maybe it is desired to create a blank buffer that is filled with zeros, or maybe you do not event want to do that. That being said there are of course other options such as Buffer.alloc, and Buffer.allocUnsafe.</p>
<h3 id="2-3-Buffer-alloc-can-be-used-for-safe-allocation-of-memory-for-a-buffer"><a href="#2-3-Buffer-alloc-can-be-used-for-safe-allocation-of-memory-for-a-buffer" class="headerlink" title="2.3 - Buffer.alloc can be used for safe allocation of memory for a buffer"></a>2.3 - Buffer.alloc can be used for safe allocation of memory for a buffer</h3><p>The Buffer.alloc method is great for just setting up a buffer of a fixed byte size in a safe way that will assure that noting old in memory will end up being part of the buffer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> buff = Buffer.alloc(<span class="number">4</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 00 00 00 00&gt;</span></div><div class="line"> </div><div class="line">buff = Buffer.alloc(<span class="number">5</span>,<span class="string">'hello'</span>,<span class="string">'ascii'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 68 65 6c 6c 6f&gt;</span></div></pre></td></tr></table></figure>
<p>If I want to I can also give a string to pre fill the buffer with, and give a character encoding to observe when parsing the string to a buffer.</p>
<h3 id="2-4-Using-Buffer-allocUnsafe-for-faster-but-unsafe-buffers"><a href="#2-4-Using-Buffer-allocUnsafe-for-faster-but-unsafe-buffers" class="headerlink" title="2.4 - Using Buffer.allocUnsafe for faster, but unsafe buffers"></a>2.4 - Using Buffer.allocUnsafe for faster, but unsafe buffers</h3><p>So it might be fun to play around with unsafe buffers to see if I can make sense of old data in memory, and find out if they really are unsafe. I can understand why in theory at least, and it is not to hard to reproduce why. Just try out on yourself, and then look at what you get, a whole bunch of old data in memory. Compare that to what happens when you just use Buffer.alloc, and you get nothing but zeros.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> oldData = Buffer.allocUnsafe(<span class="number">256</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(oldData);</div><div class="line"><span class="comment">// &lt;Buffer 08 00 00 00 07 00 00 00 70 6c dc 90 </span></div><div class="line"><span class="comment">// b1 02 00 00 00 00 00 00 00 00 00 00 00 00 00 </span></div><div class="line"><span class="comment">// 00 00 00 00 00 00 00 00 00 08 00 00 00 30 f0 </span></div><div class="line"><span class="comment">// b7 bd f7 7f 00 00 01 00 ... &gt;</span></div><div class="line"> </div><div class="line"><span class="keyword">let</span> safeBuff = Buffer.alloc(<span class="number">256</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(safeBuff);</div><div class="line"><span class="comment">// &lt;Buffer 00 00 00 00 00 00 00 00 00 00 00 </span></div><div class="line"><span class="comment">// 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span></div><div class="line"><span class="comment">// 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span></div><div class="line"><span class="comment">// 00 00 00 00 00 00 00 00 00 ... &gt;</span></div></pre></td></tr></table></figure>
<h2 id="3-Buffers-are-array-like"><a href="#3-Buffers-are-array-like" class="headerlink" title="3 - Buffers are array like"></a>3 - Buffers are array like</h2><p>It turns out that buffers are yet another example of a kind of object in javaScript that is array like. What I mean by array like is that they are not really arrays, but because they kind of are like arrays, I can get away with using some array methods on them by using call, or apply. They then also have a length property as well, however the length property will give me the size of the array, rather than the number of elements if it was an array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> buff = Buffer.from(<span class="string">'ABCD'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">Array</span>.prototype.forEach.call(buff, <span class="function"><span class="keyword">function</span> (<span class="params">currentByte</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="built_in">console</span>.log(currentByte);</div><div class="line"> </div><div class="line">&#125;);</div><div class="line"> </div><div class="line"><span class="comment">/*</span></div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">*/</div><div class="line"> </div><div class="line">buff = Buffer.alloc(<span class="number">4</span>);</div><div class="line"> </div><div class="line">buff[<span class="number">1</span>] = <span class="number">0x65</span>;</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(buff); <span class="comment">// &lt;Buffer 00 65 00 00&gt;</span></div></pre></td></tr></table></figure>
<h2 id="4-concatenating-buffers"><a href="#4-concatenating-buffers" class="headerlink" title="4 - concatenating buffers"></a>4 - concatenating buffers</h2><p>Concatenating buffers is just a matter of using Buffer.concat. This method works bu just calling it, and passing it an array of two or more buffers. The method will figure out the length of the new buffer that will be returned, this will take a little overhead as you might expect, so if you do know what the length of the result will be before hand it would make sense to pass that as the second argument when calling the method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> buffs = [</div><div class="line">   Buffer.from(<span class="string">'this '</span>),</div><div class="line">   Buffer.from(<span class="string">'might '</span>),</div><div class="line">   Buffer.from(<span class="string">'work'</span>)</div><div class="line">];</div><div class="line"> </div><div class="line"><span class="keyword">let</span> len = buffs.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc,buf</span>)</span>&#123; <span class="keyword">return</span> &#123;<span class="attr">length</span>: acc.length + buf.length&#125;;&#125;).length;</div><div class="line"> </div><div class="line"><span class="comment">// this will of course work</span></div><div class="line"><span class="keyword">let</span> buff = Buffer.concat(buffs,len);</div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 74 68 69 73 20 6d 69 67 68 74 20 77 6f 72 6b&gt;</span></div><div class="line"> </div><div class="line"><span class="comment">// I can just give the buffers as well</span></div><div class="line"><span class="comment">// this still figures out the length though</span></div><div class="line"><span class="comment">// so if it is know, the value should be passed</span></div><div class="line">buff = Buffer.concat(buffs);</div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 74 68 69 73 20 6d 69 67 68 74 20 77 6f 72 6b&gt;</span></div><div class="line"> </div><div class="line"><span class="comment">// This will of course just result in the first six bytes</span></div><div class="line">buff = Buffer.concat(buffs, <span class="number">6</span>);</div><div class="line"><span class="built_in">console</span>.log(buff);</div><div class="line"><span class="comment">// &lt;Buffer 74 68 69 73 20 6d&gt;</span></div></pre></td></tr></table></figure>
<h2 id="5-Encoding"><a href="#5-Encoding" class="headerlink" title="5 - Encoding"></a>5 - Encoding</h2><p>It is possible to set the encoding that should be used when making a buffer. This can be important when say, creating a buffer from a string that contains characters that are above the ascii range. The number of bytes that a character takes up is different depending on the character encoding. The ascii character encoding is easy to understand, because it is just a single byte per character, however that is not how Unicode works. With Unicode that number of bytes can range from one upwards depending on what the character is.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//let dp = [0xe2, 0x82, 0xaf];</span></div><div class="line"> </div><div class="line"><span class="comment">// text containing Drachma sign</span></div><div class="line"><span class="keyword">let</span> text = <span class="string">'\u20af'</span>;</div><div class="line"> </div><div class="line"><span class="comment">// ascii encoding</span></div><div class="line"><span class="keyword">let</span> ascii = Buffer.from(text,<span class="string">'ascii'</span>);</div><div class="line"> </div><div class="line"><span class="comment">// utf-8 encoding</span></div><div class="line"><span class="keyword">let</span> utf8 = Buffer.from(text,<span class="string">'utf-8'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(ascii);</div><div class="line"><span class="comment">// &lt;Buffer af&gt;</span></div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(utf8);</div><div class="line"><span class="comment">// &lt;Buffer e2 82 af&gt;</span></div></pre></td></tr></table></figure>
<h2 id="6-File-io-examples"><a href="#6-File-io-examples" class="headerlink" title="6 - File io examples"></a>6 - File io examples</h2><p>So one of the big things about buffers is that they comes up a lot when working with files. When using the file system module, or any kind of readable, writable, or duplex stream involving data from the file system buffers are the node.js standard way of working with binary data stored in on then hard drive. So lets take a look at a few examples that involve files\</p>
<h3 id="6-1-Readable-streams"><a href="#6-1-Readable-streams" class="headerlink" title="6.1 - Readable streams"></a>6.1 - Readable streams</h3><p>So when it comes to reading a file using the fs.createReadStream method in the file system module, this will result in a readable stream. This has some events that can be used to define a callback that will fire each time some more chunks of data come along in the readable stream. The chunks are of course instances of buffer, and now that we know a thing or two about buffers we should have no problem working with them when it comes to doing something with a readable stream.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),</div><div class="line"> </div><div class="line">buff = Buffer.alloc(<span class="number">0</span>);</div><div class="line"> </div><div class="line"><span class="comment">// start a read stream for a test.txt file</span></div><div class="line">fs.createReadStream(<span class="string">'test.txt'</span>)</div><div class="line"> </div><div class="line">.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="comment">// concatenate buff, and chunk both of which are buffers</span></div><div class="line">    buff = Buffer.concat([buff, chunk], buff.length + chunk.length);</div><div class="line"> </div><div class="line">&#125;)</div><div class="line"> </div><div class="line">.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="built_in">console</span>.log(buff.toString());</div><div class="line"> </div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="6-2-writable-streams"><a href="#6-2-writable-streams" class="headerlink" title="6.2 - writable streams"></a>6.2 - writable streams</h3><p>There is of course writable streams as well, for example when using the fs.createWriteStream method, a buffer can be given as an argument to the write method. When creating, or appending a file.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),</div><div class="line"> </div><div class="line"><span class="comment">// start a write stream in a+ mode</span></div><div class="line">file = fs.createWriteStream(process.argv[<span class="number">2</span>],&#123;<span class="attr">flags</span>:<span class="string">'a+'</span>&#125;);</div><div class="line"> </div><div class="line"><span class="comment">// write to the file with a buffer</span></div><div class="line">file.write(Buffer.from(process.argv[<span class="number">3</span>]));</div><div class="line"> </div><div class="line"><span class="comment">// end</span></div><div class="line">file.end();</div></pre></td></tr></table></figure>
<p>With this example I can use this script from the command line like this if it is called write.js, and the above example on read streams is called read.js.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node write test.txt &quot;this is only a test&quot;</div><div class="line">$ node read</div><div class="line">this is only a test</div><div class="line">$ node write test.txt &quot; looks like it is working okay&quot;</div><div class="line">$ node read</div><div class="line">this is only a test looks like it is working okay</div></pre></td></tr></table></figure>
<h2 id="7-How-to-find-out-if-you-are-dealing-with-a-buffer"><a href="#7-How-to-find-out-if-you-are-dealing-with-a-buffer" class="headerlink" title="7 - How to find out if you are dealing with a buffer"></a>7 - How to find out if you are dealing with a buffer</h2><p>So if you are testing a whole bunch of values to find out if a value is a buffer or not there is the <a href="/2019/10/30/nodejs-buffer/">native is buffer</a> method of the buffer global. Just call the method and pass a value that is to be tested, and it will return true if the value is a buffer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> buff = Buffer.from(<span class="string">'0a0b0c0d'</span>, <span class="string">'hex'</span>);</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(Buffer.isBuffer(buff)); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>After doing a basic test of this method it would appear that it works as expected, at least with all the values I passed to it. So it would seem that the is buffer method in node works as expected and there is not much of any need for a user space solution for this one.</p>
<h2 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8 - Conclusion"></a>8 - Conclusion</h2><p>I hope you found this post on buffers a little helpful, if you did not know much about them before hand. If you enjoyed reading this post you might want to also check out my post on using <a href="/2018/08/15/nodejs-request-streams/">request to work with streams</a> when scripting http. Buffers do come up a lot when it comes to working with file io, streams, and just about anything that has to do with binary data, so this is one aspect of node.js development that developers should get solid.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2018/02/07/nodejs-buffer/" data-id="ckx9e2g5501ft3kv1xcozob2c" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2018/02/07/nodejs-buffer/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/02/08/nodejs-filesystem/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Working with the file system module in node.js
        
      </div>
    </a>
  
  
    <a href="/2018/02/06/nodejs-http/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">The node.js http module and setting up a simple web server with just native javaScript.</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2018/02/07/nodejs-buffer/index.html';
    this.page.identifier = '147';
    this.page.title = 'Buffers in node.js';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.27px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.45px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.18px;">angular</a> <a href="/tags/animation/" style="font-size: 11.82px;">animation</a> <a href="/tags/automation/" style="font-size: 11.82px;">automation</a> <a href="/tags/backbone/" style="font-size: 12.27px;">backbone</a> <a href="/tags/blog/" style="font-size: 14.55px;">blog</a> <a href="/tags/canvas/" style="font-size: 19.09px;">canvas</a> <a href="/tags/corejs/" style="font-size: 12.73px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 10.91px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.36px;">ejs</a> <a href="/tags/express/" style="font-size: 16.36px;">express</a> <a href="/tags/games/" style="font-size: 16.82px;">games</a> <a href="/tags/git/" style="font-size: 12.73px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 11.82px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.09px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.45px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.36px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 17.27px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.18px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.09px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.55px;">node.js</a> <a href="/tags/phaser/" style="font-size: 17.73px;">phaser</a> <a href="/tags/python/" style="font-size: 15.45px;">python</a> <a href="/tags/statistics/" style="font-size: 13.64px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 18.64px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 15.91px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/10/js-javascript-example-turn-based-rpg/">Making a turn based RPG game javaScript project example</a>
          </li>
        
          <li>
            <a href="/2021/12/03/threejs-examples-menus/">Menus and crude state machine threejs example</a>
          </li>
        
          <li>
            <a href="/2021/11/26/linux-tar/">The Linux tar command for compressions files and folders</a>
          </li>
        
          <li>
            <a href="/2021/11/23/linux-tree/">The Linux tree command</a>
          </li>
        
          <li>
            <a href="/2021/11/19/linux-xxd/">The Linux xxd command for dumping hex to the standard output rather than text</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/2020/03/23/canvas-example/" class="mobile-nav-link">Canvas-Examples</a>
  
    <a href="https://github.com/dustinpfister" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2018/02/07/nodejs-buffer/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>