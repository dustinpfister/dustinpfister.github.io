<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>Setting collsion in a tilemap with phaser | Dustin John Pfister at github pages</title>
  
  <!-- no index tag or blank here -->
  
  
  <link rel="canonical" href="https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/" />

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="These days I have been playing around with tilemaps a lot in phaser ce. When doing so for some projects I will want to set collision detection for some tiles. In this post I will be covering doing jus">
<meta property="og:type" content="article">
<meta property="og:title" content="Setting collsion in a tilemap with phaser">
<meta property="og:url" content="https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="These days I have been playing around with tilemaps a lot in phaser ce. When doing so for some projects I will want to set collision detection for some tiles. In this post I will be covering doing jus">
<meta property="og:updated_time" content="2018-09-27T16:08:48.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Setting collsion in a tilemap with phaser">
<meta name="twitter:description" content="These days I have been playing around with tilemaps a lot in phaser ce. When doing so for some projects I will want to set collision detection for some tiles. In this post I will be covering doing jus">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
  
  <!-- adsense if indexed -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1658284027672315",
    enable_page_level_ads: true
  });
  </script>
  
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>

<!-- adding my canvas thing ( Dustin ) -->
<script src="/js/the_matrix.js"></script>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-phaser-tilemap-set-collision-by-exclusion" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/26/phaser-tilemap-set-collision-by-exclusion/" class="article-date"> Published:
  <time datetime="2018-09-27T00:46:00.000Z" itemprop="datePublished">2018-09-26</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2018/09/26/phaser-tilemap-set-collision-by-exclusion/" class="article-date"> Modified:
  <time datetime="2018-09-27T16:08:48.000Z" itemprop="dateModified">2018-09-27</time>
</a>

    <span class="article-date">V1.12</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/phaser/">phaser</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Setting collsion in a tilemap with phaser
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>These days I have been playing around with <a href="https://photonstorm.github.io/phaser-ce/Phaser.Tilemap.html" target="_blank" rel="external">tilemaps</a> a lot in <a href="https://photonstorm.github.io/phaser-ce/" target="_blank" rel="external">phaser ce</a>. When doing so for some projects I will want to set collision detection for some tiles. In this post I will be covering doing just that with a method that woulds by setting collision tile index values by giving what index values I do not want to result in collision. This can be done with a helpful little method in the tilemap class called <a href="https://photonstorm.github.io/phaser-ce/Phaser.Tilemap.html#setCollisionByExclusion" target="_blank" rel="external">Tilemap.setCollisionByExclusion</a></p>
<a id="more"></a>
<h2 id="1-What-to-know"><a href="#1-What-to-know" class="headerlink" title="1 - What to know"></a>1 - What to know</h2><p>This is a post on setting up tile map collision detection, which is a necessary step in the process of making just about any kind of platform game with phaser ce and tile maps. I will not be covering tile maps in depth in this post, and assume that you have at least some background with phaser ce, and javaScript in general.</p>
<h3 id="1-1-This-is-a-phaser-ce-2-x-post"><a href="#1-1-This-is-a-phaser-ce-2-x-post" class="headerlink" title="1.1 - This is a phaser ce 2.x post"></a>1.1 - This is a phaser ce 2.x post</h3><p>In this post I am using <a href="https://photonstorm.github.io/phaser-ce/" target="_blank" rel="external">phaser community edition</a> 2.11.0, and not the newer phaser 3.x major release of <a href="https://phaser.io/" target="_blank" rel="external">phaser</a> the javaScript powered game framework.</p>
<h2 id="2-Example-of-setting-tile-map-collision-by-frame-index-exclusion"><a href="#2-Example-of-setting-tile-map-collision-by-frame-index-exclusion" class="headerlink" title="2 - Example of setting tile map collision by frame index exclusion"></a>2 - Example of setting tile map collision by frame index exclusion</h2><p>So there are a few ways to set up collision detection with a tile map, most if not all will involve setting an array of tile index values in an instance of a tile map. This could be done manually, but why bother with that if one of the tile map instance methods will work just fine? One such method is map.setCollisionByExclusion. This method works by just calling it and passing an array of tile index values in the map data that should be excluded from collision detection.</p>
<p>In this example I will be using map.setCollisionByExclusion to set the collision index values of a tile map, and have a little guy sprite run around in the map.</p>
<h3 id="2-1-The-create-stage-method"><a href="#2-1-The-create-stage-method" class="headerlink" title="2.1 - The create stage method"></a>2.1 - The create stage method</h3><p>I start off my main.js file with some helpers, this helps to break my code down and make it more fine grain which helps to make debugging easier when I run into problems, and I also find it helps to make code more readable for examples like this.</p>
<p>Anyway the first helper is my createStage helper that will be used to create a layer for a map that I will create before calling this, more on that later. In any case once I have a least one layer in the map, and that map is the current layer of the map, I just need to call map.setCollisionByExclusion and pass the frame index values that I do not want collision to happen for.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// load a stage from the current map</span></div><div class="line">createStage = <span class="function"><span class="keyword">function</span> (<span class="params">game, stageNum</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> map = game.data.map;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> stage = game.data.stage = map.createLayer(<span class="string">'stage'</span> + stageNum);</div><div class="line"> </div><div class="line">    <span class="comment">// set collision by excluding only indexes of zero or -1</span></div><div class="line">    map.setCollisionByExclusion([<span class="number">0</span>, <span class="number">-1</span>]);</div><div class="line"> </div><div class="line">    stage.cameraOffset.set(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> stage;</div><div class="line"> </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>This helper will of course be used in conjunction with many others, but for the most part the main subject matter of this post happens here.</p>
<h3 id="2-2-The-create-map-method"><a href="#2-2-The-create-map-method" class="headerlink" title="2.2 - The create map method"></a>2.2 - The create map method</h3><p>Here I have the create map method, that when called will create an instance of a tile map and appedn a reference to it in a object that I appedn to the Phaser.Game instance. This method will of course be called before I call createStage, but after I load all the assets that I need including the external json file that will contain the frame index data for each tile.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create the tilemap</span></div><div class="line"><span class="keyword">var</span> createMap = <span class="function"><span class="keyword">function</span> (<span class="params">game, worldNum</span>) </span>&#123;</div><div class="line"> </div><div class="line">    worldNum = worldNum || <span class="number">1</span>;</div><div class="line"> </div><div class="line">    game.data = game.data || &#123;&#125;;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> map = game.data.map = game.add.tilemap(<span class="string">'map-world'</span> + worldNum);</div><div class="line"> </div><div class="line">    map.addTilesetImage(<span class="string">'blocks'</span>, <span class="string">'image-blocks'</span>);</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> map;</div><div class="line"> </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-3-Create-the-guy-sprite"><a href="#2-3-Create-the-guy-sprite" class="headerlink" title="2.3 - Create the guy sprite"></a>2.3 - Create the guy sprite</h3><p>Next I have a helper that will create a sprite of a little guy character that I put together in a flash for the sake of these demos. The method creates the sprite using the key of a sprite sheet that I load before calling this. Once I have the instance of the sprite I enable physics for the sprite, and set some additional settings including the start location from the json data.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create the guy sprite</span></div><div class="line"><span class="keyword">var</span> createGuy = <span class="function"><span class="keyword">function</span> (<span class="params">game</span>) </span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">var</span> map = game.data.map;</div><div class="line"> </div><div class="line">    <span class="comment">// create guy Sprite</span></div><div class="line">    <span class="keyword">var</span> guy = game.data.guy = game.add.sprite(<span class="number">0</span>, <span class="number">0</span>, <span class="string">'sheet-guy'</span>);</div><div class="line"> </div><div class="line">    <span class="comment">// enable physics for the guy</span></div><div class="line">    game.physics.enable([guy]);</div><div class="line"> </div><div class="line">    <span class="comment">// guy physics settings</span></div><div class="line">    guy.body.gravity.set(<span class="number">0</span>, <span class="number">100</span>);</div><div class="line">    guy.body.bounce.set(<span class="number">0.25</span>);</div><div class="line">    guy.body.linearDamping = <span class="number">1</span>;</div><div class="line"> </div><div class="line">    <span class="comment">// guy start location</span></div><div class="line">    <span class="keyword">var</span> startAt = map.layer.properties.startat;</div><div class="line">    guy.x = startAt.x * <span class="number">32</span>;</div><div class="line">    guy.y = startAt.y * <span class="number">32</span>;</div><div class="line"> </div><div class="line">    <span class="comment">// have camera follow the guy</span></div><div class="line">    game.camera.follow(guy);</div><div class="line"> </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>In order to confirm that collision is working the little guy sprite is necessary, in a real project there would be much more to do with this, but for now he should serve this example well.</p>
<h3 id="2-4-The-JSON-file"><a href="#2-4-The-JSON-file" class="headerlink" title="2.4 - The JSON file"></a>2.4 - The JSON file</h3><p>So here I have the JSON file that I will be using that will contain the frame index data along with many other things. As of this writing I have not yet wrote a post in which I get into this json file standard, but there is the <a href="https://doc.mapeditor.org/en/stable/reference/json-map-format/" target="_blank" rel="external">official documentation</a> on it at the <a href="https://www.mapeditor.org/" target="_blank" rel="external">tiled website</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"version"</span>: <span class="number">1</span>,</div><div class="line">    <span class="string">"orientation"</span>: <span class="string">"orthogonal"</span>,</div><div class="line">    <span class="string">"width"</span>: <span class="number">12</span>,</div><div class="line">    <span class="string">"height"</span>: <span class="number">10</span>,</div><div class="line">    <span class="string">"tileheight"</span>: <span class="number">32</span>,</div><div class="line">    <span class="string">"tilewidth"</span>: <span class="number">32</span>,</div><div class="line">    <span class="string">"properties"</span>: &#123;</div><div class="line">        <span class="string">"world"</span>: <span class="number">1</span>,</div><div class="line">        <span class="string">"stages"</span>: <span class="number">2</span></div><div class="line">    &#125;,</div><div class="line">    <span class="string">"layers"</span>: [&#123;</div><div class="line">            <span class="string">"name"</span>: <span class="string">"stage1"</span>,</div><div class="line">            <span class="string">"width"</span>: <span class="number">12</span>,</div><div class="line">            <span class="string">"height"</span>: <span class="number">10</span>,</div><div class="line">            <span class="string">"data"</span>: [</div><div class="line">                <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</div><div class="line">                <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span></div><div class="line">            ],</div><div class="line">            <span class="string">"opacity"</span>: <span class="number">1</span>,</div><div class="line">            <span class="string">"properties"</span>: &#123;</div><div class="line">                <span class="string">"startat"</span>: &#123;</div><div class="line">                    <span class="string">"x"</span>: <span class="number">4</span>,</div><div class="line">                    <span class="string">"y"</span>: <span class="number">1</span></div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="string">"type"</span>: <span class="string">"tilelayer"</span>,</div><div class="line">            <span class="string">"visible"</span>: <span class="literal">true</span>,</div><div class="line">            <span class="string">"x"</span>: <span class="number">0</span>,</div><div class="line">            <span class="string">"y"</span>: <span class="number">0</span></div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    <span class="string">"tilesets"</span>: [&#123;</div><div class="line">            <span class="string">"firstgid"</span>: <span class="number">1</span>,</div><div class="line">            <span class="string">"image"</span>: <span class="string">"sheet_blocks.png"</span>,</div><div class="line">            <span class="string">"imageheight"</span>: <span class="number">32</span>,</div><div class="line">            <span class="string">"imagewidth"</span>: <span class="number">64</span>,</div><div class="line">            <span class="string">"margin"</span>: <span class="number">0</span>,</div><div class="line">            <span class="string">"name"</span>: <span class="string">"blocks"</span>,</div><div class="line">            <span class="string">"properties"</span>: &#123;&#125;,</div><div class="line">            <span class="string">"spacing"</span>: <span class="number">0</span>,</div><div class="line">            <span class="string">"tileheight"</span>: <span class="number">32</span>,</div><div class="line">            <span class="string">"tilewidth"</span>: <span class="number">32</span>,</div><div class="line">            <span class="string">"tileproperties"</span>: &#123;</div><div class="line">                <span class="string">"12"</span>: &#123;</div><div class="line">                    <span class="string">"home"</span>: <span class="string">"true"</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-5-The-Phaser-Game-instance-and-state-object"><a href="#2-5-The-Phaser-Game-instance-and-state-object" class="headerlink" title="2.5 - The Phaser.Game instance and state object"></a>2.5 - The Phaser.Game instance and state object</h3><p>Now to get the project up and running by bringing everything together with a Phaser.Game instance and a single state object with a preload, create, and update methods. In the preload method I load all my assets, such as the sprite sheets for the tile map, and the little guy, along with the json data with to load.tilemap.</p>
<p>In the create method I resize the world, create the map, create the stage, and enable physics. Then I create the little guy sprite that will end up at a start location define in the json file. I also set up some keyboard cursors to use to move the little guy around to confirm that collision is working, event though the little guy would fall through the blocks if it wasnâ€™t. Still I like to make these demos at least a little interesting, have to move him around at least.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> game = <span class="keyword">new</span> Phaser.Game(<span class="number">320</span>, <span class="number">240</span>, Phaser.AUTO, <span class="string">'gamearea'</span>);</div><div class="line"> </div><div class="line">game.state.add(<span class="string">'boot'</span>, &#123;</div><div class="line"> </div><div class="line">    <span class="comment">// load assets</span></div><div class="line">    preload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">        <span class="comment">// load images</span></div><div class="line">        game.load.image(<span class="string">'image-blocks'</span>, <span class="string">'/img/sheet_blocks.png'</span>);</div><div class="line">        game.load.spritesheet(<span class="string">'sheet-guy'</span>, <span class="string">'/img/sheet_guy_16_32.png'</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">1</span>);</div><div class="line"> </div><div class="line">        <span class="comment">// load json</span></div><div class="line">        game.load.tilemap(<span class="string">'map-world1'</span>, <span class="string">'/forpost/phaser-tilemap-set-collision-by-exclusion/world.json'</span>, <span class="literal">null</span>, Phaser.Tilemap.TILED_JSON);</div><div class="line"> </div><div class="line">    &#125;,</div><div class="line"> </div><div class="line">    <span class="comment">// create the world</span></div><div class="line">    create: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">        game.world.resize(<span class="number">640</span>, <span class="number">480</span>);</div><div class="line"> </div><div class="line">        <span class="comment">// create map, and map layer</span></div><div class="line">        <span class="keyword">var</span> map = createMap(game, <span class="number">1</span>);</div><div class="line">        <span class="keyword">var</span> stage = createStage(game, <span class="number">1</span>);</div><div class="line"> </div><div class="line">        <span class="comment">// I will be using physics</span></div><div class="line">        game.physics.startSystem(Phaser.Physics.ARCADE);</div><div class="line"> </div><div class="line">        createGuy(game);</div><div class="line"> </div><div class="line">        game.data.cursors = game.input.keyboard.createCursorKeys();</div><div class="line"> </div><div class="line">    &#125;,</div><div class="line"> </div><div class="line">    <span class="comment">// update</span></div><div class="line">    update: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">        <span class="keyword">var</span> guy = game.data.guy,</div><div class="line">        layer = game.data.stage,</div><div class="line">        cursors = game.data.cursors;</div><div class="line"> </div><div class="line">        <span class="comment">// check for collision</span></div><div class="line">        game.physics.arcade.collide(guy, layer);</div><div class="line"> </div><div class="line">        guy.body.velocity.x = <span class="number">0</span>;</div><div class="line"> </div><div class="line">        <span class="keyword">if</span> (cursors.up.isDown) &#123;</div><div class="line">            <span class="keyword">if</span> (guy.body.onFloor()) &#123;</div><div class="line">                guy.body.velocity.y = <span class="number">-125</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        <span class="keyword">if</span> (cursors.left.isDown) &#123;</div><div class="line">            guy.body.velocity.x = <span class="number">-150</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cursors.right.isDown) &#123;</div><div class="line">            guy.body.velocity.x = <span class="number">150</span>;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">    &#125;</div><div class="line"> </div><div class="line">&#125;);</div><div class="line"> </div><div class="line">game.state.start(<span class="string">'boot'</span>);</div></pre></td></tr></table></figure>
<p>There is also the update method as well there I am just updating the little guys position based on keyboard input.</p>
<h2 id="3-Conclusion"><a href="#3-Conclusion" class="headerlink" title="3 - Conclusion"></a>3 - Conclusion</h2><p>So if all goes well when this project starts up the little guy sprite will start at the starting location that I have defined in the json data, and collision detection does indeed seem to work. He does not fall threw the tiles, and the example seems to work as expected. Of course this is not everything there is to cover with collision detection and tile maps in phaser. I might still need to write more content event attachment, and have some other things going on such as enemies, and death traps. However just getting to this point is a major step forward in making a nice little platform game.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/" data-id="cjmr08xsj000va8v1u7lu4eqv" class="article-share-link">Share</a>
      
        <a href="https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/phaser/">phaser</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/09/26/phaser-tilemap-basic-scrolling/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Basic scrolling with a tile map in phaser ce
        
      </div>
    </a>
  
  
    <a href="/2018/09/25/phaser-tilemap-loader/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">loading tilemap data from external json in phaser ce</div>
    </a>
  
</nav>

  
</article>



<section id="comments">

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
    this.page.url = 'https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/index.html';
    this.page.identifier = '288';
    this.page.title = 'Setting collsion in a tilemap with phaser';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://dustinpfister-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angular/">angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/backbone/">backbone</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/canvas/">canvas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/discovery/">discovery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/express/">express</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hapi/">hapi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/heroku/">heroku</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lodash/">lodash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/phaser/">phaser</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistics/">statistics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/three-js/">three.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backbone/">backbone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deterministic/">deterministic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discovery/">discovery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ejs/">ejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hapi/">hapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/heroku/">heroku</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js13k/">js13k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodash/">lodash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phaser/">phaser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/themes/">themes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuejs/">vuejs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 12.78px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10.56px;">SEO</a> <a href="/tags/angular/" style="font-size: 13.89px;">angular</a> <a href="/tags/animation/" style="font-size: 12.78px;">animation</a> <a href="/tags/automation/" style="font-size: 12.78px;">automation</a> <a href="/tags/backbone/" style="font-size: 13.33px;">backbone</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/canvas/" style="font-size: 17.78px;">canvas</a> <a href="/tags/corejs/" style="font-size: 13.33px;">corejs</a> <a href="/tags/deterministic/" style="font-size: 10px;">deterministic</a> <a href="/tags/discovery/" style="font-size: 11.11px;">discovery</a> <a href="/tags/ejs/" style="font-size: 11.67px;">ejs</a> <a href="/tags/express/" style="font-size: 16.67px;">express</a> <a href="/tags/games/" style="font-size: 17.22px;">games</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hapi/" style="font-size: 15px;">hapi</a> <a href="/tags/heroku/" style="font-size: 13.89px;">heroku</a> <a href="/tags/hexo/" style="font-size: 14.44px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10.56px;">jimp</a> <a href="/tags/jquery/" style="font-size: 11.67px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/js13k/" style="font-size: 10px;">js13k</a> <a href="/tags/linux/" style="font-size: 12.78px;">linux</a> <a href="/tags/lodash/" style="font-size: 18.33px;">lodash</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mongodb/" style="font-size: 14.44px;">mongodb</a> <a href="/tags/node-js/" style="font-size: 19.44px;">node.js</a> <a href="/tags/phaser/" style="font-size: 18.89px;">phaser</a> <a href="/tags/statistics/" style="font-size: 12.22px;">statistics</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/three-js/" style="font-size: 16.11px;">three.js</a> <a href="/tags/vuejs/" style="font-size: 15.56px;">vuejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/03/06/js-value-of/">js value of object method</a>
          </li>
        
          <li>
            <a href="/2020/03/04/canvas-get-point-relative-to-canvas/">Get a point relative to a canvas element rather than window in client side javaScript</a>
          </li>
        
          <li>
            <a href="/2020/03/03/lodash_pull/">The lodash pull method and other ways to remove elements</a>
          </li>
        
          <li>
            <a href="/2020/02/28/js-json-parse/">JSON parse method in javaScript</a>
          </li>
        
          <li>
            <a href="/2020/02/27/js-javascript-example-tax-brackets/">javaScript example tax brackets</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      <br>
      <a href="/privacy.html" target="_blank">Privacy Policy</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'dustinpfister-github-io';
  
  var disqus_url = 'https://dustinpfister.github.io/2018/09/26/phaser-tilemap-set-collision-by-exclusion/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


  </div>
</body>
</html>